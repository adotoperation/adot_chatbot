var zv=Object.defineProperty;var Fv=(s,e,t)=>e in s?zv(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var Gn=(s,e,t)=>Fv(s,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function t(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(a){if(a.ep)return;a.ep=!0;const o=t(a);fetch(a.href,o)}})();function Or(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var yl={exports:{}},Ji={},_l={exports:{}},ye={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gp;function Bv(){if(gp)return ye;gp=1;var s=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),_=Symbol.iterator;function y(I){return I===null||typeof I!="object"?null:(I=_&&I[_]||I["@@iterator"],typeof I=="function"?I:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,E={};function S(I,j,te){this.props=I,this.context=j,this.refs=E,this.updater=te||w}S.prototype.isReactComponent={},S.prototype.setState=function(I,j){if(typeof I!="object"&&typeof I!="function"&&I!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,I,j,"setState")},S.prototype.forceUpdate=function(I){this.updater.enqueueForceUpdate(this,I,"forceUpdate")};function O(){}O.prototype=S.prototype;function R(I,j,te){this.props=I,this.context=j,this.refs=E,this.updater=te||w}var T=R.prototype=new O;T.constructor=R,b(T,S.prototype),T.isPureReactComponent=!0;var $=Array.isArray,P=Object.prototype.hasOwnProperty,z={current:null},Q={key:!0,ref:!0,__self:!0,__source:!0};function W(I,j,te){var le,ce={},ge=null,ve=null;if(j!=null)for(le in j.ref!==void 0&&(ve=j.ref),j.key!==void 0&&(ge=""+j.key),j)P.call(j,le)&&!Q.hasOwnProperty(le)&&(ce[le]=j[le]);var Se=arguments.length-2;if(Se===1)ce.children=te;else if(1<Se){for(var Ce=Array(Se),nt=0;nt<Se;nt++)Ce[nt]=arguments[nt+2];ce.children=Ce}if(I&&I.defaultProps)for(le in Se=I.defaultProps,Se)ce[le]===void 0&&(ce[le]=Se[le]);return{$$typeof:s,type:I,key:ge,ref:ve,props:ce,_owner:z.current}}function Ee(I,j){return{$$typeof:s,type:I.type,key:j,ref:I.ref,props:I.props,_owner:I._owner}}function Ae(I){return typeof I=="object"&&I!==null&&I.$$typeof===s}function He(I){var j={"=":"=0",":":"=2"};return"$"+I.replace(/[=:]/g,function(te){return j[te]})}var Ue=/\/+/g;function Ge(I,j){return typeof I=="object"&&I!==null&&I.key!=null?He(""+I.key):j.toString(36)}function K(I,j,te,le,ce){var ge=typeof I;(ge==="undefined"||ge==="boolean")&&(I=null);var ve=!1;if(I===null)ve=!0;else switch(ge){case"string":case"number":ve=!0;break;case"object":switch(I.$$typeof){case s:case e:ve=!0}}if(ve)return ve=I,ce=ce(ve),I=le===""?"."+Ge(ve,0):le,$(ce)?(te="",I!=null&&(te=I.replace(Ue,"$&/")+"/"),K(ce,j,te,"",function(nt){return nt})):ce!=null&&(Ae(ce)&&(ce=Ee(ce,te+(!ce.key||ve&&ve.key===ce.key?"":(""+ce.key).replace(Ue,"$&/")+"/")+I)),j.push(ce)),1;if(ve=0,le=le===""?".":le+":",$(I))for(var Se=0;Se<I.length;Se++){ge=I[Se];var Ce=le+Ge(ge,Se);ve+=K(ge,j,te,Ce,ce)}else if(Ce=y(I),typeof Ce=="function")for(I=Ce.call(I),Se=0;!(ge=I.next()).done;)ge=ge.value,Ce=le+Ge(ge,Se++),ve+=K(ge,j,te,Ce,ce);else if(ge==="object")throw j=String(I),Error("Objects are not valid as a React child (found: "+(j==="[object Object]"?"object with keys {"+Object.keys(I).join(", ")+"}":j)+"). If you meant to render a collection of children, use an array instead.");return ve}function G(I,j,te){if(I==null)return I;var le=[],ce=0;return K(I,le,"","",function(ge){return j.call(te,ge,ce++)}),le}function ee(I){if(I._status===-1){var j=I._result;j=j(),j.then(function(te){(I._status===0||I._status===-1)&&(I._status=1,I._result=te)},function(te){(I._status===0||I._status===-1)&&(I._status=2,I._result=te)}),I._status===-1&&(I._status=0,I._result=j)}if(I._status===1)return I._result.default;throw I._result}var J={current:null},D={transition:null},U={ReactCurrentDispatcher:J,ReactCurrentBatchConfig:D,ReactCurrentOwner:z};function M(){throw Error("act(...) is not supported in production builds of React.")}return ye.Children={map:G,forEach:function(I,j,te){G(I,function(){j.apply(this,arguments)},te)},count:function(I){var j=0;return G(I,function(){j++}),j},toArray:function(I){return G(I,function(j){return j})||[]},only:function(I){if(!Ae(I))throw Error("React.Children.only expected to receive a single React element child.");return I}},ye.Component=S,ye.Fragment=t,ye.Profiler=a,ye.PureComponent=R,ye.StrictMode=r,ye.Suspense=f,ye.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=U,ye.act=M,ye.cloneElement=function(I,j,te){if(I==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+I+".");var le=b({},I.props),ce=I.key,ge=I.ref,ve=I._owner;if(j!=null){if(j.ref!==void 0&&(ge=j.ref,ve=z.current),j.key!==void 0&&(ce=""+j.key),I.type&&I.type.defaultProps)var Se=I.type.defaultProps;for(Ce in j)P.call(j,Ce)&&!Q.hasOwnProperty(Ce)&&(le[Ce]=j[Ce]===void 0&&Se!==void 0?Se[Ce]:j[Ce])}var Ce=arguments.length-2;if(Ce===1)le.children=te;else if(1<Ce){Se=Array(Ce);for(var nt=0;nt<Ce;nt++)Se[nt]=arguments[nt+2];le.children=Se}return{$$typeof:s,type:I.type,key:ce,ref:ge,props:le,_owner:ve}},ye.createContext=function(I){return I={$$typeof:l,_currentValue:I,_currentValue2:I,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},I.Provider={$$typeof:o,_context:I},I.Consumer=I},ye.createElement=W,ye.createFactory=function(I){var j=W.bind(null,I);return j.type=I,j},ye.createRef=function(){return{current:null}},ye.forwardRef=function(I){return{$$typeof:c,render:I}},ye.isValidElement=Ae,ye.lazy=function(I){return{$$typeof:m,_payload:{_status:-1,_result:I},_init:ee}},ye.memo=function(I,j){return{$$typeof:h,type:I,compare:j===void 0?null:j}},ye.startTransition=function(I){var j=D.transition;D.transition={};try{I()}finally{D.transition=j}},ye.unstable_act=M,ye.useCallback=function(I,j){return J.current.useCallback(I,j)},ye.useContext=function(I){return J.current.useContext(I)},ye.useDebugValue=function(){},ye.useDeferredValue=function(I){return J.current.useDeferredValue(I)},ye.useEffect=function(I,j){return J.current.useEffect(I,j)},ye.useId=function(){return J.current.useId()},ye.useImperativeHandle=function(I,j,te){return J.current.useImperativeHandle(I,j,te)},ye.useInsertionEffect=function(I,j){return J.current.useInsertionEffect(I,j)},ye.useLayoutEffect=function(I,j){return J.current.useLayoutEffect(I,j)},ye.useMemo=function(I,j){return J.current.useMemo(I,j)},ye.useReducer=function(I,j,te){return J.current.useReducer(I,j,te)},ye.useRef=function(I){return J.current.useRef(I)},ye.useState=function(I){return J.current.useState(I)},ye.useSyncExternalStore=function(I,j,te){return J.current.useSyncExternalStore(I,j,te)},ye.useTransition=function(){return J.current.useTransition()},ye.version="18.3.1",ye}var yp;function nd(){return yp||(yp=1,_l.exports=Bv()),_l.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _p;function Hv(){if(_p)return Ji;_p=1;var s=nd(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,a=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function l(c,f,h){var m,_={},y=null,w=null;h!==void 0&&(y=""+h),f.key!==void 0&&(y=""+f.key),f.ref!==void 0&&(w=f.ref);for(m in f)r.call(f,m)&&!o.hasOwnProperty(m)&&(_[m]=f[m]);if(c&&c.defaultProps)for(m in f=c.defaultProps,f)_[m]===void 0&&(_[m]=f[m]);return{$$typeof:e,type:c,key:y,ref:w,props:_,_owner:a.current}}return Ji.Fragment=t,Ji.jsx=l,Ji.jsxs=l,Ji}var vp;function Gv(){return vp||(vp=1,yl.exports=Hv()),yl.exports}var ke=Gv(),at=nd();const qv=Or(at);var La={},vl={exports:{}},St={},wl={exports:{}},bl={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wp;function Vv(){return wp||(wp=1,(function(s){function e(D,U){var M=D.length;D.push(U);e:for(;0<M;){var I=M-1>>>1,j=D[I];if(0<a(j,U))D[I]=U,D[M]=j,M=I;else break e}}function t(D){return D.length===0?null:D[0]}function r(D){if(D.length===0)return null;var U=D[0],M=D.pop();if(M!==U){D[0]=M;e:for(var I=0,j=D.length,te=j>>>1;I<te;){var le=2*(I+1)-1,ce=D[le],ge=le+1,ve=D[ge];if(0>a(ce,M))ge<j&&0>a(ve,ce)?(D[I]=ve,D[ge]=M,I=ge):(D[I]=ce,D[le]=M,I=le);else if(ge<j&&0>a(ve,M))D[I]=ve,D[ge]=M,I=ge;else break e}}return U}function a(D,U){var M=D.sortIndex-U.sortIndex;return M!==0?M:D.id-U.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;s.unstable_now=function(){return o.now()}}else{var l=Date,c=l.now();s.unstable_now=function(){return l.now()-c}}var f=[],h=[],m=1,_=null,y=3,w=!1,b=!1,E=!1,S=typeof setTimeout=="function"?setTimeout:null,O=typeof clearTimeout=="function"?clearTimeout:null,R=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(D){for(var U=t(h);U!==null;){if(U.callback===null)r(h);else if(U.startTime<=D)r(h),U.sortIndex=U.expirationTime,e(f,U);else break;U=t(h)}}function $(D){if(E=!1,T(D),!b)if(t(f)!==null)b=!0,ee(P);else{var U=t(h);U!==null&&J($,U.startTime-D)}}function P(D,U){b=!1,E&&(E=!1,O(W),W=-1),w=!0;var M=y;try{for(T(U),_=t(f);_!==null&&(!(_.expirationTime>U)||D&&!He());){var I=_.callback;if(typeof I=="function"){_.callback=null,y=_.priorityLevel;var j=I(_.expirationTime<=U);U=s.unstable_now(),typeof j=="function"?_.callback=j:_===t(f)&&r(f),T(U)}else r(f);_=t(f)}if(_!==null)var te=!0;else{var le=t(h);le!==null&&J($,le.startTime-U),te=!1}return te}finally{_=null,y=M,w=!1}}var z=!1,Q=null,W=-1,Ee=5,Ae=-1;function He(){return!(s.unstable_now()-Ae<Ee)}function Ue(){if(Q!==null){var D=s.unstable_now();Ae=D;var U=!0;try{U=Q(!0,D)}finally{U?Ge():(z=!1,Q=null)}}else z=!1}var Ge;if(typeof R=="function")Ge=function(){R(Ue)};else if(typeof MessageChannel<"u"){var K=new MessageChannel,G=K.port2;K.port1.onmessage=Ue,Ge=function(){G.postMessage(null)}}else Ge=function(){S(Ue,0)};function ee(D){Q=D,z||(z=!0,Ge())}function J(D,U){W=S(function(){D(s.unstable_now())},U)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(D){D.callback=null},s.unstable_continueExecution=function(){b||w||(b=!0,ee(P))},s.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Ee=0<D?Math.floor(1e3/D):5},s.unstable_getCurrentPriorityLevel=function(){return y},s.unstable_getFirstCallbackNode=function(){return t(f)},s.unstable_next=function(D){switch(y){case 1:case 2:case 3:var U=3;break;default:U=y}var M=y;y=U;try{return D()}finally{y=M}},s.unstable_pauseExecution=function(){},s.unstable_requestPaint=function(){},s.unstable_runWithPriority=function(D,U){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var M=y;y=D;try{return U()}finally{y=M}},s.unstable_scheduleCallback=function(D,U,M){var I=s.unstable_now();switch(typeof M=="object"&&M!==null?(M=M.delay,M=typeof M=="number"&&0<M?I+M:I):M=I,D){case 1:var j=-1;break;case 2:j=250;break;case 5:j=1073741823;break;case 4:j=1e4;break;default:j=5e3}return j=M+j,D={id:m++,callback:U,priorityLevel:D,startTime:M,expirationTime:j,sortIndex:-1},M>I?(D.sortIndex=M,e(h,D),t(f)===null&&D===t(h)&&(E?(O(W),W=-1):E=!0,J($,M-I))):(D.sortIndex=j,e(f,D),b||w||(b=!0,ee(P))),D},s.unstable_shouldYield=He,s.unstable_wrapCallback=function(D){var U=y;return function(){var M=y;y=U;try{return D.apply(this,arguments)}finally{y=M}}}})(bl)),bl}var bp;function Zv(){return bp||(bp=1,wl.exports=Vv()),wl.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ep;function Wv(){if(Ep)return St;Ep=1;var s=nd(),e=Zv();function t(n){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+n,u=1;u<arguments.length;u++)i+="&args[]="+encodeURIComponent(arguments[u]);return"Minified React error #"+n+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,a={};function o(n,i){l(n,i),l(n+"Capture",i)}function l(n,i){for(a[n]=i,n=0;n<i.length;n++)r.add(i[n])}var c=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),f=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m={},_={};function y(n){return f.call(_,n)?!0:f.call(m,n)?!1:h.test(n)?_[n]=!0:(m[n]=!0,!1)}function w(n,i,u,d){if(u!==null&&u.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return d?!1:u!==null?!u.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function b(n,i,u,d){if(i===null||typeof i>"u"||w(n,i,u,d))return!0;if(d)return!1;if(u!==null)switch(u.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function E(n,i,u,d,p,g,v){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=d,this.attributeNamespace=p,this.mustUseProperty=u,this.propertyName=n,this.type=i,this.sanitizeURL=g,this.removeEmptyString=v}var S={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){S[n]=new E(n,0,!1,n,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var i=n[0];S[i]=new E(i,1,!1,n[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(n){S[n]=new E(n,2,!1,n.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){S[n]=new E(n,2,!1,n,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){S[n]=new E(n,3,!1,n.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(n){S[n]=new E(n,3,!0,n,null,!1,!1)}),["capture","download"].forEach(function(n){S[n]=new E(n,4,!1,n,null,!1,!1)}),["cols","rows","size","span"].forEach(function(n){S[n]=new E(n,6,!1,n,null,!1,!1)}),["rowSpan","start"].forEach(function(n){S[n]=new E(n,5,!1,n.toLowerCase(),null,!1,!1)});var O=/[\-:]([a-z])/g;function R(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var i=n.replace(O,R);S[i]=new E(i,1,!1,n,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var i=n.replace(O,R);S[i]=new E(i,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(n){var i=n.replace(O,R);S[i]=new E(i,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(n){S[n]=new E(n,1,!1,n.toLowerCase(),null,!1,!1)}),S.xlinkHref=new E("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(n){S[n]=new E(n,1,!1,n.toLowerCase(),null,!0,!0)});function T(n,i,u,d){var p=S.hasOwnProperty(i)?S[i]:null;(p!==null?p.type!==0:d||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(b(i,u,p,d)&&(u=null),d||p===null?y(i)&&(u===null?n.removeAttribute(i):n.setAttribute(i,""+u)):p.mustUseProperty?n[p.propertyName]=u===null?p.type===3?!1:"":u:(i=p.attributeName,d=p.attributeNamespace,u===null?n.removeAttribute(i):(p=p.type,u=p===3||p===4&&u===!0?"":""+u,d?n.setAttributeNS(d,i,u):n.setAttribute(i,u))))}var $=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,P=Symbol.for("react.element"),z=Symbol.for("react.portal"),Q=Symbol.for("react.fragment"),W=Symbol.for("react.strict_mode"),Ee=Symbol.for("react.profiler"),Ae=Symbol.for("react.provider"),He=Symbol.for("react.context"),Ue=Symbol.for("react.forward_ref"),Ge=Symbol.for("react.suspense"),K=Symbol.for("react.suspense_list"),G=Symbol.for("react.memo"),ee=Symbol.for("react.lazy"),J=Symbol.for("react.offscreen"),D=Symbol.iterator;function U(n){return n===null||typeof n!="object"?null:(n=D&&n[D]||n["@@iterator"],typeof n=="function"?n:null)}var M=Object.assign,I;function j(n){if(I===void 0)try{throw Error()}catch(u){var i=u.stack.trim().match(/\n( *(at )?)/);I=i&&i[1]||""}return`
`+I+n}var te=!1;function le(n,i){if(!n||te)return"";te=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(L){var d=L}Reflect.construct(n,[],i)}else{try{i.call()}catch(L){d=L}n.call(i.prototype)}else{try{throw Error()}catch(L){d=L}n()}}catch(L){if(L&&d&&typeof L.stack=="string"){for(var p=L.stack.split(`
`),g=d.stack.split(`
`),v=p.length-1,k=g.length-1;1<=v&&0<=k&&p[v]!==g[k];)k--;for(;1<=v&&0<=k;v--,k--)if(p[v]!==g[k]){if(v!==1||k!==1)do if(v--,k--,0>k||p[v]!==g[k]){var x=`
`+p[v].replace(" at new "," at ");return n.displayName&&x.includes("<anonymous>")&&(x=x.replace("<anonymous>",n.displayName)),x}while(1<=v&&0<=k);break}}}finally{te=!1,Error.prepareStackTrace=u}return(n=n?n.displayName||n.name:"")?j(n):""}function ce(n){switch(n.tag){case 5:return j(n.type);case 16:return j("Lazy");case 13:return j("Suspense");case 19:return j("SuspenseList");case 0:case 2:case 15:return n=le(n.type,!1),n;case 11:return n=le(n.type.render,!1),n;case 1:return n=le(n.type,!0),n;default:return""}}function ge(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case Q:return"Fragment";case z:return"Portal";case Ee:return"Profiler";case W:return"StrictMode";case Ge:return"Suspense";case K:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case He:return(n.displayName||"Context")+".Consumer";case Ae:return(n._context.displayName||"Context")+".Provider";case Ue:var i=n.render;return n=n.displayName,n||(n=i.displayName||i.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case G:return i=n.displayName||null,i!==null?i:ge(n.type)||"Memo";case ee:i=n._payload,n=n._init;try{return ge(n(i))}catch{}}return null}function ve(n){var i=n.type;switch(n.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=i.render,n=n.displayName||n.name||"",i.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ge(i);case 8:return i===W?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function Se(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Ce(n){var i=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function nt(n){var i=Ce(n)?"checked":"value",u=Object.getOwnPropertyDescriptor(n.constructor.prototype,i),d=""+n[i];if(!n.hasOwnProperty(i)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var p=u.get,g=u.set;return Object.defineProperty(n,i,{configurable:!0,get:function(){return p.call(this)},set:function(v){d=""+v,g.call(this,v)}}),Object.defineProperty(n,i,{enumerable:u.enumerable}),{getValue:function(){return d},setValue:function(v){d=""+v},stopTracking:function(){n._valueTracker=null,delete n[i]}}}}function kr(n){n._valueTracker||(n._valueTracker=nt(n))}function bd(n){if(!n)return!1;var i=n._valueTracker;if(!i)return!0;var u=i.getValue(),d="";return n&&(d=Ce(n)?n.checked?"true":"false":n.value),n=d,n!==u?(i.setValue(n),!0):!1}function ks(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function Oo(n,i){var u=i.checked;return M({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:u??n._wrapperState.initialChecked})}function Ed(n,i){var u=i.defaultValue==null?"":i.defaultValue,d=i.checked!=null?i.checked:i.defaultChecked;u=Se(i.value!=null?i.value:u),n._wrapperState={initialChecked:d,initialValue:u,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function Sd(n,i){i=i.checked,i!=null&&T(n,"checked",i,!1)}function ko(n,i){Sd(n,i);var u=Se(i.value),d=i.type;if(u!=null)d==="number"?(u===0&&n.value===""||n.value!=u)&&(n.value=""+u):n.value!==""+u&&(n.value=""+u);else if(d==="submit"||d==="reset"){n.removeAttribute("value");return}i.hasOwnProperty("value")?To(n,i.type,u):i.hasOwnProperty("defaultValue")&&To(n,i.type,Se(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(n.defaultChecked=!!i.defaultChecked)}function Od(n,i,u){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var d=i.type;if(!(d!=="submit"&&d!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+n._wrapperState.initialValue,u||i===n.value||(n.value=i),n.defaultValue=i}u=n.name,u!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,u!==""&&(n.name=u)}function To(n,i,u){(i!=="number"||ks(n.ownerDocument)!==n)&&(u==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+u&&(n.defaultValue=""+u))}var di=Array.isArray;function Tr(n,i,u,d){if(n=n.options,i){i={};for(var p=0;p<u.length;p++)i["$"+u[p]]=!0;for(u=0;u<n.length;u++)p=i.hasOwnProperty("$"+n[u].value),n[u].selected!==p&&(n[u].selected=p),p&&d&&(n[u].defaultSelected=!0)}else{for(u=""+Se(u),i=null,p=0;p<n.length;p++){if(n[p].value===u){n[p].selected=!0,d&&(n[p].defaultSelected=!0);return}i!==null||n[p].disabled||(i=n[p])}i!==null&&(i.selected=!0)}}function xo(n,i){if(i.dangerouslySetInnerHTML!=null)throw Error(t(91));return M({},i,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function kd(n,i){var u=i.value;if(u==null){if(u=i.children,i=i.defaultValue,u!=null){if(i!=null)throw Error(t(92));if(di(u)){if(1<u.length)throw Error(t(93));u=u[0]}i=u}i==null&&(i=""),u=i}n._wrapperState={initialValue:Se(u)}}function Td(n,i){var u=Se(i.value),d=Se(i.defaultValue);u!=null&&(u=""+u,u!==n.value&&(n.value=u),i.defaultValue==null&&n.defaultValue!==u&&(n.defaultValue=u)),d!=null&&(n.defaultValue=""+d)}function xd(n){var i=n.textContent;i===n._wrapperState.initialValue&&i!==""&&i!==null&&(n.value=i)}function Rd(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ro(n,i){return n==null||n==="http://www.w3.org/1999/xhtml"?Rd(i):n==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var Ts,Id=(function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,u,d,p){MSApp.execUnsafeLocalFunction(function(){return n(i,u,d,p)})}:n})(function(n,i){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=i;else{for(Ts=Ts||document.createElement("div"),Ts.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=Ts.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;i.firstChild;)n.appendChild(i.firstChild)}});function fi(n,i){if(i){var u=n.firstChild;if(u&&u===n.lastChild&&u.nodeType===3){u.nodeValue=i;return}}n.textContent=i}var hi={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Gy=["Webkit","ms","Moz","O"];Object.keys(hi).forEach(function(n){Gy.forEach(function(i){i=i+n.charAt(0).toUpperCase()+n.substring(1),hi[i]=hi[n]})});function Cd(n,i,u){return i==null||typeof i=="boolean"||i===""?"":u||typeof i!="number"||i===0||hi.hasOwnProperty(n)&&hi[n]?(""+i).trim():i+"px"}function Nd(n,i){n=n.style;for(var u in i)if(i.hasOwnProperty(u)){var d=u.indexOf("--")===0,p=Cd(u,i[u],d);u==="float"&&(u="cssFloat"),d?n.setProperty(u,p):n[u]=p}}var qy=M({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Io(n,i){if(i){if(qy[n]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(t(137,n));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(t(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(t(61))}if(i.style!=null&&typeof i.style!="object")throw Error(t(62))}}function Co(n,i){if(n.indexOf("-")===-1)return typeof i.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var No=null;function Ao(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Po=null,xr=null,Rr=null;function Ad(n){if(n=ji(n)){if(typeof Po!="function")throw Error(t(280));var i=n.stateNode;i&&(i=Ks(i),Po(n.stateNode,n.type,i))}}function Pd(n){xr?Rr?Rr.push(n):Rr=[n]:xr=n}function Ld(){if(xr){var n=xr,i=Rr;if(Rr=xr=null,Ad(n),i)for(n=0;n<i.length;n++)Ad(i[n])}}function jd(n,i){return n(i)}function $d(){}var Lo=!1;function Dd(n,i,u){if(Lo)return n(i,u);Lo=!0;try{return jd(n,i,u)}finally{Lo=!1,(xr!==null||Rr!==null)&&($d(),Ld())}}function pi(n,i){var u=n.stateNode;if(u===null)return null;var d=Ks(u);if(d===null)return null;u=d[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(n=n.type,d=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!d;break e;default:n=!1}if(n)return null;if(u&&typeof u!="function")throw Error(t(231,i,typeof u));return u}var jo=!1;if(c)try{var mi={};Object.defineProperty(mi,"passive",{get:function(){jo=!0}}),window.addEventListener("test",mi,mi),window.removeEventListener("test",mi,mi)}catch{jo=!1}function Vy(n,i,u,d,p,g,v,k,x){var L=Array.prototype.slice.call(arguments,3);try{i.apply(u,L)}catch(B){this.onError(B)}}var gi=!1,xs=null,Rs=!1,$o=null,Zy={onError:function(n){gi=!0,xs=n}};function Wy(n,i,u,d,p,g,v,k,x){gi=!1,xs=null,Vy.apply(Zy,arguments)}function Ky(n,i,u,d,p,g,v,k,x){if(Wy.apply(this,arguments),gi){if(gi){var L=xs;gi=!1,xs=null}else throw Error(t(198));Rs||(Rs=!0,$o=L)}}function ar(n){var i=n,u=n;if(n.alternate)for(;i.return;)i=i.return;else{n=i;do i=n,(i.flags&4098)!==0&&(u=i.return),n=i.return;while(n)}return i.tag===3?u:null}function Md(n){if(n.tag===13){var i=n.memoizedState;if(i===null&&(n=n.alternate,n!==null&&(i=n.memoizedState)),i!==null)return i.dehydrated}return null}function Ud(n){if(ar(n)!==n)throw Error(t(188))}function Jy(n){var i=n.alternate;if(!i){if(i=ar(n),i===null)throw Error(t(188));return i!==n?null:n}for(var u=n,d=i;;){var p=u.return;if(p===null)break;var g=p.alternate;if(g===null){if(d=p.return,d!==null){u=d;continue}break}if(p.child===g.child){for(g=p.child;g;){if(g===u)return Ud(p),n;if(g===d)return Ud(p),i;g=g.sibling}throw Error(t(188))}if(u.return!==d.return)u=p,d=g;else{for(var v=!1,k=p.child;k;){if(k===u){v=!0,u=p,d=g;break}if(k===d){v=!0,d=p,u=g;break}k=k.sibling}if(!v){for(k=g.child;k;){if(k===u){v=!0,u=g,d=p;break}if(k===d){v=!0,d=g,u=p;break}k=k.sibling}if(!v)throw Error(t(189))}}if(u.alternate!==d)throw Error(t(190))}if(u.tag!==3)throw Error(t(188));return u.stateNode.current===u?n:i}function zd(n){return n=Jy(n),n!==null?Fd(n):null}function Fd(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var i=Fd(n);if(i!==null)return i;n=n.sibling}return null}var Bd=e.unstable_scheduleCallback,Hd=e.unstable_cancelCallback,Qy=e.unstable_shouldYield,Yy=e.unstable_requestPaint,Fe=e.unstable_now,Xy=e.unstable_getCurrentPriorityLevel,Do=e.unstable_ImmediatePriority,Gd=e.unstable_UserBlockingPriority,Is=e.unstable_NormalPriority,e_=e.unstable_LowPriority,qd=e.unstable_IdlePriority,Cs=null,an=null;function t_(n){if(an&&typeof an.onCommitFiberRoot=="function")try{an.onCommitFiberRoot(Cs,n,void 0,(n.current.flags&128)===128)}catch{}}var qt=Math.clz32?Math.clz32:i_,n_=Math.log,r_=Math.LN2;function i_(n){return n>>>=0,n===0?32:31-(n_(n)/r_|0)|0}var Ns=64,As=4194304;function yi(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function Ps(n,i){var u=n.pendingLanes;if(u===0)return 0;var d=0,p=n.suspendedLanes,g=n.pingedLanes,v=u&268435455;if(v!==0){var k=v&~p;k!==0?d=yi(k):(g&=v,g!==0&&(d=yi(g)))}else v=u&~p,v!==0?d=yi(v):g!==0&&(d=yi(g));if(d===0)return 0;if(i!==0&&i!==d&&(i&p)===0&&(p=d&-d,g=i&-i,p>=g||p===16&&(g&4194240)!==0))return i;if((d&4)!==0&&(d|=u&16),i=n.entangledLanes,i!==0)for(n=n.entanglements,i&=d;0<i;)u=31-qt(i),p=1<<u,d|=n[u],i&=~p;return d}function s_(n,i){switch(n){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function a_(n,i){for(var u=n.suspendedLanes,d=n.pingedLanes,p=n.expirationTimes,g=n.pendingLanes;0<g;){var v=31-qt(g),k=1<<v,x=p[v];x===-1?((k&u)===0||(k&d)!==0)&&(p[v]=s_(k,i)):x<=i&&(n.expiredLanes|=k),g&=~k}}function Mo(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function Vd(){var n=Ns;return Ns<<=1,(Ns&4194240)===0&&(Ns=64),n}function Uo(n){for(var i=[],u=0;31>u;u++)i.push(n);return i}function _i(n,i,u){n.pendingLanes|=i,i!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,i=31-qt(i),n[i]=u}function o_(n,i){var u=n.pendingLanes&~i;n.pendingLanes=i,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=i,n.mutableReadLanes&=i,n.entangledLanes&=i,i=n.entanglements;var d=n.eventTimes;for(n=n.expirationTimes;0<u;){var p=31-qt(u),g=1<<p;i[p]=0,d[p]=-1,n[p]=-1,u&=~g}}function zo(n,i){var u=n.entangledLanes|=i;for(n=n.entanglements;u;){var d=31-qt(u),p=1<<d;p&i|n[d]&i&&(n[d]|=i),u&=~p}}var Re=0;function Zd(n){return n&=-n,1<n?4<n?(n&268435455)!==0?16:536870912:4:1}var Wd,Fo,Kd,Jd,Qd,Bo=!1,Ls=[],kn=null,Tn=null,xn=null,vi=new Map,wi=new Map,Rn=[],u_="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Yd(n,i){switch(n){case"focusin":case"focusout":kn=null;break;case"dragenter":case"dragleave":Tn=null;break;case"mouseover":case"mouseout":xn=null;break;case"pointerover":case"pointerout":vi.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":wi.delete(i.pointerId)}}function bi(n,i,u,d,p,g){return n===null||n.nativeEvent!==g?(n={blockedOn:i,domEventName:u,eventSystemFlags:d,nativeEvent:g,targetContainers:[p]},i!==null&&(i=ji(i),i!==null&&Fo(i)),n):(n.eventSystemFlags|=d,i=n.targetContainers,p!==null&&i.indexOf(p)===-1&&i.push(p),n)}function l_(n,i,u,d,p){switch(i){case"focusin":return kn=bi(kn,n,i,u,d,p),!0;case"dragenter":return Tn=bi(Tn,n,i,u,d,p),!0;case"mouseover":return xn=bi(xn,n,i,u,d,p),!0;case"pointerover":var g=p.pointerId;return vi.set(g,bi(vi.get(g)||null,n,i,u,d,p)),!0;case"gotpointercapture":return g=p.pointerId,wi.set(g,bi(wi.get(g)||null,n,i,u,d,p)),!0}return!1}function Xd(n){var i=or(n.target);if(i!==null){var u=ar(i);if(u!==null){if(i=u.tag,i===13){if(i=Md(u),i!==null){n.blockedOn=i,Qd(n.priority,function(){Kd(u)});return}}else if(i===3&&u.stateNode.current.memoizedState.isDehydrated){n.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}n.blockedOn=null}function js(n){if(n.blockedOn!==null)return!1;for(var i=n.targetContainers;0<i.length;){var u=Go(n.domEventName,n.eventSystemFlags,i[0],n.nativeEvent);if(u===null){u=n.nativeEvent;var d=new u.constructor(u.type,u);No=d,u.target.dispatchEvent(d),No=null}else return i=ji(u),i!==null&&Fo(i),n.blockedOn=u,!1;i.shift()}return!0}function ef(n,i,u){js(n)&&u.delete(i)}function c_(){Bo=!1,kn!==null&&js(kn)&&(kn=null),Tn!==null&&js(Tn)&&(Tn=null),xn!==null&&js(xn)&&(xn=null),vi.forEach(ef),wi.forEach(ef)}function Ei(n,i){n.blockedOn===i&&(n.blockedOn=null,Bo||(Bo=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,c_)))}function Si(n){function i(p){return Ei(p,n)}if(0<Ls.length){Ei(Ls[0],n);for(var u=1;u<Ls.length;u++){var d=Ls[u];d.blockedOn===n&&(d.blockedOn=null)}}for(kn!==null&&Ei(kn,n),Tn!==null&&Ei(Tn,n),xn!==null&&Ei(xn,n),vi.forEach(i),wi.forEach(i),u=0;u<Rn.length;u++)d=Rn[u],d.blockedOn===n&&(d.blockedOn=null);for(;0<Rn.length&&(u=Rn[0],u.blockedOn===null);)Xd(u),u.blockedOn===null&&Rn.shift()}var Ir=$.ReactCurrentBatchConfig,$s=!0;function d_(n,i,u,d){var p=Re,g=Ir.transition;Ir.transition=null;try{Re=1,Ho(n,i,u,d)}finally{Re=p,Ir.transition=g}}function f_(n,i,u,d){var p=Re,g=Ir.transition;Ir.transition=null;try{Re=4,Ho(n,i,u,d)}finally{Re=p,Ir.transition=g}}function Ho(n,i,u,d){if($s){var p=Go(n,i,u,d);if(p===null)ou(n,i,d,Ds,u),Yd(n,d);else if(l_(p,n,i,u,d))d.stopPropagation();else if(Yd(n,d),i&4&&-1<u_.indexOf(n)){for(;p!==null;){var g=ji(p);if(g!==null&&Wd(g),g=Go(n,i,u,d),g===null&&ou(n,i,d,Ds,u),g===p)break;p=g}p!==null&&d.stopPropagation()}else ou(n,i,d,null,u)}}var Ds=null;function Go(n,i,u,d){if(Ds=null,n=Ao(d),n=or(n),n!==null)if(i=ar(n),i===null)n=null;else if(u=i.tag,u===13){if(n=Md(i),n!==null)return n;n=null}else if(u===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;n=null}else i!==n&&(n=null);return Ds=n,null}function tf(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xy()){case Do:return 1;case Gd:return 4;case Is:case e_:return 16;case qd:return 536870912;default:return 16}default:return 16}}var In=null,qo=null,Ms=null;function nf(){if(Ms)return Ms;var n,i=qo,u=i.length,d,p="value"in In?In.value:In.textContent,g=p.length;for(n=0;n<u&&i[n]===p[n];n++);var v=u-n;for(d=1;d<=v&&i[u-d]===p[g-d];d++);return Ms=p.slice(n,1<d?1-d:void 0)}function Us(n){var i=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&i===13&&(n=13)):n=i,n===10&&(n=13),32<=n||n===13?n:0}function zs(){return!0}function rf(){return!1}function It(n){function i(u,d,p,g,v){this._reactName=u,this._targetInst=p,this.type=d,this.nativeEvent=g,this.target=v,this.currentTarget=null;for(var k in n)n.hasOwnProperty(k)&&(u=n[k],this[k]=u?u(g):g[k]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?zs:rf,this.isPropagationStopped=rf,this}return M(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=zs)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=zs)},persist:function(){},isPersistent:zs}),i}var Cr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Vo=It(Cr),Oi=M({},Cr,{view:0,detail:0}),h_=It(Oi),Zo,Wo,ki,Fs=M({},Oi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Jo,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==ki&&(ki&&n.type==="mousemove"?(Zo=n.screenX-ki.screenX,Wo=n.screenY-ki.screenY):Wo=Zo=0,ki=n),Zo)},movementY:function(n){return"movementY"in n?n.movementY:Wo}}),sf=It(Fs),p_=M({},Fs,{dataTransfer:0}),m_=It(p_),g_=M({},Oi,{relatedTarget:0}),Ko=It(g_),y_=M({},Cr,{animationName:0,elapsedTime:0,pseudoElement:0}),__=It(y_),v_=M({},Cr,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),w_=It(v_),b_=M({},Cr,{data:0}),af=It(b_),E_={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},S_={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},O_={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function k_(n){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(n):(n=O_[n])?!!i[n]:!1}function Jo(){return k_}var T_=M({},Oi,{key:function(n){if(n.key){var i=E_[n.key]||n.key;if(i!=="Unidentified")return i}return n.type==="keypress"?(n=Us(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?S_[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Jo,charCode:function(n){return n.type==="keypress"?Us(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Us(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),x_=It(T_),R_=M({},Fs,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),of=It(R_),I_=M({},Oi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Jo}),C_=It(I_),N_=M({},Cr,{propertyName:0,elapsedTime:0,pseudoElement:0}),A_=It(N_),P_=M({},Fs,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),L_=It(P_),j_=[9,13,27,32],Qo=c&&"CompositionEvent"in window,Ti=null;c&&"documentMode"in document&&(Ti=document.documentMode);var $_=c&&"TextEvent"in window&&!Ti,uf=c&&(!Qo||Ti&&8<Ti&&11>=Ti),lf=" ",cf=!1;function df(n,i){switch(n){case"keyup":return j_.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ff(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Nr=!1;function D_(n,i){switch(n){case"compositionend":return ff(i);case"keypress":return i.which!==32?null:(cf=!0,lf);case"textInput":return n=i.data,n===lf&&cf?null:n;default:return null}}function M_(n,i){if(Nr)return n==="compositionend"||!Qo&&df(n,i)?(n=nf(),Ms=qo=In=null,Nr=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return uf&&i.locale!=="ko"?null:i.data;default:return null}}var U_={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function hf(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i==="input"?!!U_[n.type]:i==="textarea"}function pf(n,i,u,d){Pd(d),i=Vs(i,"onChange"),0<i.length&&(u=new Vo("onChange","change",null,u,d),n.push({event:u,listeners:i}))}var xi=null,Ri=null;function z_(n){Af(n,0)}function Bs(n){var i=$r(n);if(bd(i))return n}function F_(n,i){if(n==="change")return i}var mf=!1;if(c){var Yo;if(c){var Xo="oninput"in document;if(!Xo){var gf=document.createElement("div");gf.setAttribute("oninput","return;"),Xo=typeof gf.oninput=="function"}Yo=Xo}else Yo=!1;mf=Yo&&(!document.documentMode||9<document.documentMode)}function yf(){xi&&(xi.detachEvent("onpropertychange",_f),Ri=xi=null)}function _f(n){if(n.propertyName==="value"&&Bs(Ri)){var i=[];pf(i,Ri,n,Ao(n)),Dd(z_,i)}}function B_(n,i,u){n==="focusin"?(yf(),xi=i,Ri=u,xi.attachEvent("onpropertychange",_f)):n==="focusout"&&yf()}function H_(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Bs(Ri)}function G_(n,i){if(n==="click")return Bs(i)}function q_(n,i){if(n==="input"||n==="change")return Bs(i)}function V_(n,i){return n===i&&(n!==0||1/n===1/i)||n!==n&&i!==i}var Vt=typeof Object.is=="function"?Object.is:V_;function Ii(n,i){if(Vt(n,i))return!0;if(typeof n!="object"||n===null||typeof i!="object"||i===null)return!1;var u=Object.keys(n),d=Object.keys(i);if(u.length!==d.length)return!1;for(d=0;d<u.length;d++){var p=u[d];if(!f.call(i,p)||!Vt(n[p],i[p]))return!1}return!0}function vf(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function wf(n,i){var u=vf(n);n=0;for(var d;u;){if(u.nodeType===3){if(d=n+u.textContent.length,n<=i&&d>=i)return{node:u,offset:i-n};n=d}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=vf(u)}}function bf(n,i){return n&&i?n===i?!0:n&&n.nodeType===3?!1:i&&i.nodeType===3?bf(n,i.parentNode):"contains"in n?n.contains(i):n.compareDocumentPosition?!!(n.compareDocumentPosition(i)&16):!1:!1}function Ef(){for(var n=window,i=ks();i instanceof n.HTMLIFrameElement;){try{var u=typeof i.contentWindow.location.href=="string"}catch{u=!1}if(u)n=i.contentWindow;else break;i=ks(n.document)}return i}function eu(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i&&(i==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||i==="textarea"||n.contentEditable==="true")}function Z_(n){var i=Ef(),u=n.focusedElem,d=n.selectionRange;if(i!==u&&u&&u.ownerDocument&&bf(u.ownerDocument.documentElement,u)){if(d!==null&&eu(u)){if(i=d.start,n=d.end,n===void 0&&(n=i),"selectionStart"in u)u.selectionStart=i,u.selectionEnd=Math.min(n,u.value.length);else if(n=(i=u.ownerDocument||document)&&i.defaultView||window,n.getSelection){n=n.getSelection();var p=u.textContent.length,g=Math.min(d.start,p);d=d.end===void 0?g:Math.min(d.end,p),!n.extend&&g>d&&(p=d,d=g,g=p),p=wf(u,g);var v=wf(u,d);p&&v&&(n.rangeCount!==1||n.anchorNode!==p.node||n.anchorOffset!==p.offset||n.focusNode!==v.node||n.focusOffset!==v.offset)&&(i=i.createRange(),i.setStart(p.node,p.offset),n.removeAllRanges(),g>d?(n.addRange(i),n.extend(v.node,v.offset)):(i.setEnd(v.node,v.offset),n.addRange(i)))}}for(i=[],n=u;n=n.parentNode;)n.nodeType===1&&i.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof u.focus=="function"&&u.focus(),u=0;u<i.length;u++)n=i[u],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var W_=c&&"documentMode"in document&&11>=document.documentMode,Ar=null,tu=null,Ci=null,nu=!1;function Sf(n,i,u){var d=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;nu||Ar==null||Ar!==ks(d)||(d=Ar,"selectionStart"in d&&eu(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),Ci&&Ii(Ci,d)||(Ci=d,d=Vs(tu,"onSelect"),0<d.length&&(i=new Vo("onSelect","select",null,i,u),n.push({event:i,listeners:d}),i.target=Ar)))}function Hs(n,i){var u={};return u[n.toLowerCase()]=i.toLowerCase(),u["Webkit"+n]="webkit"+i,u["Moz"+n]="moz"+i,u}var Pr={animationend:Hs("Animation","AnimationEnd"),animationiteration:Hs("Animation","AnimationIteration"),animationstart:Hs("Animation","AnimationStart"),transitionend:Hs("Transition","TransitionEnd")},ru={},Of={};c&&(Of=document.createElement("div").style,"AnimationEvent"in window||(delete Pr.animationend.animation,delete Pr.animationiteration.animation,delete Pr.animationstart.animation),"TransitionEvent"in window||delete Pr.transitionend.transition);function Gs(n){if(ru[n])return ru[n];if(!Pr[n])return n;var i=Pr[n],u;for(u in i)if(i.hasOwnProperty(u)&&u in Of)return ru[n]=i[u];return n}var kf=Gs("animationend"),Tf=Gs("animationiteration"),xf=Gs("animationstart"),Rf=Gs("transitionend"),If=new Map,Cf="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Cn(n,i){If.set(n,i),o(i,[n])}for(var iu=0;iu<Cf.length;iu++){var su=Cf[iu],K_=su.toLowerCase(),J_=su[0].toUpperCase()+su.slice(1);Cn(K_,"on"+J_)}Cn(kf,"onAnimationEnd"),Cn(Tf,"onAnimationIteration"),Cn(xf,"onAnimationStart"),Cn("dblclick","onDoubleClick"),Cn("focusin","onFocus"),Cn("focusout","onBlur"),Cn(Rf,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ni="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Q_=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ni));function Nf(n,i,u){var d=n.type||"unknown-event";n.currentTarget=u,Ky(d,i,void 0,n),n.currentTarget=null}function Af(n,i){i=(i&4)!==0;for(var u=0;u<n.length;u++){var d=n[u],p=d.event;d=d.listeners;e:{var g=void 0;if(i)for(var v=d.length-1;0<=v;v--){var k=d[v],x=k.instance,L=k.currentTarget;if(k=k.listener,x!==g&&p.isPropagationStopped())break e;Nf(p,k,L),g=x}else for(v=0;v<d.length;v++){if(k=d[v],x=k.instance,L=k.currentTarget,k=k.listener,x!==g&&p.isPropagationStopped())break e;Nf(p,k,L),g=x}}}if(Rs)throw n=$o,Rs=!1,$o=null,n}function Le(n,i){var u=i[hu];u===void 0&&(u=i[hu]=new Set);var d=n+"__bubble";u.has(d)||(Pf(i,n,2,!1),u.add(d))}function au(n,i,u){var d=0;i&&(d|=4),Pf(u,n,d,i)}var qs="_reactListening"+Math.random().toString(36).slice(2);function Ai(n){if(!n[qs]){n[qs]=!0,r.forEach(function(u){u!=="selectionchange"&&(Q_.has(u)||au(u,!1,n),au(u,!0,n))});var i=n.nodeType===9?n:n.ownerDocument;i===null||i[qs]||(i[qs]=!0,au("selectionchange",!1,i))}}function Pf(n,i,u,d){switch(tf(i)){case 1:var p=d_;break;case 4:p=f_;break;default:p=Ho}u=p.bind(null,i,u,n),p=void 0,!jo||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(p=!0),d?p!==void 0?n.addEventListener(i,u,{capture:!0,passive:p}):n.addEventListener(i,u,!0):p!==void 0?n.addEventListener(i,u,{passive:p}):n.addEventListener(i,u,!1)}function ou(n,i,u,d,p){var g=d;if((i&1)===0&&(i&2)===0&&d!==null)e:for(;;){if(d===null)return;var v=d.tag;if(v===3||v===4){var k=d.stateNode.containerInfo;if(k===p||k.nodeType===8&&k.parentNode===p)break;if(v===4)for(v=d.return;v!==null;){var x=v.tag;if((x===3||x===4)&&(x=v.stateNode.containerInfo,x===p||x.nodeType===8&&x.parentNode===p))return;v=v.return}for(;k!==null;){if(v=or(k),v===null)return;if(x=v.tag,x===5||x===6){d=g=v;continue e}k=k.parentNode}}d=d.return}Dd(function(){var L=g,B=Ao(u),H=[];e:{var F=If.get(n);if(F!==void 0){var Y=Vo,re=n;switch(n){case"keypress":if(Us(u)===0)break e;case"keydown":case"keyup":Y=x_;break;case"focusin":re="focus",Y=Ko;break;case"focusout":re="blur",Y=Ko;break;case"beforeblur":case"afterblur":Y=Ko;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Y=sf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Y=m_;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Y=C_;break;case kf:case Tf:case xf:Y=__;break;case Rf:Y=A_;break;case"scroll":Y=h_;break;case"wheel":Y=L_;break;case"copy":case"cut":case"paste":Y=w_;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Y=of}var ie=(i&4)!==0,Be=!ie&&n==="scroll",N=ie?F!==null?F+"Capture":null:F;ie=[];for(var C=L,A;C!==null;){A=C;var q=A.stateNode;if(A.tag===5&&q!==null&&(A=q,N!==null&&(q=pi(C,N),q!=null&&ie.push(Pi(C,q,A)))),Be)break;C=C.return}0<ie.length&&(F=new Y(F,re,null,u,B),H.push({event:F,listeners:ie}))}}if((i&7)===0){e:{if(F=n==="mouseover"||n==="pointerover",Y=n==="mouseout"||n==="pointerout",F&&u!==No&&(re=u.relatedTarget||u.fromElement)&&(or(re)||re[pn]))break e;if((Y||F)&&(F=B.window===B?B:(F=B.ownerDocument)?F.defaultView||F.parentWindow:window,Y?(re=u.relatedTarget||u.toElement,Y=L,re=re?or(re):null,re!==null&&(Be=ar(re),re!==Be||re.tag!==5&&re.tag!==6)&&(re=null)):(Y=null,re=L),Y!==re)){if(ie=sf,q="onMouseLeave",N="onMouseEnter",C="mouse",(n==="pointerout"||n==="pointerover")&&(ie=of,q="onPointerLeave",N="onPointerEnter",C="pointer"),Be=Y==null?F:$r(Y),A=re==null?F:$r(re),F=new ie(q,C+"leave",Y,u,B),F.target=Be,F.relatedTarget=A,q=null,or(B)===L&&(ie=new ie(N,C+"enter",re,u,B),ie.target=A,ie.relatedTarget=Be,q=ie),Be=q,Y&&re)t:{for(ie=Y,N=re,C=0,A=ie;A;A=Lr(A))C++;for(A=0,q=N;q;q=Lr(q))A++;for(;0<C-A;)ie=Lr(ie),C--;for(;0<A-C;)N=Lr(N),A--;for(;C--;){if(ie===N||N!==null&&ie===N.alternate)break t;ie=Lr(ie),N=Lr(N)}ie=null}else ie=null;Y!==null&&Lf(H,F,Y,ie,!1),re!==null&&Be!==null&&Lf(H,Be,re,ie,!0)}}e:{if(F=L?$r(L):window,Y=F.nodeName&&F.nodeName.toLowerCase(),Y==="select"||Y==="input"&&F.type==="file")var ae=F_;else if(hf(F))if(mf)ae=q_;else{ae=H_;var de=B_}else(Y=F.nodeName)&&Y.toLowerCase()==="input"&&(F.type==="checkbox"||F.type==="radio")&&(ae=G_);if(ae&&(ae=ae(n,L))){pf(H,ae,u,B);break e}de&&de(n,F,L),n==="focusout"&&(de=F._wrapperState)&&de.controlled&&F.type==="number"&&To(F,"number",F.value)}switch(de=L?$r(L):window,n){case"focusin":(hf(de)||de.contentEditable==="true")&&(Ar=de,tu=L,Ci=null);break;case"focusout":Ci=tu=Ar=null;break;case"mousedown":nu=!0;break;case"contextmenu":case"mouseup":case"dragend":nu=!1,Sf(H,u,B);break;case"selectionchange":if(W_)break;case"keydown":case"keyup":Sf(H,u,B)}var fe;if(Qo)e:{switch(n){case"compositionstart":var he="onCompositionStart";break e;case"compositionend":he="onCompositionEnd";break e;case"compositionupdate":he="onCompositionUpdate";break e}he=void 0}else Nr?df(n,u)&&(he="onCompositionEnd"):n==="keydown"&&u.keyCode===229&&(he="onCompositionStart");he&&(uf&&u.locale!=="ko"&&(Nr||he!=="onCompositionStart"?he==="onCompositionEnd"&&Nr&&(fe=nf()):(In=B,qo="value"in In?In.value:In.textContent,Nr=!0)),de=Vs(L,he),0<de.length&&(he=new af(he,n,null,u,B),H.push({event:he,listeners:de}),fe?he.data=fe:(fe=ff(u),fe!==null&&(he.data=fe)))),(fe=$_?D_(n,u):M_(n,u))&&(L=Vs(L,"onBeforeInput"),0<L.length&&(B=new af("onBeforeInput","beforeinput",null,u,B),H.push({event:B,listeners:L}),B.data=fe))}Af(H,i)})}function Pi(n,i,u){return{instance:n,listener:i,currentTarget:u}}function Vs(n,i){for(var u=i+"Capture",d=[];n!==null;){var p=n,g=p.stateNode;p.tag===5&&g!==null&&(p=g,g=pi(n,u),g!=null&&d.unshift(Pi(n,g,p)),g=pi(n,i),g!=null&&d.push(Pi(n,g,p))),n=n.return}return d}function Lr(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function Lf(n,i,u,d,p){for(var g=i._reactName,v=[];u!==null&&u!==d;){var k=u,x=k.alternate,L=k.stateNode;if(x!==null&&x===d)break;k.tag===5&&L!==null&&(k=L,p?(x=pi(u,g),x!=null&&v.unshift(Pi(u,x,k))):p||(x=pi(u,g),x!=null&&v.push(Pi(u,x,k)))),u=u.return}v.length!==0&&n.push({event:i,listeners:v})}var Y_=/\r\n?/g,X_=/\u0000|\uFFFD/g;function jf(n){return(typeof n=="string"?n:""+n).replace(Y_,`
`).replace(X_,"")}function Zs(n,i,u){if(i=jf(i),jf(n)!==i&&u)throw Error(t(425))}function Ws(){}var uu=null,lu=null;function cu(n,i){return n==="textarea"||n==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var du=typeof setTimeout=="function"?setTimeout:void 0,ev=typeof clearTimeout=="function"?clearTimeout:void 0,$f=typeof Promise=="function"?Promise:void 0,tv=typeof queueMicrotask=="function"?queueMicrotask:typeof $f<"u"?function(n){return $f.resolve(null).then(n).catch(nv)}:du;function nv(n){setTimeout(function(){throw n})}function fu(n,i){var u=i,d=0;do{var p=u.nextSibling;if(n.removeChild(u),p&&p.nodeType===8)if(u=p.data,u==="/$"){if(d===0){n.removeChild(p),Si(i);return}d--}else u!=="$"&&u!=="$?"&&u!=="$!"||d++;u=p}while(u);Si(i)}function Nn(n){for(;n!=null;n=n.nextSibling){var i=n.nodeType;if(i===1||i===3)break;if(i===8){if(i=n.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return n}function Df(n){n=n.previousSibling;for(var i=0;n;){if(n.nodeType===8){var u=n.data;if(u==="$"||u==="$!"||u==="$?"){if(i===0)return n;i--}else u==="/$"&&i++}n=n.previousSibling}return null}var jr=Math.random().toString(36).slice(2),on="__reactFiber$"+jr,Li="__reactProps$"+jr,pn="__reactContainer$"+jr,hu="__reactEvents$"+jr,rv="__reactListeners$"+jr,iv="__reactHandles$"+jr;function or(n){var i=n[on];if(i)return i;for(var u=n.parentNode;u;){if(i=u[pn]||u[on]){if(u=i.alternate,i.child!==null||u!==null&&u.child!==null)for(n=Df(n);n!==null;){if(u=n[on])return u;n=Df(n)}return i}n=u,u=n.parentNode}return null}function ji(n){return n=n[on]||n[pn],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function $r(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(t(33))}function Ks(n){return n[Li]||null}var pu=[],Dr=-1;function An(n){return{current:n}}function je(n){0>Dr||(n.current=pu[Dr],pu[Dr]=null,Dr--)}function Pe(n,i){Dr++,pu[Dr]=n.current,n.current=i}var Pn={},ot=An(Pn),_t=An(!1),ur=Pn;function Mr(n,i){var u=n.type.contextTypes;if(!u)return Pn;var d=n.stateNode;if(d&&d.__reactInternalMemoizedUnmaskedChildContext===i)return d.__reactInternalMemoizedMaskedChildContext;var p={},g;for(g in u)p[g]=i[g];return d&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=i,n.__reactInternalMemoizedMaskedChildContext=p),p}function vt(n){return n=n.childContextTypes,n!=null}function Js(){je(_t),je(ot)}function Mf(n,i,u){if(ot.current!==Pn)throw Error(t(168));Pe(ot,i),Pe(_t,u)}function Uf(n,i,u){var d=n.stateNode;if(i=i.childContextTypes,typeof d.getChildContext!="function")return u;d=d.getChildContext();for(var p in d)if(!(p in i))throw Error(t(108,ve(n)||"Unknown",p));return M({},u,d)}function Qs(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Pn,ur=ot.current,Pe(ot,n),Pe(_t,_t.current),!0}function zf(n,i,u){var d=n.stateNode;if(!d)throw Error(t(169));u?(n=Uf(n,i,ur),d.__reactInternalMemoizedMergedChildContext=n,je(_t),je(ot),Pe(ot,n)):je(_t),Pe(_t,u)}var mn=null,Ys=!1,mu=!1;function Ff(n){mn===null?mn=[n]:mn.push(n)}function sv(n){Ys=!0,Ff(n)}function Ln(){if(!mu&&mn!==null){mu=!0;var n=0,i=Re;try{var u=mn;for(Re=1;n<u.length;n++){var d=u[n];do d=d(!0);while(d!==null)}mn=null,Ys=!1}catch(p){throw mn!==null&&(mn=mn.slice(n+1)),Bd(Do,Ln),p}finally{Re=i,mu=!1}}return null}var Ur=[],zr=0,Xs=null,ea=0,Dt=[],Mt=0,lr=null,gn=1,yn="";function cr(n,i){Ur[zr++]=ea,Ur[zr++]=Xs,Xs=n,ea=i}function Bf(n,i,u){Dt[Mt++]=gn,Dt[Mt++]=yn,Dt[Mt++]=lr,lr=n;var d=gn;n=yn;var p=32-qt(d)-1;d&=~(1<<p),u+=1;var g=32-qt(i)+p;if(30<g){var v=p-p%5;g=(d&(1<<v)-1).toString(32),d>>=v,p-=v,gn=1<<32-qt(i)+p|u<<p|d,yn=g+n}else gn=1<<g|u<<p|d,yn=n}function gu(n){n.return!==null&&(cr(n,1),Bf(n,1,0))}function yu(n){for(;n===Xs;)Xs=Ur[--zr],Ur[zr]=null,ea=Ur[--zr],Ur[zr]=null;for(;n===lr;)lr=Dt[--Mt],Dt[Mt]=null,yn=Dt[--Mt],Dt[Mt]=null,gn=Dt[--Mt],Dt[Mt]=null}var Ct=null,Nt=null,$e=!1,Zt=null;function Hf(n,i){var u=Bt(5,null,null,0);u.elementType="DELETED",u.stateNode=i,u.return=n,i=n.deletions,i===null?(n.deletions=[u],n.flags|=16):i.push(u)}function Gf(n,i){switch(n.tag){case 5:var u=n.type;return i=i.nodeType!==1||u.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(n.stateNode=i,Ct=n,Nt=Nn(i.firstChild),!0):!1;case 6:return i=n.pendingProps===""||i.nodeType!==3?null:i,i!==null?(n.stateNode=i,Ct=n,Nt=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(u=lr!==null?{id:gn,overflow:yn}:null,n.memoizedState={dehydrated:i,treeContext:u,retryLane:1073741824},u=Bt(18,null,null,0),u.stateNode=i,u.return=n,n.child=u,Ct=n,Nt=null,!0):!1;default:return!1}}function _u(n){return(n.mode&1)!==0&&(n.flags&128)===0}function vu(n){if($e){var i=Nt;if(i){var u=i;if(!Gf(n,i)){if(_u(n))throw Error(t(418));i=Nn(u.nextSibling);var d=Ct;i&&Gf(n,i)?Hf(d,u):(n.flags=n.flags&-4097|2,$e=!1,Ct=n)}}else{if(_u(n))throw Error(t(418));n.flags=n.flags&-4097|2,$e=!1,Ct=n}}}function qf(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Ct=n}function ta(n){if(n!==Ct)return!1;if(!$e)return qf(n),$e=!0,!1;var i;if((i=n.tag!==3)&&!(i=n.tag!==5)&&(i=n.type,i=i!=="head"&&i!=="body"&&!cu(n.type,n.memoizedProps)),i&&(i=Nt)){if(_u(n))throw Vf(),Error(t(418));for(;i;)Hf(n,i),i=Nn(i.nextSibling)}if(qf(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(t(317));e:{for(n=n.nextSibling,i=0;n;){if(n.nodeType===8){var u=n.data;if(u==="/$"){if(i===0){Nt=Nn(n.nextSibling);break e}i--}else u!=="$"&&u!=="$!"&&u!=="$?"||i++}n=n.nextSibling}Nt=null}}else Nt=Ct?Nn(n.stateNode.nextSibling):null;return!0}function Vf(){for(var n=Nt;n;)n=Nn(n.nextSibling)}function Fr(){Nt=Ct=null,$e=!1}function wu(n){Zt===null?Zt=[n]:Zt.push(n)}var av=$.ReactCurrentBatchConfig;function $i(n,i,u){if(n=u.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(u._owner){if(u=u._owner,u){if(u.tag!==1)throw Error(t(309));var d=u.stateNode}if(!d)throw Error(t(147,n));var p=d,g=""+n;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===g?i.ref:(i=function(v){var k=p.refs;v===null?delete k[g]:k[g]=v},i._stringRef=g,i)}if(typeof n!="string")throw Error(t(284));if(!u._owner)throw Error(t(290,n))}return n}function na(n,i){throw n=Object.prototype.toString.call(i),Error(t(31,n==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":n))}function Zf(n){var i=n._init;return i(n._payload)}function Wf(n){function i(N,C){if(n){var A=N.deletions;A===null?(N.deletions=[C],N.flags|=16):A.push(C)}}function u(N,C){if(!n)return null;for(;C!==null;)i(N,C),C=C.sibling;return null}function d(N,C){for(N=new Map;C!==null;)C.key!==null?N.set(C.key,C):N.set(C.index,C),C=C.sibling;return N}function p(N,C){return N=Bn(N,C),N.index=0,N.sibling=null,N}function g(N,C,A){return N.index=A,n?(A=N.alternate,A!==null?(A=A.index,A<C?(N.flags|=2,C):A):(N.flags|=2,C)):(N.flags|=1048576,C)}function v(N){return n&&N.alternate===null&&(N.flags|=2),N}function k(N,C,A,q){return C===null||C.tag!==6?(C=dl(A,N.mode,q),C.return=N,C):(C=p(C,A),C.return=N,C)}function x(N,C,A,q){var ae=A.type;return ae===Q?B(N,C,A.props.children,q,A.key):C!==null&&(C.elementType===ae||typeof ae=="object"&&ae!==null&&ae.$$typeof===ee&&Zf(ae)===C.type)?(q=p(C,A.props),q.ref=$i(N,C,A),q.return=N,q):(q=Ta(A.type,A.key,A.props,null,N.mode,q),q.ref=$i(N,C,A),q.return=N,q)}function L(N,C,A,q){return C===null||C.tag!==4||C.stateNode.containerInfo!==A.containerInfo||C.stateNode.implementation!==A.implementation?(C=fl(A,N.mode,q),C.return=N,C):(C=p(C,A.children||[]),C.return=N,C)}function B(N,C,A,q,ae){return C===null||C.tag!==7?(C=_r(A,N.mode,q,ae),C.return=N,C):(C=p(C,A),C.return=N,C)}function H(N,C,A){if(typeof C=="string"&&C!==""||typeof C=="number")return C=dl(""+C,N.mode,A),C.return=N,C;if(typeof C=="object"&&C!==null){switch(C.$$typeof){case P:return A=Ta(C.type,C.key,C.props,null,N.mode,A),A.ref=$i(N,null,C),A.return=N,A;case z:return C=fl(C,N.mode,A),C.return=N,C;case ee:var q=C._init;return H(N,q(C._payload),A)}if(di(C)||U(C))return C=_r(C,N.mode,A,null),C.return=N,C;na(N,C)}return null}function F(N,C,A,q){var ae=C!==null?C.key:null;if(typeof A=="string"&&A!==""||typeof A=="number")return ae!==null?null:k(N,C,""+A,q);if(typeof A=="object"&&A!==null){switch(A.$$typeof){case P:return A.key===ae?x(N,C,A,q):null;case z:return A.key===ae?L(N,C,A,q):null;case ee:return ae=A._init,F(N,C,ae(A._payload),q)}if(di(A)||U(A))return ae!==null?null:B(N,C,A,q,null);na(N,A)}return null}function Y(N,C,A,q,ae){if(typeof q=="string"&&q!==""||typeof q=="number")return N=N.get(A)||null,k(C,N,""+q,ae);if(typeof q=="object"&&q!==null){switch(q.$$typeof){case P:return N=N.get(q.key===null?A:q.key)||null,x(C,N,q,ae);case z:return N=N.get(q.key===null?A:q.key)||null,L(C,N,q,ae);case ee:var de=q._init;return Y(N,C,A,de(q._payload),ae)}if(di(q)||U(q))return N=N.get(A)||null,B(C,N,q,ae,null);na(C,q)}return null}function re(N,C,A,q){for(var ae=null,de=null,fe=C,he=C=0,et=null;fe!==null&&he<A.length;he++){fe.index>he?(et=fe,fe=null):et=fe.sibling;var Oe=F(N,fe,A[he],q);if(Oe===null){fe===null&&(fe=et);break}n&&fe&&Oe.alternate===null&&i(N,fe),C=g(Oe,C,he),de===null?ae=Oe:de.sibling=Oe,de=Oe,fe=et}if(he===A.length)return u(N,fe),$e&&cr(N,he),ae;if(fe===null){for(;he<A.length;he++)fe=H(N,A[he],q),fe!==null&&(C=g(fe,C,he),de===null?ae=fe:de.sibling=fe,de=fe);return $e&&cr(N,he),ae}for(fe=d(N,fe);he<A.length;he++)et=Y(fe,N,he,A[he],q),et!==null&&(n&&et.alternate!==null&&fe.delete(et.key===null?he:et.key),C=g(et,C,he),de===null?ae=et:de.sibling=et,de=et);return n&&fe.forEach(function(Hn){return i(N,Hn)}),$e&&cr(N,he),ae}function ie(N,C,A,q){var ae=U(A);if(typeof ae!="function")throw Error(t(150));if(A=ae.call(A),A==null)throw Error(t(151));for(var de=ae=null,fe=C,he=C=0,et=null,Oe=A.next();fe!==null&&!Oe.done;he++,Oe=A.next()){fe.index>he?(et=fe,fe=null):et=fe.sibling;var Hn=F(N,fe,Oe.value,q);if(Hn===null){fe===null&&(fe=et);break}n&&fe&&Hn.alternate===null&&i(N,fe),C=g(Hn,C,he),de===null?ae=Hn:de.sibling=Hn,de=Hn,fe=et}if(Oe.done)return u(N,fe),$e&&cr(N,he),ae;if(fe===null){for(;!Oe.done;he++,Oe=A.next())Oe=H(N,Oe.value,q),Oe!==null&&(C=g(Oe,C,he),de===null?ae=Oe:de.sibling=Oe,de=Oe);return $e&&cr(N,he),ae}for(fe=d(N,fe);!Oe.done;he++,Oe=A.next())Oe=Y(fe,N,he,Oe.value,q),Oe!==null&&(n&&Oe.alternate!==null&&fe.delete(Oe.key===null?he:Oe.key),C=g(Oe,C,he),de===null?ae=Oe:de.sibling=Oe,de=Oe);return n&&fe.forEach(function(Uv){return i(N,Uv)}),$e&&cr(N,he),ae}function Be(N,C,A,q){if(typeof A=="object"&&A!==null&&A.type===Q&&A.key===null&&(A=A.props.children),typeof A=="object"&&A!==null){switch(A.$$typeof){case P:e:{for(var ae=A.key,de=C;de!==null;){if(de.key===ae){if(ae=A.type,ae===Q){if(de.tag===7){u(N,de.sibling),C=p(de,A.props.children),C.return=N,N=C;break e}}else if(de.elementType===ae||typeof ae=="object"&&ae!==null&&ae.$$typeof===ee&&Zf(ae)===de.type){u(N,de.sibling),C=p(de,A.props),C.ref=$i(N,de,A),C.return=N,N=C;break e}u(N,de);break}else i(N,de);de=de.sibling}A.type===Q?(C=_r(A.props.children,N.mode,q,A.key),C.return=N,N=C):(q=Ta(A.type,A.key,A.props,null,N.mode,q),q.ref=$i(N,C,A),q.return=N,N=q)}return v(N);case z:e:{for(de=A.key;C!==null;){if(C.key===de)if(C.tag===4&&C.stateNode.containerInfo===A.containerInfo&&C.stateNode.implementation===A.implementation){u(N,C.sibling),C=p(C,A.children||[]),C.return=N,N=C;break e}else{u(N,C);break}else i(N,C);C=C.sibling}C=fl(A,N.mode,q),C.return=N,N=C}return v(N);case ee:return de=A._init,Be(N,C,de(A._payload),q)}if(di(A))return re(N,C,A,q);if(U(A))return ie(N,C,A,q);na(N,A)}return typeof A=="string"&&A!==""||typeof A=="number"?(A=""+A,C!==null&&C.tag===6?(u(N,C.sibling),C=p(C,A),C.return=N,N=C):(u(N,C),C=dl(A,N.mode,q),C.return=N,N=C),v(N)):u(N,C)}return Be}var Br=Wf(!0),Kf=Wf(!1),ra=An(null),ia=null,Hr=null,bu=null;function Eu(){bu=Hr=ia=null}function Su(n){var i=ra.current;je(ra),n._currentValue=i}function Ou(n,i,u){for(;n!==null;){var d=n.alternate;if((n.childLanes&i)!==i?(n.childLanes|=i,d!==null&&(d.childLanes|=i)):d!==null&&(d.childLanes&i)!==i&&(d.childLanes|=i),n===u)break;n=n.return}}function Gr(n,i){ia=n,bu=Hr=null,n=n.dependencies,n!==null&&n.firstContext!==null&&((n.lanes&i)!==0&&(wt=!0),n.firstContext=null)}function Ut(n){var i=n._currentValue;if(bu!==n)if(n={context:n,memoizedValue:i,next:null},Hr===null){if(ia===null)throw Error(t(308));Hr=n,ia.dependencies={lanes:0,firstContext:n}}else Hr=Hr.next=n;return i}var dr=null;function ku(n){dr===null?dr=[n]:dr.push(n)}function Jf(n,i,u,d){var p=i.interleaved;return p===null?(u.next=u,ku(i)):(u.next=p.next,p.next=u),i.interleaved=u,_n(n,d)}function _n(n,i){n.lanes|=i;var u=n.alternate;for(u!==null&&(u.lanes|=i),u=n,n=n.return;n!==null;)n.childLanes|=i,u=n.alternate,u!==null&&(u.childLanes|=i),u=n,n=n.return;return u.tag===3?u.stateNode:null}var jn=!1;function Tu(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Qf(n,i){n=n.updateQueue,i.updateQueue===n&&(i.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function vn(n,i){return{eventTime:n,lane:i,tag:0,payload:null,callback:null,next:null}}function $n(n,i,u){var d=n.updateQueue;if(d===null)return null;if(d=d.shared,(we&2)!==0){var p=d.pending;return p===null?i.next=i:(i.next=p.next,p.next=i),d.pending=i,_n(n,u)}return p=d.interleaved,p===null?(i.next=i,ku(d)):(i.next=p.next,p.next=i),d.interleaved=i,_n(n,u)}function sa(n,i,u){if(i=i.updateQueue,i!==null&&(i=i.shared,(u&4194240)!==0)){var d=i.lanes;d&=n.pendingLanes,u|=d,i.lanes=u,zo(n,u)}}function Yf(n,i){var u=n.updateQueue,d=n.alternate;if(d!==null&&(d=d.updateQueue,u===d)){var p=null,g=null;if(u=u.firstBaseUpdate,u!==null){do{var v={eventTime:u.eventTime,lane:u.lane,tag:u.tag,payload:u.payload,callback:u.callback,next:null};g===null?p=g=v:g=g.next=v,u=u.next}while(u!==null);g===null?p=g=i:g=g.next=i}else p=g=i;u={baseState:d.baseState,firstBaseUpdate:p,lastBaseUpdate:g,shared:d.shared,effects:d.effects},n.updateQueue=u;return}n=u.lastBaseUpdate,n===null?u.firstBaseUpdate=i:n.next=i,u.lastBaseUpdate=i}function aa(n,i,u,d){var p=n.updateQueue;jn=!1;var g=p.firstBaseUpdate,v=p.lastBaseUpdate,k=p.shared.pending;if(k!==null){p.shared.pending=null;var x=k,L=x.next;x.next=null,v===null?g=L:v.next=L,v=x;var B=n.alternate;B!==null&&(B=B.updateQueue,k=B.lastBaseUpdate,k!==v&&(k===null?B.firstBaseUpdate=L:k.next=L,B.lastBaseUpdate=x))}if(g!==null){var H=p.baseState;v=0,B=L=x=null,k=g;do{var F=k.lane,Y=k.eventTime;if((d&F)===F){B!==null&&(B=B.next={eventTime:Y,lane:0,tag:k.tag,payload:k.payload,callback:k.callback,next:null});e:{var re=n,ie=k;switch(F=i,Y=u,ie.tag){case 1:if(re=ie.payload,typeof re=="function"){H=re.call(Y,H,F);break e}H=re;break e;case 3:re.flags=re.flags&-65537|128;case 0:if(re=ie.payload,F=typeof re=="function"?re.call(Y,H,F):re,F==null)break e;H=M({},H,F);break e;case 2:jn=!0}}k.callback!==null&&k.lane!==0&&(n.flags|=64,F=p.effects,F===null?p.effects=[k]:F.push(k))}else Y={eventTime:Y,lane:F,tag:k.tag,payload:k.payload,callback:k.callback,next:null},B===null?(L=B=Y,x=H):B=B.next=Y,v|=F;if(k=k.next,k===null){if(k=p.shared.pending,k===null)break;F=k,k=F.next,F.next=null,p.lastBaseUpdate=F,p.shared.pending=null}}while(!0);if(B===null&&(x=H),p.baseState=x,p.firstBaseUpdate=L,p.lastBaseUpdate=B,i=p.shared.interleaved,i!==null){p=i;do v|=p.lane,p=p.next;while(p!==i)}else g===null&&(p.shared.lanes=0);pr|=v,n.lanes=v,n.memoizedState=H}}function Xf(n,i,u){if(n=i.effects,i.effects=null,n!==null)for(i=0;i<n.length;i++){var d=n[i],p=d.callback;if(p!==null){if(d.callback=null,d=u,typeof p!="function")throw Error(t(191,p));p.call(d)}}}var Di={},un=An(Di),Mi=An(Di),Ui=An(Di);function fr(n){if(n===Di)throw Error(t(174));return n}function xu(n,i){switch(Pe(Ui,i),Pe(Mi,n),Pe(un,Di),n=i.nodeType,n){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:Ro(null,"");break;default:n=n===8?i.parentNode:i,i=n.namespaceURI||null,n=n.tagName,i=Ro(i,n)}je(un),Pe(un,i)}function qr(){je(un),je(Mi),je(Ui)}function eh(n){fr(Ui.current);var i=fr(un.current),u=Ro(i,n.type);i!==u&&(Pe(Mi,n),Pe(un,u))}function Ru(n){Mi.current===n&&(je(un),je(Mi))}var De=An(0);function oa(n){for(var i=n;i!==null;){if(i.tag===13){var u=i.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||u.data==="$?"||u.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Iu=[];function Cu(){for(var n=0;n<Iu.length;n++)Iu[n]._workInProgressVersionPrimary=null;Iu.length=0}var ua=$.ReactCurrentDispatcher,Nu=$.ReactCurrentBatchConfig,hr=0,Me=null,We=null,Ye=null,la=!1,zi=!1,Fi=0,ov=0;function ut(){throw Error(t(321))}function Au(n,i){if(i===null)return!1;for(var u=0;u<i.length&&u<n.length;u++)if(!Vt(n[u],i[u]))return!1;return!0}function Pu(n,i,u,d,p,g){if(hr=g,Me=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,ua.current=n===null||n.memoizedState===null?dv:fv,n=u(d,p),zi){g=0;do{if(zi=!1,Fi=0,25<=g)throw Error(t(301));g+=1,Ye=We=null,i.updateQueue=null,ua.current=hv,n=u(d,p)}while(zi)}if(ua.current=fa,i=We!==null&&We.next!==null,hr=0,Ye=We=Me=null,la=!1,i)throw Error(t(300));return n}function Lu(){var n=Fi!==0;return Fi=0,n}function ln(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ye===null?Me.memoizedState=Ye=n:Ye=Ye.next=n,Ye}function zt(){if(We===null){var n=Me.alternate;n=n!==null?n.memoizedState:null}else n=We.next;var i=Ye===null?Me.memoizedState:Ye.next;if(i!==null)Ye=i,We=n;else{if(n===null)throw Error(t(310));We=n,n={memoizedState:We.memoizedState,baseState:We.baseState,baseQueue:We.baseQueue,queue:We.queue,next:null},Ye===null?Me.memoizedState=Ye=n:Ye=Ye.next=n}return Ye}function Bi(n,i){return typeof i=="function"?i(n):i}function ju(n){var i=zt(),u=i.queue;if(u===null)throw Error(t(311));u.lastRenderedReducer=n;var d=We,p=d.baseQueue,g=u.pending;if(g!==null){if(p!==null){var v=p.next;p.next=g.next,g.next=v}d.baseQueue=p=g,u.pending=null}if(p!==null){g=p.next,d=d.baseState;var k=v=null,x=null,L=g;do{var B=L.lane;if((hr&B)===B)x!==null&&(x=x.next={lane:0,action:L.action,hasEagerState:L.hasEagerState,eagerState:L.eagerState,next:null}),d=L.hasEagerState?L.eagerState:n(d,L.action);else{var H={lane:B,action:L.action,hasEagerState:L.hasEagerState,eagerState:L.eagerState,next:null};x===null?(k=x=H,v=d):x=x.next=H,Me.lanes|=B,pr|=B}L=L.next}while(L!==null&&L!==g);x===null?v=d:x.next=k,Vt(d,i.memoizedState)||(wt=!0),i.memoizedState=d,i.baseState=v,i.baseQueue=x,u.lastRenderedState=d}if(n=u.interleaved,n!==null){p=n;do g=p.lane,Me.lanes|=g,pr|=g,p=p.next;while(p!==n)}else p===null&&(u.lanes=0);return[i.memoizedState,u.dispatch]}function $u(n){var i=zt(),u=i.queue;if(u===null)throw Error(t(311));u.lastRenderedReducer=n;var d=u.dispatch,p=u.pending,g=i.memoizedState;if(p!==null){u.pending=null;var v=p=p.next;do g=n(g,v.action),v=v.next;while(v!==p);Vt(g,i.memoizedState)||(wt=!0),i.memoizedState=g,i.baseQueue===null&&(i.baseState=g),u.lastRenderedState=g}return[g,d]}function th(){}function nh(n,i){var u=Me,d=zt(),p=i(),g=!Vt(d.memoizedState,p);if(g&&(d.memoizedState=p,wt=!0),d=d.queue,Du(sh.bind(null,u,d,n),[n]),d.getSnapshot!==i||g||Ye!==null&&Ye.memoizedState.tag&1){if(u.flags|=2048,Hi(9,ih.bind(null,u,d,p,i),void 0,null),Xe===null)throw Error(t(349));(hr&30)!==0||rh(u,i,p)}return p}function rh(n,i,u){n.flags|=16384,n={getSnapshot:i,value:u},i=Me.updateQueue,i===null?(i={lastEffect:null,stores:null},Me.updateQueue=i,i.stores=[n]):(u=i.stores,u===null?i.stores=[n]:u.push(n))}function ih(n,i,u,d){i.value=u,i.getSnapshot=d,ah(i)&&oh(n)}function sh(n,i,u){return u(function(){ah(i)&&oh(n)})}function ah(n){var i=n.getSnapshot;n=n.value;try{var u=i();return!Vt(n,u)}catch{return!0}}function oh(n){var i=_n(n,1);i!==null&&Qt(i,n,1,-1)}function uh(n){var i=ln();return typeof n=="function"&&(n=n()),i.memoizedState=i.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Bi,lastRenderedState:n},i.queue=n,n=n.dispatch=cv.bind(null,Me,n),[i.memoizedState,n]}function Hi(n,i,u,d){return n={tag:n,create:i,destroy:u,deps:d,next:null},i=Me.updateQueue,i===null?(i={lastEffect:null,stores:null},Me.updateQueue=i,i.lastEffect=n.next=n):(u=i.lastEffect,u===null?i.lastEffect=n.next=n:(d=u.next,u.next=n,n.next=d,i.lastEffect=n)),n}function lh(){return zt().memoizedState}function ca(n,i,u,d){var p=ln();Me.flags|=n,p.memoizedState=Hi(1|i,u,void 0,d===void 0?null:d)}function da(n,i,u,d){var p=zt();d=d===void 0?null:d;var g=void 0;if(We!==null){var v=We.memoizedState;if(g=v.destroy,d!==null&&Au(d,v.deps)){p.memoizedState=Hi(i,u,g,d);return}}Me.flags|=n,p.memoizedState=Hi(1|i,u,g,d)}function ch(n,i){return ca(8390656,8,n,i)}function Du(n,i){return da(2048,8,n,i)}function dh(n,i){return da(4,2,n,i)}function fh(n,i){return da(4,4,n,i)}function hh(n,i){if(typeof i=="function")return n=n(),i(n),function(){i(null)};if(i!=null)return n=n(),i.current=n,function(){i.current=null}}function ph(n,i,u){return u=u!=null?u.concat([n]):null,da(4,4,hh.bind(null,i,n),u)}function Mu(){}function mh(n,i){var u=zt();i=i===void 0?null:i;var d=u.memoizedState;return d!==null&&i!==null&&Au(i,d[1])?d[0]:(u.memoizedState=[n,i],n)}function gh(n,i){var u=zt();i=i===void 0?null:i;var d=u.memoizedState;return d!==null&&i!==null&&Au(i,d[1])?d[0]:(n=n(),u.memoizedState=[n,i],n)}function yh(n,i,u){return(hr&21)===0?(n.baseState&&(n.baseState=!1,wt=!0),n.memoizedState=u):(Vt(u,i)||(u=Vd(),Me.lanes|=u,pr|=u,n.baseState=!0),i)}function uv(n,i){var u=Re;Re=u!==0&&4>u?u:4,n(!0);var d=Nu.transition;Nu.transition={};try{n(!1),i()}finally{Re=u,Nu.transition=d}}function _h(){return zt().memoizedState}function lv(n,i,u){var d=zn(n);if(u={lane:d,action:u,hasEagerState:!1,eagerState:null,next:null},vh(n))wh(i,u);else if(u=Jf(n,i,u,d),u!==null){var p=ht();Qt(u,n,d,p),bh(u,i,d)}}function cv(n,i,u){var d=zn(n),p={lane:d,action:u,hasEagerState:!1,eagerState:null,next:null};if(vh(n))wh(i,p);else{var g=n.alternate;if(n.lanes===0&&(g===null||g.lanes===0)&&(g=i.lastRenderedReducer,g!==null))try{var v=i.lastRenderedState,k=g(v,u);if(p.hasEagerState=!0,p.eagerState=k,Vt(k,v)){var x=i.interleaved;x===null?(p.next=p,ku(i)):(p.next=x.next,x.next=p),i.interleaved=p;return}}catch{}finally{}u=Jf(n,i,p,d),u!==null&&(p=ht(),Qt(u,n,d,p),bh(u,i,d))}}function vh(n){var i=n.alternate;return n===Me||i!==null&&i===Me}function wh(n,i){zi=la=!0;var u=n.pending;u===null?i.next=i:(i.next=u.next,u.next=i),n.pending=i}function bh(n,i,u){if((u&4194240)!==0){var d=i.lanes;d&=n.pendingLanes,u|=d,i.lanes=u,zo(n,u)}}var fa={readContext:Ut,useCallback:ut,useContext:ut,useEffect:ut,useImperativeHandle:ut,useInsertionEffect:ut,useLayoutEffect:ut,useMemo:ut,useReducer:ut,useRef:ut,useState:ut,useDebugValue:ut,useDeferredValue:ut,useTransition:ut,useMutableSource:ut,useSyncExternalStore:ut,useId:ut,unstable_isNewReconciler:!1},dv={readContext:Ut,useCallback:function(n,i){return ln().memoizedState=[n,i===void 0?null:i],n},useContext:Ut,useEffect:ch,useImperativeHandle:function(n,i,u){return u=u!=null?u.concat([n]):null,ca(4194308,4,hh.bind(null,i,n),u)},useLayoutEffect:function(n,i){return ca(4194308,4,n,i)},useInsertionEffect:function(n,i){return ca(4,2,n,i)},useMemo:function(n,i){var u=ln();return i=i===void 0?null:i,n=n(),u.memoizedState=[n,i],n},useReducer:function(n,i,u){var d=ln();return i=u!==void 0?u(i):i,d.memoizedState=d.baseState=i,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:i},d.queue=n,n=n.dispatch=lv.bind(null,Me,n),[d.memoizedState,n]},useRef:function(n){var i=ln();return n={current:n},i.memoizedState=n},useState:uh,useDebugValue:Mu,useDeferredValue:function(n){return ln().memoizedState=n},useTransition:function(){var n=uh(!1),i=n[0];return n=uv.bind(null,n[1]),ln().memoizedState=n,[i,n]},useMutableSource:function(){},useSyncExternalStore:function(n,i,u){var d=Me,p=ln();if($e){if(u===void 0)throw Error(t(407));u=u()}else{if(u=i(),Xe===null)throw Error(t(349));(hr&30)!==0||rh(d,i,u)}p.memoizedState=u;var g={value:u,getSnapshot:i};return p.queue=g,ch(sh.bind(null,d,g,n),[n]),d.flags|=2048,Hi(9,ih.bind(null,d,g,u,i),void 0,null),u},useId:function(){var n=ln(),i=Xe.identifierPrefix;if($e){var u=yn,d=gn;u=(d&~(1<<32-qt(d)-1)).toString(32)+u,i=":"+i+"R"+u,u=Fi++,0<u&&(i+="H"+u.toString(32)),i+=":"}else u=ov++,i=":"+i+"r"+u.toString(32)+":";return n.memoizedState=i},unstable_isNewReconciler:!1},fv={readContext:Ut,useCallback:mh,useContext:Ut,useEffect:Du,useImperativeHandle:ph,useInsertionEffect:dh,useLayoutEffect:fh,useMemo:gh,useReducer:ju,useRef:lh,useState:function(){return ju(Bi)},useDebugValue:Mu,useDeferredValue:function(n){var i=zt();return yh(i,We.memoizedState,n)},useTransition:function(){var n=ju(Bi)[0],i=zt().memoizedState;return[n,i]},useMutableSource:th,useSyncExternalStore:nh,useId:_h,unstable_isNewReconciler:!1},hv={readContext:Ut,useCallback:mh,useContext:Ut,useEffect:Du,useImperativeHandle:ph,useInsertionEffect:dh,useLayoutEffect:fh,useMemo:gh,useReducer:$u,useRef:lh,useState:function(){return $u(Bi)},useDebugValue:Mu,useDeferredValue:function(n){var i=zt();return We===null?i.memoizedState=n:yh(i,We.memoizedState,n)},useTransition:function(){var n=$u(Bi)[0],i=zt().memoizedState;return[n,i]},useMutableSource:th,useSyncExternalStore:nh,useId:_h,unstable_isNewReconciler:!1};function Wt(n,i){if(n&&n.defaultProps){i=M({},i),n=n.defaultProps;for(var u in n)i[u]===void 0&&(i[u]=n[u]);return i}return i}function Uu(n,i,u,d){i=n.memoizedState,u=u(d,i),u=u==null?i:M({},i,u),n.memoizedState=u,n.lanes===0&&(n.updateQueue.baseState=u)}var ha={isMounted:function(n){return(n=n._reactInternals)?ar(n)===n:!1},enqueueSetState:function(n,i,u){n=n._reactInternals;var d=ht(),p=zn(n),g=vn(d,p);g.payload=i,u!=null&&(g.callback=u),i=$n(n,g,p),i!==null&&(Qt(i,n,p,d),sa(i,n,p))},enqueueReplaceState:function(n,i,u){n=n._reactInternals;var d=ht(),p=zn(n),g=vn(d,p);g.tag=1,g.payload=i,u!=null&&(g.callback=u),i=$n(n,g,p),i!==null&&(Qt(i,n,p,d),sa(i,n,p))},enqueueForceUpdate:function(n,i){n=n._reactInternals;var u=ht(),d=zn(n),p=vn(u,d);p.tag=2,i!=null&&(p.callback=i),i=$n(n,p,d),i!==null&&(Qt(i,n,d,u),sa(i,n,d))}};function Eh(n,i,u,d,p,g,v){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(d,g,v):i.prototype&&i.prototype.isPureReactComponent?!Ii(u,d)||!Ii(p,g):!0}function Sh(n,i,u){var d=!1,p=Pn,g=i.contextType;return typeof g=="object"&&g!==null?g=Ut(g):(p=vt(i)?ur:ot.current,d=i.contextTypes,g=(d=d!=null)?Mr(n,p):Pn),i=new i(u,g),n.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=ha,n.stateNode=i,i._reactInternals=n,d&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=p,n.__reactInternalMemoizedMaskedChildContext=g),i}function Oh(n,i,u,d){n=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(u,d),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(u,d),i.state!==n&&ha.enqueueReplaceState(i,i.state,null)}function zu(n,i,u,d){var p=n.stateNode;p.props=u,p.state=n.memoizedState,p.refs={},Tu(n);var g=i.contextType;typeof g=="object"&&g!==null?p.context=Ut(g):(g=vt(i)?ur:ot.current,p.context=Mr(n,g)),p.state=n.memoizedState,g=i.getDerivedStateFromProps,typeof g=="function"&&(Uu(n,i,g,u),p.state=n.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(i=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),i!==p.state&&ha.enqueueReplaceState(p,p.state,null),aa(n,u,p,d),p.state=n.memoizedState),typeof p.componentDidMount=="function"&&(n.flags|=4194308)}function Vr(n,i){try{var u="",d=i;do u+=ce(d),d=d.return;while(d);var p=u}catch(g){p=`
Error generating stack: `+g.message+`
`+g.stack}return{value:n,source:i,stack:p,digest:null}}function Fu(n,i,u){return{value:n,source:null,stack:u??null,digest:i??null}}function Bu(n,i){try{console.error(i.value)}catch(u){setTimeout(function(){throw u})}}var pv=typeof WeakMap=="function"?WeakMap:Map;function kh(n,i,u){u=vn(-1,u),u.tag=3,u.payload={element:null};var d=i.value;return u.callback=function(){wa||(wa=!0,rl=d),Bu(n,i)},u}function Th(n,i,u){u=vn(-1,u),u.tag=3;var d=n.type.getDerivedStateFromError;if(typeof d=="function"){var p=i.value;u.payload=function(){return d(p)},u.callback=function(){Bu(n,i)}}var g=n.stateNode;return g!==null&&typeof g.componentDidCatch=="function"&&(u.callback=function(){Bu(n,i),typeof d!="function"&&(Mn===null?Mn=new Set([this]):Mn.add(this));var v=i.stack;this.componentDidCatch(i.value,{componentStack:v!==null?v:""})}),u}function xh(n,i,u){var d=n.pingCache;if(d===null){d=n.pingCache=new pv;var p=new Set;d.set(i,p)}else p=d.get(i),p===void 0&&(p=new Set,d.set(i,p));p.has(u)||(p.add(u),n=Rv.bind(null,n,i,u),i.then(n,n))}function Rh(n){do{var i;if((i=n.tag===13)&&(i=n.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return n;n=n.return}while(n!==null);return null}function Ih(n,i,u,d,p){return(n.mode&1)===0?(n===i?n.flags|=65536:(n.flags|=128,u.flags|=131072,u.flags&=-52805,u.tag===1&&(u.alternate===null?u.tag=17:(i=vn(-1,1),i.tag=2,$n(u,i,1))),u.lanes|=1),n):(n.flags|=65536,n.lanes=p,n)}var mv=$.ReactCurrentOwner,wt=!1;function ft(n,i,u,d){i.child=n===null?Kf(i,null,u,d):Br(i,n.child,u,d)}function Ch(n,i,u,d,p){u=u.render;var g=i.ref;return Gr(i,p),d=Pu(n,i,u,d,g,p),u=Lu(),n!==null&&!wt?(i.updateQueue=n.updateQueue,i.flags&=-2053,n.lanes&=~p,wn(n,i,p)):($e&&u&&gu(i),i.flags|=1,ft(n,i,d,p),i.child)}function Nh(n,i,u,d,p){if(n===null){var g=u.type;return typeof g=="function"&&!cl(g)&&g.defaultProps===void 0&&u.compare===null&&u.defaultProps===void 0?(i.tag=15,i.type=g,Ah(n,i,g,d,p)):(n=Ta(u.type,null,d,i,i.mode,p),n.ref=i.ref,n.return=i,i.child=n)}if(g=n.child,(n.lanes&p)===0){var v=g.memoizedProps;if(u=u.compare,u=u!==null?u:Ii,u(v,d)&&n.ref===i.ref)return wn(n,i,p)}return i.flags|=1,n=Bn(g,d),n.ref=i.ref,n.return=i,i.child=n}function Ah(n,i,u,d,p){if(n!==null){var g=n.memoizedProps;if(Ii(g,d)&&n.ref===i.ref)if(wt=!1,i.pendingProps=d=g,(n.lanes&p)!==0)(n.flags&131072)!==0&&(wt=!0);else return i.lanes=n.lanes,wn(n,i,p)}return Hu(n,i,u,d,p)}function Ph(n,i,u){var d=i.pendingProps,p=d.children,g=n!==null?n.memoizedState:null;if(d.mode==="hidden")if((i.mode&1)===0)i.memoizedState={baseLanes:0,cachePool:null,transitions:null},Pe(Wr,At),At|=u;else{if((u&1073741824)===0)return n=g!==null?g.baseLanes|u:u,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:n,cachePool:null,transitions:null},i.updateQueue=null,Pe(Wr,At),At|=n,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},d=g!==null?g.baseLanes:u,Pe(Wr,At),At|=d}else g!==null?(d=g.baseLanes|u,i.memoizedState=null):d=u,Pe(Wr,At),At|=d;return ft(n,i,p,u),i.child}function Lh(n,i){var u=i.ref;(n===null&&u!==null||n!==null&&n.ref!==u)&&(i.flags|=512,i.flags|=2097152)}function Hu(n,i,u,d,p){var g=vt(u)?ur:ot.current;return g=Mr(i,g),Gr(i,p),u=Pu(n,i,u,d,g,p),d=Lu(),n!==null&&!wt?(i.updateQueue=n.updateQueue,i.flags&=-2053,n.lanes&=~p,wn(n,i,p)):($e&&d&&gu(i),i.flags|=1,ft(n,i,u,p),i.child)}function jh(n,i,u,d,p){if(vt(u)){var g=!0;Qs(i)}else g=!1;if(Gr(i,p),i.stateNode===null)ma(n,i),Sh(i,u,d),zu(i,u,d,p),d=!0;else if(n===null){var v=i.stateNode,k=i.memoizedProps;v.props=k;var x=v.context,L=u.contextType;typeof L=="object"&&L!==null?L=Ut(L):(L=vt(u)?ur:ot.current,L=Mr(i,L));var B=u.getDerivedStateFromProps,H=typeof B=="function"||typeof v.getSnapshotBeforeUpdate=="function";H||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(k!==d||x!==L)&&Oh(i,v,d,L),jn=!1;var F=i.memoizedState;v.state=F,aa(i,d,v,p),x=i.memoizedState,k!==d||F!==x||_t.current||jn?(typeof B=="function"&&(Uu(i,u,B,d),x=i.memoizedState),(k=jn||Eh(i,u,k,d,F,x,L))?(H||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(i.flags|=4194308)):(typeof v.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=d,i.memoizedState=x),v.props=d,v.state=x,v.context=L,d=k):(typeof v.componentDidMount=="function"&&(i.flags|=4194308),d=!1)}else{v=i.stateNode,Qf(n,i),k=i.memoizedProps,L=i.type===i.elementType?k:Wt(i.type,k),v.props=L,H=i.pendingProps,F=v.context,x=u.contextType,typeof x=="object"&&x!==null?x=Ut(x):(x=vt(u)?ur:ot.current,x=Mr(i,x));var Y=u.getDerivedStateFromProps;(B=typeof Y=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(k!==H||F!==x)&&Oh(i,v,d,x),jn=!1,F=i.memoizedState,v.state=F,aa(i,d,v,p);var re=i.memoizedState;k!==H||F!==re||_t.current||jn?(typeof Y=="function"&&(Uu(i,u,Y,d),re=i.memoizedState),(L=jn||Eh(i,u,L,d,F,re,x)||!1)?(B||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(d,re,x),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(d,re,x)),typeof v.componentDidUpdate=="function"&&(i.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof v.componentDidUpdate!="function"||k===n.memoizedProps&&F===n.memoizedState||(i.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||k===n.memoizedProps&&F===n.memoizedState||(i.flags|=1024),i.memoizedProps=d,i.memoizedState=re),v.props=d,v.state=re,v.context=x,d=L):(typeof v.componentDidUpdate!="function"||k===n.memoizedProps&&F===n.memoizedState||(i.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||k===n.memoizedProps&&F===n.memoizedState||(i.flags|=1024),d=!1)}return Gu(n,i,u,d,g,p)}function Gu(n,i,u,d,p,g){Lh(n,i);var v=(i.flags&128)!==0;if(!d&&!v)return p&&zf(i,u,!1),wn(n,i,g);d=i.stateNode,mv.current=i;var k=v&&typeof u.getDerivedStateFromError!="function"?null:d.render();return i.flags|=1,n!==null&&v?(i.child=Br(i,n.child,null,g),i.child=Br(i,null,k,g)):ft(n,i,k,g),i.memoizedState=d.state,p&&zf(i,u,!0),i.child}function $h(n){var i=n.stateNode;i.pendingContext?Mf(n,i.pendingContext,i.pendingContext!==i.context):i.context&&Mf(n,i.context,!1),xu(n,i.containerInfo)}function Dh(n,i,u,d,p){return Fr(),wu(p),i.flags|=256,ft(n,i,u,d),i.child}var qu={dehydrated:null,treeContext:null,retryLane:0};function Vu(n){return{baseLanes:n,cachePool:null,transitions:null}}function Mh(n,i,u){var d=i.pendingProps,p=De.current,g=!1,v=(i.flags&128)!==0,k;if((k=v)||(k=n!==null&&n.memoizedState===null?!1:(p&2)!==0),k?(g=!0,i.flags&=-129):(n===null||n.memoizedState!==null)&&(p|=1),Pe(De,p&1),n===null)return vu(i),n=i.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?((i.mode&1)===0?i.lanes=1:n.data==="$!"?i.lanes=8:i.lanes=1073741824,null):(v=d.children,n=d.fallback,g?(d=i.mode,g=i.child,v={mode:"hidden",children:v},(d&1)===0&&g!==null?(g.childLanes=0,g.pendingProps=v):g=xa(v,d,0,null),n=_r(n,d,u,null),g.return=i,n.return=i,g.sibling=n,i.child=g,i.child.memoizedState=Vu(u),i.memoizedState=qu,n):Zu(i,v));if(p=n.memoizedState,p!==null&&(k=p.dehydrated,k!==null))return gv(n,i,v,d,k,p,u);if(g){g=d.fallback,v=i.mode,p=n.child,k=p.sibling;var x={mode:"hidden",children:d.children};return(v&1)===0&&i.child!==p?(d=i.child,d.childLanes=0,d.pendingProps=x,i.deletions=null):(d=Bn(p,x),d.subtreeFlags=p.subtreeFlags&14680064),k!==null?g=Bn(k,g):(g=_r(g,v,u,null),g.flags|=2),g.return=i,d.return=i,d.sibling=g,i.child=d,d=g,g=i.child,v=n.child.memoizedState,v=v===null?Vu(u):{baseLanes:v.baseLanes|u,cachePool:null,transitions:v.transitions},g.memoizedState=v,g.childLanes=n.childLanes&~u,i.memoizedState=qu,d}return g=n.child,n=g.sibling,d=Bn(g,{mode:"visible",children:d.children}),(i.mode&1)===0&&(d.lanes=u),d.return=i,d.sibling=null,n!==null&&(u=i.deletions,u===null?(i.deletions=[n],i.flags|=16):u.push(n)),i.child=d,i.memoizedState=null,d}function Zu(n,i){return i=xa({mode:"visible",children:i},n.mode,0,null),i.return=n,n.child=i}function pa(n,i,u,d){return d!==null&&wu(d),Br(i,n.child,null,u),n=Zu(i,i.pendingProps.children),n.flags|=2,i.memoizedState=null,n}function gv(n,i,u,d,p,g,v){if(u)return i.flags&256?(i.flags&=-257,d=Fu(Error(t(422))),pa(n,i,v,d)):i.memoizedState!==null?(i.child=n.child,i.flags|=128,null):(g=d.fallback,p=i.mode,d=xa({mode:"visible",children:d.children},p,0,null),g=_r(g,p,v,null),g.flags|=2,d.return=i,g.return=i,d.sibling=g,i.child=d,(i.mode&1)!==0&&Br(i,n.child,null,v),i.child.memoizedState=Vu(v),i.memoizedState=qu,g);if((i.mode&1)===0)return pa(n,i,v,null);if(p.data==="$!"){if(d=p.nextSibling&&p.nextSibling.dataset,d)var k=d.dgst;return d=k,g=Error(t(419)),d=Fu(g,d,void 0),pa(n,i,v,d)}if(k=(v&n.childLanes)!==0,wt||k){if(d=Xe,d!==null){switch(v&-v){case 4:p=2;break;case 16:p=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:p=32;break;case 536870912:p=268435456;break;default:p=0}p=(p&(d.suspendedLanes|v))!==0?0:p,p!==0&&p!==g.retryLane&&(g.retryLane=p,_n(n,p),Qt(d,n,p,-1))}return ll(),d=Fu(Error(t(421))),pa(n,i,v,d)}return p.data==="$?"?(i.flags|=128,i.child=n.child,i=Iv.bind(null,n),p._reactRetry=i,null):(n=g.treeContext,Nt=Nn(p.nextSibling),Ct=i,$e=!0,Zt=null,n!==null&&(Dt[Mt++]=gn,Dt[Mt++]=yn,Dt[Mt++]=lr,gn=n.id,yn=n.overflow,lr=i),i=Zu(i,d.children),i.flags|=4096,i)}function Uh(n,i,u){n.lanes|=i;var d=n.alternate;d!==null&&(d.lanes|=i),Ou(n.return,i,u)}function Wu(n,i,u,d,p){var g=n.memoizedState;g===null?n.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:d,tail:u,tailMode:p}:(g.isBackwards=i,g.rendering=null,g.renderingStartTime=0,g.last=d,g.tail=u,g.tailMode=p)}function zh(n,i,u){var d=i.pendingProps,p=d.revealOrder,g=d.tail;if(ft(n,i,d.children,u),d=De.current,(d&2)!==0)d=d&1|2,i.flags|=128;else{if(n!==null&&(n.flags&128)!==0)e:for(n=i.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&Uh(n,u,i);else if(n.tag===19)Uh(n,u,i);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===i)break e;for(;n.sibling===null;){if(n.return===null||n.return===i)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}d&=1}if(Pe(De,d),(i.mode&1)===0)i.memoizedState=null;else switch(p){case"forwards":for(u=i.child,p=null;u!==null;)n=u.alternate,n!==null&&oa(n)===null&&(p=u),u=u.sibling;u=p,u===null?(p=i.child,i.child=null):(p=u.sibling,u.sibling=null),Wu(i,!1,p,u,g);break;case"backwards":for(u=null,p=i.child,i.child=null;p!==null;){if(n=p.alternate,n!==null&&oa(n)===null){i.child=p;break}n=p.sibling,p.sibling=u,u=p,p=n}Wu(i,!0,u,null,g);break;case"together":Wu(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function ma(n,i){(i.mode&1)===0&&n!==null&&(n.alternate=null,i.alternate=null,i.flags|=2)}function wn(n,i,u){if(n!==null&&(i.dependencies=n.dependencies),pr|=i.lanes,(u&i.childLanes)===0)return null;if(n!==null&&i.child!==n.child)throw Error(t(153));if(i.child!==null){for(n=i.child,u=Bn(n,n.pendingProps),i.child=u,u.return=i;n.sibling!==null;)n=n.sibling,u=u.sibling=Bn(n,n.pendingProps),u.return=i;u.sibling=null}return i.child}function yv(n,i,u){switch(i.tag){case 3:$h(i),Fr();break;case 5:eh(i);break;case 1:vt(i.type)&&Qs(i);break;case 4:xu(i,i.stateNode.containerInfo);break;case 10:var d=i.type._context,p=i.memoizedProps.value;Pe(ra,d._currentValue),d._currentValue=p;break;case 13:if(d=i.memoizedState,d!==null)return d.dehydrated!==null?(Pe(De,De.current&1),i.flags|=128,null):(u&i.child.childLanes)!==0?Mh(n,i,u):(Pe(De,De.current&1),n=wn(n,i,u),n!==null?n.sibling:null);Pe(De,De.current&1);break;case 19:if(d=(u&i.childLanes)!==0,(n.flags&128)!==0){if(d)return zh(n,i,u);i.flags|=128}if(p=i.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),Pe(De,De.current),d)break;return null;case 22:case 23:return i.lanes=0,Ph(n,i,u)}return wn(n,i,u)}var Fh,Ku,Bh,Hh;Fh=function(n,i){for(var u=i.child;u!==null;){if(u.tag===5||u.tag===6)n.appendChild(u.stateNode);else if(u.tag!==4&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===i)break;for(;u.sibling===null;){if(u.return===null||u.return===i)return;u=u.return}u.sibling.return=u.return,u=u.sibling}},Ku=function(){},Bh=function(n,i,u,d){var p=n.memoizedProps;if(p!==d){n=i.stateNode,fr(un.current);var g=null;switch(u){case"input":p=Oo(n,p),d=Oo(n,d),g=[];break;case"select":p=M({},p,{value:void 0}),d=M({},d,{value:void 0}),g=[];break;case"textarea":p=xo(n,p),d=xo(n,d),g=[];break;default:typeof p.onClick!="function"&&typeof d.onClick=="function"&&(n.onclick=Ws)}Io(u,d);var v;u=null;for(L in p)if(!d.hasOwnProperty(L)&&p.hasOwnProperty(L)&&p[L]!=null)if(L==="style"){var k=p[L];for(v in k)k.hasOwnProperty(v)&&(u||(u={}),u[v]="")}else L!=="dangerouslySetInnerHTML"&&L!=="children"&&L!=="suppressContentEditableWarning"&&L!=="suppressHydrationWarning"&&L!=="autoFocus"&&(a.hasOwnProperty(L)?g||(g=[]):(g=g||[]).push(L,null));for(L in d){var x=d[L];if(k=p!=null?p[L]:void 0,d.hasOwnProperty(L)&&x!==k&&(x!=null||k!=null))if(L==="style")if(k){for(v in k)!k.hasOwnProperty(v)||x&&x.hasOwnProperty(v)||(u||(u={}),u[v]="");for(v in x)x.hasOwnProperty(v)&&k[v]!==x[v]&&(u||(u={}),u[v]=x[v])}else u||(g||(g=[]),g.push(L,u)),u=x;else L==="dangerouslySetInnerHTML"?(x=x?x.__html:void 0,k=k?k.__html:void 0,x!=null&&k!==x&&(g=g||[]).push(L,x)):L==="children"?typeof x!="string"&&typeof x!="number"||(g=g||[]).push(L,""+x):L!=="suppressContentEditableWarning"&&L!=="suppressHydrationWarning"&&(a.hasOwnProperty(L)?(x!=null&&L==="onScroll"&&Le("scroll",n),g||k===x||(g=[])):(g=g||[]).push(L,x))}u&&(g=g||[]).push("style",u);var L=g;(i.updateQueue=L)&&(i.flags|=4)}},Hh=function(n,i,u,d){u!==d&&(i.flags|=4)};function Gi(n,i){if(!$e)switch(n.tailMode){case"hidden":i=n.tail;for(var u=null;i!==null;)i.alternate!==null&&(u=i),i=i.sibling;u===null?n.tail=null:u.sibling=null;break;case"collapsed":u=n.tail;for(var d=null;u!==null;)u.alternate!==null&&(d=u),u=u.sibling;d===null?i||n.tail===null?n.tail=null:n.tail.sibling=null:d.sibling=null}}function lt(n){var i=n.alternate!==null&&n.alternate.child===n.child,u=0,d=0;if(i)for(var p=n.child;p!==null;)u|=p.lanes|p.childLanes,d|=p.subtreeFlags&14680064,d|=p.flags&14680064,p.return=n,p=p.sibling;else for(p=n.child;p!==null;)u|=p.lanes|p.childLanes,d|=p.subtreeFlags,d|=p.flags,p.return=n,p=p.sibling;return n.subtreeFlags|=d,n.childLanes=u,i}function _v(n,i,u){var d=i.pendingProps;switch(yu(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return lt(i),null;case 1:return vt(i.type)&&Js(),lt(i),null;case 3:return d=i.stateNode,qr(),je(_t),je(ot),Cu(),d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null),(n===null||n.child===null)&&(ta(i)?i.flags|=4:n===null||n.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Zt!==null&&(al(Zt),Zt=null))),Ku(n,i),lt(i),null;case 5:Ru(i);var p=fr(Ui.current);if(u=i.type,n!==null&&i.stateNode!=null)Bh(n,i,u,d,p),n.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!d){if(i.stateNode===null)throw Error(t(166));return lt(i),null}if(n=fr(un.current),ta(i)){d=i.stateNode,u=i.type;var g=i.memoizedProps;switch(d[on]=i,d[Li]=g,n=(i.mode&1)!==0,u){case"dialog":Le("cancel",d),Le("close",d);break;case"iframe":case"object":case"embed":Le("load",d);break;case"video":case"audio":for(p=0;p<Ni.length;p++)Le(Ni[p],d);break;case"source":Le("error",d);break;case"img":case"image":case"link":Le("error",d),Le("load",d);break;case"details":Le("toggle",d);break;case"input":Ed(d,g),Le("invalid",d);break;case"select":d._wrapperState={wasMultiple:!!g.multiple},Le("invalid",d);break;case"textarea":kd(d,g),Le("invalid",d)}Io(u,g),p=null;for(var v in g)if(g.hasOwnProperty(v)){var k=g[v];v==="children"?typeof k=="string"?d.textContent!==k&&(g.suppressHydrationWarning!==!0&&Zs(d.textContent,k,n),p=["children",k]):typeof k=="number"&&d.textContent!==""+k&&(g.suppressHydrationWarning!==!0&&Zs(d.textContent,k,n),p=["children",""+k]):a.hasOwnProperty(v)&&k!=null&&v==="onScroll"&&Le("scroll",d)}switch(u){case"input":kr(d),Od(d,g,!0);break;case"textarea":kr(d),xd(d);break;case"select":case"option":break;default:typeof g.onClick=="function"&&(d.onclick=Ws)}d=p,i.updateQueue=d,d!==null&&(i.flags|=4)}else{v=p.nodeType===9?p:p.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=Rd(u)),n==="http://www.w3.org/1999/xhtml"?u==="script"?(n=v.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof d.is=="string"?n=v.createElement(u,{is:d.is}):(n=v.createElement(u),u==="select"&&(v=n,d.multiple?v.multiple=!0:d.size&&(v.size=d.size))):n=v.createElementNS(n,u),n[on]=i,n[Li]=d,Fh(n,i,!1,!1),i.stateNode=n;e:{switch(v=Co(u,d),u){case"dialog":Le("cancel",n),Le("close",n),p=d;break;case"iframe":case"object":case"embed":Le("load",n),p=d;break;case"video":case"audio":for(p=0;p<Ni.length;p++)Le(Ni[p],n);p=d;break;case"source":Le("error",n),p=d;break;case"img":case"image":case"link":Le("error",n),Le("load",n),p=d;break;case"details":Le("toggle",n),p=d;break;case"input":Ed(n,d),p=Oo(n,d),Le("invalid",n);break;case"option":p=d;break;case"select":n._wrapperState={wasMultiple:!!d.multiple},p=M({},d,{value:void 0}),Le("invalid",n);break;case"textarea":kd(n,d),p=xo(n,d),Le("invalid",n);break;default:p=d}Io(u,p),k=p;for(g in k)if(k.hasOwnProperty(g)){var x=k[g];g==="style"?Nd(n,x):g==="dangerouslySetInnerHTML"?(x=x?x.__html:void 0,x!=null&&Id(n,x)):g==="children"?typeof x=="string"?(u!=="textarea"||x!=="")&&fi(n,x):typeof x=="number"&&fi(n,""+x):g!=="suppressContentEditableWarning"&&g!=="suppressHydrationWarning"&&g!=="autoFocus"&&(a.hasOwnProperty(g)?x!=null&&g==="onScroll"&&Le("scroll",n):x!=null&&T(n,g,x,v))}switch(u){case"input":kr(n),Od(n,d,!1);break;case"textarea":kr(n),xd(n);break;case"option":d.value!=null&&n.setAttribute("value",""+Se(d.value));break;case"select":n.multiple=!!d.multiple,g=d.value,g!=null?Tr(n,!!d.multiple,g,!1):d.defaultValue!=null&&Tr(n,!!d.multiple,d.defaultValue,!0);break;default:typeof p.onClick=="function"&&(n.onclick=Ws)}switch(u){case"button":case"input":case"select":case"textarea":d=!!d.autoFocus;break e;case"img":d=!0;break e;default:d=!1}}d&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return lt(i),null;case 6:if(n&&i.stateNode!=null)Hh(n,i,n.memoizedProps,d);else{if(typeof d!="string"&&i.stateNode===null)throw Error(t(166));if(u=fr(Ui.current),fr(un.current),ta(i)){if(d=i.stateNode,u=i.memoizedProps,d[on]=i,(g=d.nodeValue!==u)&&(n=Ct,n!==null))switch(n.tag){case 3:Zs(d.nodeValue,u,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Zs(d.nodeValue,u,(n.mode&1)!==0)}g&&(i.flags|=4)}else d=(u.nodeType===9?u:u.ownerDocument).createTextNode(d),d[on]=i,i.stateNode=d}return lt(i),null;case 13:if(je(De),d=i.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if($e&&Nt!==null&&(i.mode&1)!==0&&(i.flags&128)===0)Vf(),Fr(),i.flags|=98560,g=!1;else if(g=ta(i),d!==null&&d.dehydrated!==null){if(n===null){if(!g)throw Error(t(318));if(g=i.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(t(317));g[on]=i}else Fr(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;lt(i),g=!1}else Zt!==null&&(al(Zt),Zt=null),g=!0;if(!g)return i.flags&65536?i:null}return(i.flags&128)!==0?(i.lanes=u,i):(d=d!==null,d!==(n!==null&&n.memoizedState!==null)&&d&&(i.child.flags|=8192,(i.mode&1)!==0&&(n===null||(De.current&1)!==0?Ke===0&&(Ke=3):ll())),i.updateQueue!==null&&(i.flags|=4),lt(i),null);case 4:return qr(),Ku(n,i),n===null&&Ai(i.stateNode.containerInfo),lt(i),null;case 10:return Su(i.type._context),lt(i),null;case 17:return vt(i.type)&&Js(),lt(i),null;case 19:if(je(De),g=i.memoizedState,g===null)return lt(i),null;if(d=(i.flags&128)!==0,v=g.rendering,v===null)if(d)Gi(g,!1);else{if(Ke!==0||n!==null&&(n.flags&128)!==0)for(n=i.child;n!==null;){if(v=oa(n),v!==null){for(i.flags|=128,Gi(g,!1),d=v.updateQueue,d!==null&&(i.updateQueue=d,i.flags|=4),i.subtreeFlags=0,d=u,u=i.child;u!==null;)g=u,n=d,g.flags&=14680066,v=g.alternate,v===null?(g.childLanes=0,g.lanes=n,g.child=null,g.subtreeFlags=0,g.memoizedProps=null,g.memoizedState=null,g.updateQueue=null,g.dependencies=null,g.stateNode=null):(g.childLanes=v.childLanes,g.lanes=v.lanes,g.child=v.child,g.subtreeFlags=0,g.deletions=null,g.memoizedProps=v.memoizedProps,g.memoizedState=v.memoizedState,g.updateQueue=v.updateQueue,g.type=v.type,n=v.dependencies,g.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),u=u.sibling;return Pe(De,De.current&1|2),i.child}n=n.sibling}g.tail!==null&&Fe()>Kr&&(i.flags|=128,d=!0,Gi(g,!1),i.lanes=4194304)}else{if(!d)if(n=oa(v),n!==null){if(i.flags|=128,d=!0,u=n.updateQueue,u!==null&&(i.updateQueue=u,i.flags|=4),Gi(g,!0),g.tail===null&&g.tailMode==="hidden"&&!v.alternate&&!$e)return lt(i),null}else 2*Fe()-g.renderingStartTime>Kr&&u!==1073741824&&(i.flags|=128,d=!0,Gi(g,!1),i.lanes=4194304);g.isBackwards?(v.sibling=i.child,i.child=v):(u=g.last,u!==null?u.sibling=v:i.child=v,g.last=v)}return g.tail!==null?(i=g.tail,g.rendering=i,g.tail=i.sibling,g.renderingStartTime=Fe(),i.sibling=null,u=De.current,Pe(De,d?u&1|2:u&1),i):(lt(i),null);case 22:case 23:return ul(),d=i.memoizedState!==null,n!==null&&n.memoizedState!==null!==d&&(i.flags|=8192),d&&(i.mode&1)!==0?(At&1073741824)!==0&&(lt(i),i.subtreeFlags&6&&(i.flags|=8192)):lt(i),null;case 24:return null;case 25:return null}throw Error(t(156,i.tag))}function vv(n,i){switch(yu(i),i.tag){case 1:return vt(i.type)&&Js(),n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 3:return qr(),je(_t),je(ot),Cu(),n=i.flags,(n&65536)!==0&&(n&128)===0?(i.flags=n&-65537|128,i):null;case 5:return Ru(i),null;case 13:if(je(De),n=i.memoizedState,n!==null&&n.dehydrated!==null){if(i.alternate===null)throw Error(t(340));Fr()}return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 19:return je(De),null;case 4:return qr(),null;case 10:return Su(i.type._context),null;case 22:case 23:return ul(),null;case 24:return null;default:return null}}var ga=!1,ct=!1,wv=typeof WeakSet=="function"?WeakSet:Set,ne=null;function Zr(n,i){var u=n.ref;if(u!==null)if(typeof u=="function")try{u(null)}catch(d){ze(n,i,d)}else u.current=null}function Ju(n,i,u){try{u()}catch(d){ze(n,i,d)}}var Gh=!1;function bv(n,i){if(uu=$s,n=Ef(),eu(n)){if("selectionStart"in n)var u={start:n.selectionStart,end:n.selectionEnd};else e:{u=(u=n.ownerDocument)&&u.defaultView||window;var d=u.getSelection&&u.getSelection();if(d&&d.rangeCount!==0){u=d.anchorNode;var p=d.anchorOffset,g=d.focusNode;d=d.focusOffset;try{u.nodeType,g.nodeType}catch{u=null;break e}var v=0,k=-1,x=-1,L=0,B=0,H=n,F=null;t:for(;;){for(var Y;H!==u||p!==0&&H.nodeType!==3||(k=v+p),H!==g||d!==0&&H.nodeType!==3||(x=v+d),H.nodeType===3&&(v+=H.nodeValue.length),(Y=H.firstChild)!==null;)F=H,H=Y;for(;;){if(H===n)break t;if(F===u&&++L===p&&(k=v),F===g&&++B===d&&(x=v),(Y=H.nextSibling)!==null)break;H=F,F=H.parentNode}H=Y}u=k===-1||x===-1?null:{start:k,end:x}}else u=null}u=u||{start:0,end:0}}else u=null;for(lu={focusedElem:n,selectionRange:u},$s=!1,ne=i;ne!==null;)if(i=ne,n=i.child,(i.subtreeFlags&1028)!==0&&n!==null)n.return=i,ne=n;else for(;ne!==null;){i=ne;try{var re=i.alternate;if((i.flags&1024)!==0)switch(i.tag){case 0:case 11:case 15:break;case 1:if(re!==null){var ie=re.memoizedProps,Be=re.memoizedState,N=i.stateNode,C=N.getSnapshotBeforeUpdate(i.elementType===i.type?ie:Wt(i.type,ie),Be);N.__reactInternalSnapshotBeforeUpdate=C}break;case 3:var A=i.stateNode.containerInfo;A.nodeType===1?A.textContent="":A.nodeType===9&&A.documentElement&&A.removeChild(A.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(q){ze(i,i.return,q)}if(n=i.sibling,n!==null){n.return=i.return,ne=n;break}ne=i.return}return re=Gh,Gh=!1,re}function qi(n,i,u){var d=i.updateQueue;if(d=d!==null?d.lastEffect:null,d!==null){var p=d=d.next;do{if((p.tag&n)===n){var g=p.destroy;p.destroy=void 0,g!==void 0&&Ju(i,u,g)}p=p.next}while(p!==d)}}function ya(n,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var u=i=i.next;do{if((u.tag&n)===n){var d=u.create;u.destroy=d()}u=u.next}while(u!==i)}}function Qu(n){var i=n.ref;if(i!==null){var u=n.stateNode;switch(n.tag){case 5:n=u;break;default:n=u}typeof i=="function"?i(n):i.current=n}}function qh(n){var i=n.alternate;i!==null&&(n.alternate=null,qh(i)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(i=n.stateNode,i!==null&&(delete i[on],delete i[Li],delete i[hu],delete i[rv],delete i[iv])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function Vh(n){return n.tag===5||n.tag===3||n.tag===4}function Zh(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||Vh(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Yu(n,i,u){var d=n.tag;if(d===5||d===6)n=n.stateNode,i?u.nodeType===8?u.parentNode.insertBefore(n,i):u.insertBefore(n,i):(u.nodeType===8?(i=u.parentNode,i.insertBefore(n,u)):(i=u,i.appendChild(n)),u=u._reactRootContainer,u!=null||i.onclick!==null||(i.onclick=Ws));else if(d!==4&&(n=n.child,n!==null))for(Yu(n,i,u),n=n.sibling;n!==null;)Yu(n,i,u),n=n.sibling}function Xu(n,i,u){var d=n.tag;if(d===5||d===6)n=n.stateNode,i?u.insertBefore(n,i):u.appendChild(n);else if(d!==4&&(n=n.child,n!==null))for(Xu(n,i,u),n=n.sibling;n!==null;)Xu(n,i,u),n=n.sibling}var rt=null,Kt=!1;function Dn(n,i,u){for(u=u.child;u!==null;)Wh(n,i,u),u=u.sibling}function Wh(n,i,u){if(an&&typeof an.onCommitFiberUnmount=="function")try{an.onCommitFiberUnmount(Cs,u)}catch{}switch(u.tag){case 5:ct||Zr(u,i);case 6:var d=rt,p=Kt;rt=null,Dn(n,i,u),rt=d,Kt=p,rt!==null&&(Kt?(n=rt,u=u.stateNode,n.nodeType===8?n.parentNode.removeChild(u):n.removeChild(u)):rt.removeChild(u.stateNode));break;case 18:rt!==null&&(Kt?(n=rt,u=u.stateNode,n.nodeType===8?fu(n.parentNode,u):n.nodeType===1&&fu(n,u),Si(n)):fu(rt,u.stateNode));break;case 4:d=rt,p=Kt,rt=u.stateNode.containerInfo,Kt=!0,Dn(n,i,u),rt=d,Kt=p;break;case 0:case 11:case 14:case 15:if(!ct&&(d=u.updateQueue,d!==null&&(d=d.lastEffect,d!==null))){p=d=d.next;do{var g=p,v=g.destroy;g=g.tag,v!==void 0&&((g&2)!==0||(g&4)!==0)&&Ju(u,i,v),p=p.next}while(p!==d)}Dn(n,i,u);break;case 1:if(!ct&&(Zr(u,i),d=u.stateNode,typeof d.componentWillUnmount=="function"))try{d.props=u.memoizedProps,d.state=u.memoizedState,d.componentWillUnmount()}catch(k){ze(u,i,k)}Dn(n,i,u);break;case 21:Dn(n,i,u);break;case 22:u.mode&1?(ct=(d=ct)||u.memoizedState!==null,Dn(n,i,u),ct=d):Dn(n,i,u);break;default:Dn(n,i,u)}}function Kh(n){var i=n.updateQueue;if(i!==null){n.updateQueue=null;var u=n.stateNode;u===null&&(u=n.stateNode=new wv),i.forEach(function(d){var p=Cv.bind(null,n,d);u.has(d)||(u.add(d),d.then(p,p))})}}function Jt(n,i){var u=i.deletions;if(u!==null)for(var d=0;d<u.length;d++){var p=u[d];try{var g=n,v=i,k=v;e:for(;k!==null;){switch(k.tag){case 5:rt=k.stateNode,Kt=!1;break e;case 3:rt=k.stateNode.containerInfo,Kt=!0;break e;case 4:rt=k.stateNode.containerInfo,Kt=!0;break e}k=k.return}if(rt===null)throw Error(t(160));Wh(g,v,p),rt=null,Kt=!1;var x=p.alternate;x!==null&&(x.return=null),p.return=null}catch(L){ze(p,i,L)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)Jh(i,n),i=i.sibling}function Jh(n,i){var u=n.alternate,d=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Jt(i,n),cn(n),d&4){try{qi(3,n,n.return),ya(3,n)}catch(ie){ze(n,n.return,ie)}try{qi(5,n,n.return)}catch(ie){ze(n,n.return,ie)}}break;case 1:Jt(i,n),cn(n),d&512&&u!==null&&Zr(u,u.return);break;case 5:if(Jt(i,n),cn(n),d&512&&u!==null&&Zr(u,u.return),n.flags&32){var p=n.stateNode;try{fi(p,"")}catch(ie){ze(n,n.return,ie)}}if(d&4&&(p=n.stateNode,p!=null)){var g=n.memoizedProps,v=u!==null?u.memoizedProps:g,k=n.type,x=n.updateQueue;if(n.updateQueue=null,x!==null)try{k==="input"&&g.type==="radio"&&g.name!=null&&Sd(p,g),Co(k,v);var L=Co(k,g);for(v=0;v<x.length;v+=2){var B=x[v],H=x[v+1];B==="style"?Nd(p,H):B==="dangerouslySetInnerHTML"?Id(p,H):B==="children"?fi(p,H):T(p,B,H,L)}switch(k){case"input":ko(p,g);break;case"textarea":Td(p,g);break;case"select":var F=p._wrapperState.wasMultiple;p._wrapperState.wasMultiple=!!g.multiple;var Y=g.value;Y!=null?Tr(p,!!g.multiple,Y,!1):F!==!!g.multiple&&(g.defaultValue!=null?Tr(p,!!g.multiple,g.defaultValue,!0):Tr(p,!!g.multiple,g.multiple?[]:"",!1))}p[Li]=g}catch(ie){ze(n,n.return,ie)}}break;case 6:if(Jt(i,n),cn(n),d&4){if(n.stateNode===null)throw Error(t(162));p=n.stateNode,g=n.memoizedProps;try{p.nodeValue=g}catch(ie){ze(n,n.return,ie)}}break;case 3:if(Jt(i,n),cn(n),d&4&&u!==null&&u.memoizedState.isDehydrated)try{Si(i.containerInfo)}catch(ie){ze(n,n.return,ie)}break;case 4:Jt(i,n),cn(n);break;case 13:Jt(i,n),cn(n),p=n.child,p.flags&8192&&(g=p.memoizedState!==null,p.stateNode.isHidden=g,!g||p.alternate!==null&&p.alternate.memoizedState!==null||(nl=Fe())),d&4&&Kh(n);break;case 22:if(B=u!==null&&u.memoizedState!==null,n.mode&1?(ct=(L=ct)||B,Jt(i,n),ct=L):Jt(i,n),cn(n),d&8192){if(L=n.memoizedState!==null,(n.stateNode.isHidden=L)&&!B&&(n.mode&1)!==0)for(ne=n,B=n.child;B!==null;){for(H=ne=B;ne!==null;){switch(F=ne,Y=F.child,F.tag){case 0:case 11:case 14:case 15:qi(4,F,F.return);break;case 1:Zr(F,F.return);var re=F.stateNode;if(typeof re.componentWillUnmount=="function"){d=F,u=F.return;try{i=d,re.props=i.memoizedProps,re.state=i.memoizedState,re.componentWillUnmount()}catch(ie){ze(d,u,ie)}}break;case 5:Zr(F,F.return);break;case 22:if(F.memoizedState!==null){Xh(H);continue}}Y!==null?(Y.return=F,ne=Y):Xh(H)}B=B.sibling}e:for(B=null,H=n;;){if(H.tag===5){if(B===null){B=H;try{p=H.stateNode,L?(g=p.style,typeof g.setProperty=="function"?g.setProperty("display","none","important"):g.display="none"):(k=H.stateNode,x=H.memoizedProps.style,v=x!=null&&x.hasOwnProperty("display")?x.display:null,k.style.display=Cd("display",v))}catch(ie){ze(n,n.return,ie)}}}else if(H.tag===6){if(B===null)try{H.stateNode.nodeValue=L?"":H.memoizedProps}catch(ie){ze(n,n.return,ie)}}else if((H.tag!==22&&H.tag!==23||H.memoizedState===null||H===n)&&H.child!==null){H.child.return=H,H=H.child;continue}if(H===n)break e;for(;H.sibling===null;){if(H.return===null||H.return===n)break e;B===H&&(B=null),H=H.return}B===H&&(B=null),H.sibling.return=H.return,H=H.sibling}}break;case 19:Jt(i,n),cn(n),d&4&&Kh(n);break;case 21:break;default:Jt(i,n),cn(n)}}function cn(n){var i=n.flags;if(i&2){try{e:{for(var u=n.return;u!==null;){if(Vh(u)){var d=u;break e}u=u.return}throw Error(t(160))}switch(d.tag){case 5:var p=d.stateNode;d.flags&32&&(fi(p,""),d.flags&=-33);var g=Zh(n);Xu(n,g,p);break;case 3:case 4:var v=d.stateNode.containerInfo,k=Zh(n);Yu(n,k,v);break;default:throw Error(t(161))}}catch(x){ze(n,n.return,x)}n.flags&=-3}i&4096&&(n.flags&=-4097)}function Ev(n,i,u){ne=n,Qh(n)}function Qh(n,i,u){for(var d=(n.mode&1)!==0;ne!==null;){var p=ne,g=p.child;if(p.tag===22&&d){var v=p.memoizedState!==null||ga;if(!v){var k=p.alternate,x=k!==null&&k.memoizedState!==null||ct;k=ga;var L=ct;if(ga=v,(ct=x)&&!L)for(ne=p;ne!==null;)v=ne,x=v.child,v.tag===22&&v.memoizedState!==null?ep(p):x!==null?(x.return=v,ne=x):ep(p);for(;g!==null;)ne=g,Qh(g),g=g.sibling;ne=p,ga=k,ct=L}Yh(n)}else(p.subtreeFlags&8772)!==0&&g!==null?(g.return=p,ne=g):Yh(n)}}function Yh(n){for(;ne!==null;){var i=ne;if((i.flags&8772)!==0){var u=i.alternate;try{if((i.flags&8772)!==0)switch(i.tag){case 0:case 11:case 15:ct||ya(5,i);break;case 1:var d=i.stateNode;if(i.flags&4&&!ct)if(u===null)d.componentDidMount();else{var p=i.elementType===i.type?u.memoizedProps:Wt(i.type,u.memoizedProps);d.componentDidUpdate(p,u.memoizedState,d.__reactInternalSnapshotBeforeUpdate)}var g=i.updateQueue;g!==null&&Xf(i,g,d);break;case 3:var v=i.updateQueue;if(v!==null){if(u=null,i.child!==null)switch(i.child.tag){case 5:u=i.child.stateNode;break;case 1:u=i.child.stateNode}Xf(i,v,u)}break;case 5:var k=i.stateNode;if(u===null&&i.flags&4){u=k;var x=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":x.autoFocus&&u.focus();break;case"img":x.src&&(u.src=x.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var L=i.alternate;if(L!==null){var B=L.memoizedState;if(B!==null){var H=B.dehydrated;H!==null&&Si(H)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}ct||i.flags&512&&Qu(i)}catch(F){ze(i,i.return,F)}}if(i===n){ne=null;break}if(u=i.sibling,u!==null){u.return=i.return,ne=u;break}ne=i.return}}function Xh(n){for(;ne!==null;){var i=ne;if(i===n){ne=null;break}var u=i.sibling;if(u!==null){u.return=i.return,ne=u;break}ne=i.return}}function ep(n){for(;ne!==null;){var i=ne;try{switch(i.tag){case 0:case 11:case 15:var u=i.return;try{ya(4,i)}catch(x){ze(i,u,x)}break;case 1:var d=i.stateNode;if(typeof d.componentDidMount=="function"){var p=i.return;try{d.componentDidMount()}catch(x){ze(i,p,x)}}var g=i.return;try{Qu(i)}catch(x){ze(i,g,x)}break;case 5:var v=i.return;try{Qu(i)}catch(x){ze(i,v,x)}}}catch(x){ze(i,i.return,x)}if(i===n){ne=null;break}var k=i.sibling;if(k!==null){k.return=i.return,ne=k;break}ne=i.return}}var Sv=Math.ceil,_a=$.ReactCurrentDispatcher,el=$.ReactCurrentOwner,Ft=$.ReactCurrentBatchConfig,we=0,Xe=null,qe=null,it=0,At=0,Wr=An(0),Ke=0,Vi=null,pr=0,va=0,tl=0,Zi=null,bt=null,nl=0,Kr=1/0,bn=null,wa=!1,rl=null,Mn=null,ba=!1,Un=null,Ea=0,Wi=0,il=null,Sa=-1,Oa=0;function ht(){return(we&6)!==0?Fe():Sa!==-1?Sa:Sa=Fe()}function zn(n){return(n.mode&1)===0?1:(we&2)!==0&&it!==0?it&-it:av.transition!==null?(Oa===0&&(Oa=Vd()),Oa):(n=Re,n!==0||(n=window.event,n=n===void 0?16:tf(n.type)),n)}function Qt(n,i,u,d){if(50<Wi)throw Wi=0,il=null,Error(t(185));_i(n,u,d),((we&2)===0||n!==Xe)&&(n===Xe&&((we&2)===0&&(va|=u),Ke===4&&Fn(n,it)),Et(n,d),u===1&&we===0&&(i.mode&1)===0&&(Kr=Fe()+500,Ys&&Ln()))}function Et(n,i){var u=n.callbackNode;a_(n,i);var d=Ps(n,n===Xe?it:0);if(d===0)u!==null&&Hd(u),n.callbackNode=null,n.callbackPriority=0;else if(i=d&-d,n.callbackPriority!==i){if(u!=null&&Hd(u),i===1)n.tag===0?sv(np.bind(null,n)):Ff(np.bind(null,n)),tv(function(){(we&6)===0&&Ln()}),u=null;else{switch(Zd(d)){case 1:u=Do;break;case 4:u=Gd;break;case 16:u=Is;break;case 536870912:u=qd;break;default:u=Is}u=cp(u,tp.bind(null,n))}n.callbackPriority=i,n.callbackNode=u}}function tp(n,i){if(Sa=-1,Oa=0,(we&6)!==0)throw Error(t(327));var u=n.callbackNode;if(Jr()&&n.callbackNode!==u)return null;var d=Ps(n,n===Xe?it:0);if(d===0)return null;if((d&30)!==0||(d&n.expiredLanes)!==0||i)i=ka(n,d);else{i=d;var p=we;we|=2;var g=ip();(Xe!==n||it!==i)&&(bn=null,Kr=Fe()+500,gr(n,i));do try{Tv();break}catch(k){rp(n,k)}while(!0);Eu(),_a.current=g,we=p,qe!==null?i=0:(Xe=null,it=0,i=Ke)}if(i!==0){if(i===2&&(p=Mo(n),p!==0&&(d=p,i=sl(n,p))),i===1)throw u=Vi,gr(n,0),Fn(n,d),Et(n,Fe()),u;if(i===6)Fn(n,d);else{if(p=n.current.alternate,(d&30)===0&&!Ov(p)&&(i=ka(n,d),i===2&&(g=Mo(n),g!==0&&(d=g,i=sl(n,g))),i===1))throw u=Vi,gr(n,0),Fn(n,d),Et(n,Fe()),u;switch(n.finishedWork=p,n.finishedLanes=d,i){case 0:case 1:throw Error(t(345));case 2:yr(n,bt,bn);break;case 3:if(Fn(n,d),(d&130023424)===d&&(i=nl+500-Fe(),10<i)){if(Ps(n,0)!==0)break;if(p=n.suspendedLanes,(p&d)!==d){ht(),n.pingedLanes|=n.suspendedLanes&p;break}n.timeoutHandle=du(yr.bind(null,n,bt,bn),i);break}yr(n,bt,bn);break;case 4:if(Fn(n,d),(d&4194240)===d)break;for(i=n.eventTimes,p=-1;0<d;){var v=31-qt(d);g=1<<v,v=i[v],v>p&&(p=v),d&=~g}if(d=p,d=Fe()-d,d=(120>d?120:480>d?480:1080>d?1080:1920>d?1920:3e3>d?3e3:4320>d?4320:1960*Sv(d/1960))-d,10<d){n.timeoutHandle=du(yr.bind(null,n,bt,bn),d);break}yr(n,bt,bn);break;case 5:yr(n,bt,bn);break;default:throw Error(t(329))}}}return Et(n,Fe()),n.callbackNode===u?tp.bind(null,n):null}function sl(n,i){var u=Zi;return n.current.memoizedState.isDehydrated&&(gr(n,i).flags|=256),n=ka(n,i),n!==2&&(i=bt,bt=u,i!==null&&al(i)),n}function al(n){bt===null?bt=n:bt.push.apply(bt,n)}function Ov(n){for(var i=n;;){if(i.flags&16384){var u=i.updateQueue;if(u!==null&&(u=u.stores,u!==null))for(var d=0;d<u.length;d++){var p=u[d],g=p.getSnapshot;p=p.value;try{if(!Vt(g(),p))return!1}catch{return!1}}}if(u=i.child,i.subtreeFlags&16384&&u!==null)u.return=i,i=u;else{if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Fn(n,i){for(i&=~tl,i&=~va,n.suspendedLanes|=i,n.pingedLanes&=~i,n=n.expirationTimes;0<i;){var u=31-qt(i),d=1<<u;n[u]=-1,i&=~d}}function np(n){if((we&6)!==0)throw Error(t(327));Jr();var i=Ps(n,0);if((i&1)===0)return Et(n,Fe()),null;var u=ka(n,i);if(n.tag!==0&&u===2){var d=Mo(n);d!==0&&(i=d,u=sl(n,d))}if(u===1)throw u=Vi,gr(n,0),Fn(n,i),Et(n,Fe()),u;if(u===6)throw Error(t(345));return n.finishedWork=n.current.alternate,n.finishedLanes=i,yr(n,bt,bn),Et(n,Fe()),null}function ol(n,i){var u=we;we|=1;try{return n(i)}finally{we=u,we===0&&(Kr=Fe()+500,Ys&&Ln())}}function mr(n){Un!==null&&Un.tag===0&&(we&6)===0&&Jr();var i=we;we|=1;var u=Ft.transition,d=Re;try{if(Ft.transition=null,Re=1,n)return n()}finally{Re=d,Ft.transition=u,we=i,(we&6)===0&&Ln()}}function ul(){At=Wr.current,je(Wr)}function gr(n,i){n.finishedWork=null,n.finishedLanes=0;var u=n.timeoutHandle;if(u!==-1&&(n.timeoutHandle=-1,ev(u)),qe!==null)for(u=qe.return;u!==null;){var d=u;switch(yu(d),d.tag){case 1:d=d.type.childContextTypes,d!=null&&Js();break;case 3:qr(),je(_t),je(ot),Cu();break;case 5:Ru(d);break;case 4:qr();break;case 13:je(De);break;case 19:je(De);break;case 10:Su(d.type._context);break;case 22:case 23:ul()}u=u.return}if(Xe=n,qe=n=Bn(n.current,null),it=At=i,Ke=0,Vi=null,tl=va=pr=0,bt=Zi=null,dr!==null){for(i=0;i<dr.length;i++)if(u=dr[i],d=u.interleaved,d!==null){u.interleaved=null;var p=d.next,g=u.pending;if(g!==null){var v=g.next;g.next=p,d.next=v}u.pending=d}dr=null}return n}function rp(n,i){do{var u=qe;try{if(Eu(),ua.current=fa,la){for(var d=Me.memoizedState;d!==null;){var p=d.queue;p!==null&&(p.pending=null),d=d.next}la=!1}if(hr=0,Ye=We=Me=null,zi=!1,Fi=0,el.current=null,u===null||u.return===null){Ke=1,Vi=i,qe=null;break}e:{var g=n,v=u.return,k=u,x=i;if(i=it,k.flags|=32768,x!==null&&typeof x=="object"&&typeof x.then=="function"){var L=x,B=k,H=B.tag;if((B.mode&1)===0&&(H===0||H===11||H===15)){var F=B.alternate;F?(B.updateQueue=F.updateQueue,B.memoizedState=F.memoizedState,B.lanes=F.lanes):(B.updateQueue=null,B.memoizedState=null)}var Y=Rh(v);if(Y!==null){Y.flags&=-257,Ih(Y,v,k,g,i),Y.mode&1&&xh(g,L,i),i=Y,x=L;var re=i.updateQueue;if(re===null){var ie=new Set;ie.add(x),i.updateQueue=ie}else re.add(x);break e}else{if((i&1)===0){xh(g,L,i),ll();break e}x=Error(t(426))}}else if($e&&k.mode&1){var Be=Rh(v);if(Be!==null){(Be.flags&65536)===0&&(Be.flags|=256),Ih(Be,v,k,g,i),wu(Vr(x,k));break e}}g=x=Vr(x,k),Ke!==4&&(Ke=2),Zi===null?Zi=[g]:Zi.push(g),g=v;do{switch(g.tag){case 3:g.flags|=65536,i&=-i,g.lanes|=i;var N=kh(g,x,i);Yf(g,N);break e;case 1:k=x;var C=g.type,A=g.stateNode;if((g.flags&128)===0&&(typeof C.getDerivedStateFromError=="function"||A!==null&&typeof A.componentDidCatch=="function"&&(Mn===null||!Mn.has(A)))){g.flags|=65536,i&=-i,g.lanes|=i;var q=Th(g,k,i);Yf(g,q);break e}}g=g.return}while(g!==null)}ap(u)}catch(ae){i=ae,qe===u&&u!==null&&(qe=u=u.return);continue}break}while(!0)}function ip(){var n=_a.current;return _a.current=fa,n===null?fa:n}function ll(){(Ke===0||Ke===3||Ke===2)&&(Ke=4),Xe===null||(pr&268435455)===0&&(va&268435455)===0||Fn(Xe,it)}function ka(n,i){var u=we;we|=2;var d=ip();(Xe!==n||it!==i)&&(bn=null,gr(n,i));do try{kv();break}catch(p){rp(n,p)}while(!0);if(Eu(),we=u,_a.current=d,qe!==null)throw Error(t(261));return Xe=null,it=0,Ke}function kv(){for(;qe!==null;)sp(qe)}function Tv(){for(;qe!==null&&!Qy();)sp(qe)}function sp(n){var i=lp(n.alternate,n,At);n.memoizedProps=n.pendingProps,i===null?ap(n):qe=i,el.current=null}function ap(n){var i=n;do{var u=i.alternate;if(n=i.return,(i.flags&32768)===0){if(u=_v(u,i,At),u!==null){qe=u;return}}else{if(u=vv(u,i),u!==null){u.flags&=32767,qe=u;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{Ke=6,qe=null;return}}if(i=i.sibling,i!==null){qe=i;return}qe=i=n}while(i!==null);Ke===0&&(Ke=5)}function yr(n,i,u){var d=Re,p=Ft.transition;try{Ft.transition=null,Re=1,xv(n,i,u,d)}finally{Ft.transition=p,Re=d}return null}function xv(n,i,u,d){do Jr();while(Un!==null);if((we&6)!==0)throw Error(t(327));u=n.finishedWork;var p=n.finishedLanes;if(u===null)return null;if(n.finishedWork=null,n.finishedLanes=0,u===n.current)throw Error(t(177));n.callbackNode=null,n.callbackPriority=0;var g=u.lanes|u.childLanes;if(o_(n,g),n===Xe&&(qe=Xe=null,it=0),(u.subtreeFlags&2064)===0&&(u.flags&2064)===0||ba||(ba=!0,cp(Is,function(){return Jr(),null})),g=(u.flags&15990)!==0,(u.subtreeFlags&15990)!==0||g){g=Ft.transition,Ft.transition=null;var v=Re;Re=1;var k=we;we|=4,el.current=null,bv(n,u),Jh(u,n),Z_(lu),$s=!!uu,lu=uu=null,n.current=u,Ev(u),Yy(),we=k,Re=v,Ft.transition=g}else n.current=u;if(ba&&(ba=!1,Un=n,Ea=p),g=n.pendingLanes,g===0&&(Mn=null),t_(u.stateNode),Et(n,Fe()),i!==null)for(d=n.onRecoverableError,u=0;u<i.length;u++)p=i[u],d(p.value,{componentStack:p.stack,digest:p.digest});if(wa)throw wa=!1,n=rl,rl=null,n;return(Ea&1)!==0&&n.tag!==0&&Jr(),g=n.pendingLanes,(g&1)!==0?n===il?Wi++:(Wi=0,il=n):Wi=0,Ln(),null}function Jr(){if(Un!==null){var n=Zd(Ea),i=Ft.transition,u=Re;try{if(Ft.transition=null,Re=16>n?16:n,Un===null)var d=!1;else{if(n=Un,Un=null,Ea=0,(we&6)!==0)throw Error(t(331));var p=we;for(we|=4,ne=n.current;ne!==null;){var g=ne,v=g.child;if((ne.flags&16)!==0){var k=g.deletions;if(k!==null){for(var x=0;x<k.length;x++){var L=k[x];for(ne=L;ne!==null;){var B=ne;switch(B.tag){case 0:case 11:case 15:qi(8,B,g)}var H=B.child;if(H!==null)H.return=B,ne=H;else for(;ne!==null;){B=ne;var F=B.sibling,Y=B.return;if(qh(B),B===L){ne=null;break}if(F!==null){F.return=Y,ne=F;break}ne=Y}}}var re=g.alternate;if(re!==null){var ie=re.child;if(ie!==null){re.child=null;do{var Be=ie.sibling;ie.sibling=null,ie=Be}while(ie!==null)}}ne=g}}if((g.subtreeFlags&2064)!==0&&v!==null)v.return=g,ne=v;else e:for(;ne!==null;){if(g=ne,(g.flags&2048)!==0)switch(g.tag){case 0:case 11:case 15:qi(9,g,g.return)}var N=g.sibling;if(N!==null){N.return=g.return,ne=N;break e}ne=g.return}}var C=n.current;for(ne=C;ne!==null;){v=ne;var A=v.child;if((v.subtreeFlags&2064)!==0&&A!==null)A.return=v,ne=A;else e:for(v=C;ne!==null;){if(k=ne,(k.flags&2048)!==0)try{switch(k.tag){case 0:case 11:case 15:ya(9,k)}}catch(ae){ze(k,k.return,ae)}if(k===v){ne=null;break e}var q=k.sibling;if(q!==null){q.return=k.return,ne=q;break e}ne=k.return}}if(we=p,Ln(),an&&typeof an.onPostCommitFiberRoot=="function")try{an.onPostCommitFiberRoot(Cs,n)}catch{}d=!0}return d}finally{Re=u,Ft.transition=i}}return!1}function op(n,i,u){i=Vr(u,i),i=kh(n,i,1),n=$n(n,i,1),i=ht(),n!==null&&(_i(n,1,i),Et(n,i))}function ze(n,i,u){if(n.tag===3)op(n,n,u);else for(;i!==null;){if(i.tag===3){op(i,n,u);break}else if(i.tag===1){var d=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(Mn===null||!Mn.has(d))){n=Vr(u,n),n=Th(i,n,1),i=$n(i,n,1),n=ht(),i!==null&&(_i(i,1,n),Et(i,n));break}}i=i.return}}function Rv(n,i,u){var d=n.pingCache;d!==null&&d.delete(i),i=ht(),n.pingedLanes|=n.suspendedLanes&u,Xe===n&&(it&u)===u&&(Ke===4||Ke===3&&(it&130023424)===it&&500>Fe()-nl?gr(n,0):tl|=u),Et(n,i)}function up(n,i){i===0&&((n.mode&1)===0?i=1:(i=As,As<<=1,(As&130023424)===0&&(As=4194304)));var u=ht();n=_n(n,i),n!==null&&(_i(n,i,u),Et(n,u))}function Iv(n){var i=n.memoizedState,u=0;i!==null&&(u=i.retryLane),up(n,u)}function Cv(n,i){var u=0;switch(n.tag){case 13:var d=n.stateNode,p=n.memoizedState;p!==null&&(u=p.retryLane);break;case 19:d=n.stateNode;break;default:throw Error(t(314))}d!==null&&d.delete(i),up(n,u)}var lp;lp=function(n,i,u){if(n!==null)if(n.memoizedProps!==i.pendingProps||_t.current)wt=!0;else{if((n.lanes&u)===0&&(i.flags&128)===0)return wt=!1,yv(n,i,u);wt=(n.flags&131072)!==0}else wt=!1,$e&&(i.flags&1048576)!==0&&Bf(i,ea,i.index);switch(i.lanes=0,i.tag){case 2:var d=i.type;ma(n,i),n=i.pendingProps;var p=Mr(i,ot.current);Gr(i,u),p=Pu(null,i,d,n,p,u);var g=Lu();return i.flags|=1,typeof p=="object"&&p!==null&&typeof p.render=="function"&&p.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,vt(d)?(g=!0,Qs(i)):g=!1,i.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,Tu(i),p.updater=ha,i.stateNode=p,p._reactInternals=i,zu(i,d,n,u),i=Gu(null,i,d,!0,g,u)):(i.tag=0,$e&&g&&gu(i),ft(null,i,p,u),i=i.child),i;case 16:d=i.elementType;e:{switch(ma(n,i),n=i.pendingProps,p=d._init,d=p(d._payload),i.type=d,p=i.tag=Av(d),n=Wt(d,n),p){case 0:i=Hu(null,i,d,n,u);break e;case 1:i=jh(null,i,d,n,u);break e;case 11:i=Ch(null,i,d,n,u);break e;case 14:i=Nh(null,i,d,Wt(d.type,n),u);break e}throw Error(t(306,d,""))}return i;case 0:return d=i.type,p=i.pendingProps,p=i.elementType===d?p:Wt(d,p),Hu(n,i,d,p,u);case 1:return d=i.type,p=i.pendingProps,p=i.elementType===d?p:Wt(d,p),jh(n,i,d,p,u);case 3:e:{if($h(i),n===null)throw Error(t(387));d=i.pendingProps,g=i.memoizedState,p=g.element,Qf(n,i),aa(i,d,null,u);var v=i.memoizedState;if(d=v.element,g.isDehydrated)if(g={element:d,isDehydrated:!1,cache:v.cache,pendingSuspenseBoundaries:v.pendingSuspenseBoundaries,transitions:v.transitions},i.updateQueue.baseState=g,i.memoizedState=g,i.flags&256){p=Vr(Error(t(423)),i),i=Dh(n,i,d,u,p);break e}else if(d!==p){p=Vr(Error(t(424)),i),i=Dh(n,i,d,u,p);break e}else for(Nt=Nn(i.stateNode.containerInfo.firstChild),Ct=i,$e=!0,Zt=null,u=Kf(i,null,d,u),i.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling;else{if(Fr(),d===p){i=wn(n,i,u);break e}ft(n,i,d,u)}i=i.child}return i;case 5:return eh(i),n===null&&vu(i),d=i.type,p=i.pendingProps,g=n!==null?n.memoizedProps:null,v=p.children,cu(d,p)?v=null:g!==null&&cu(d,g)&&(i.flags|=32),Lh(n,i),ft(n,i,v,u),i.child;case 6:return n===null&&vu(i),null;case 13:return Mh(n,i,u);case 4:return xu(i,i.stateNode.containerInfo),d=i.pendingProps,n===null?i.child=Br(i,null,d,u):ft(n,i,d,u),i.child;case 11:return d=i.type,p=i.pendingProps,p=i.elementType===d?p:Wt(d,p),Ch(n,i,d,p,u);case 7:return ft(n,i,i.pendingProps,u),i.child;case 8:return ft(n,i,i.pendingProps.children,u),i.child;case 12:return ft(n,i,i.pendingProps.children,u),i.child;case 10:e:{if(d=i.type._context,p=i.pendingProps,g=i.memoizedProps,v=p.value,Pe(ra,d._currentValue),d._currentValue=v,g!==null)if(Vt(g.value,v)){if(g.children===p.children&&!_t.current){i=wn(n,i,u);break e}}else for(g=i.child,g!==null&&(g.return=i);g!==null;){var k=g.dependencies;if(k!==null){v=g.child;for(var x=k.firstContext;x!==null;){if(x.context===d){if(g.tag===1){x=vn(-1,u&-u),x.tag=2;var L=g.updateQueue;if(L!==null){L=L.shared;var B=L.pending;B===null?x.next=x:(x.next=B.next,B.next=x),L.pending=x}}g.lanes|=u,x=g.alternate,x!==null&&(x.lanes|=u),Ou(g.return,u,i),k.lanes|=u;break}x=x.next}}else if(g.tag===10)v=g.type===i.type?null:g.child;else if(g.tag===18){if(v=g.return,v===null)throw Error(t(341));v.lanes|=u,k=v.alternate,k!==null&&(k.lanes|=u),Ou(v,u,i),v=g.sibling}else v=g.child;if(v!==null)v.return=g;else for(v=g;v!==null;){if(v===i){v=null;break}if(g=v.sibling,g!==null){g.return=v.return,v=g;break}v=v.return}g=v}ft(n,i,p.children,u),i=i.child}return i;case 9:return p=i.type,d=i.pendingProps.children,Gr(i,u),p=Ut(p),d=d(p),i.flags|=1,ft(n,i,d,u),i.child;case 14:return d=i.type,p=Wt(d,i.pendingProps),p=Wt(d.type,p),Nh(n,i,d,p,u);case 15:return Ah(n,i,i.type,i.pendingProps,u);case 17:return d=i.type,p=i.pendingProps,p=i.elementType===d?p:Wt(d,p),ma(n,i),i.tag=1,vt(d)?(n=!0,Qs(i)):n=!1,Gr(i,u),Sh(i,d,p),zu(i,d,p,u),Gu(null,i,d,!0,n,u);case 19:return zh(n,i,u);case 22:return Ph(n,i,u)}throw Error(t(156,i.tag))};function cp(n,i){return Bd(n,i)}function Nv(n,i,u,d){this.tag=n,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bt(n,i,u,d){return new Nv(n,i,u,d)}function cl(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Av(n){if(typeof n=="function")return cl(n)?1:0;if(n!=null){if(n=n.$$typeof,n===Ue)return 11;if(n===G)return 14}return 2}function Bn(n,i){var u=n.alternate;return u===null?(u=Bt(n.tag,i,n.key,n.mode),u.elementType=n.elementType,u.type=n.type,u.stateNode=n.stateNode,u.alternate=n,n.alternate=u):(u.pendingProps=i,u.type=n.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=n.flags&14680064,u.childLanes=n.childLanes,u.lanes=n.lanes,u.child=n.child,u.memoizedProps=n.memoizedProps,u.memoizedState=n.memoizedState,u.updateQueue=n.updateQueue,i=n.dependencies,u.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},u.sibling=n.sibling,u.index=n.index,u.ref=n.ref,u}function Ta(n,i,u,d,p,g){var v=2;if(d=n,typeof n=="function")cl(n)&&(v=1);else if(typeof n=="string")v=5;else e:switch(n){case Q:return _r(u.children,p,g,i);case W:v=8,p|=8;break;case Ee:return n=Bt(12,u,i,p|2),n.elementType=Ee,n.lanes=g,n;case Ge:return n=Bt(13,u,i,p),n.elementType=Ge,n.lanes=g,n;case K:return n=Bt(19,u,i,p),n.elementType=K,n.lanes=g,n;case J:return xa(u,p,g,i);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case Ae:v=10;break e;case He:v=9;break e;case Ue:v=11;break e;case G:v=14;break e;case ee:v=16,d=null;break e}throw Error(t(130,n==null?n:typeof n,""))}return i=Bt(v,u,i,p),i.elementType=n,i.type=d,i.lanes=g,i}function _r(n,i,u,d){return n=Bt(7,n,d,i),n.lanes=u,n}function xa(n,i,u,d){return n=Bt(22,n,d,i),n.elementType=J,n.lanes=u,n.stateNode={isHidden:!1},n}function dl(n,i,u){return n=Bt(6,n,null,i),n.lanes=u,n}function fl(n,i,u){return i=Bt(4,n.children!==null?n.children:[],n.key,i),i.lanes=u,i.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},i}function Pv(n,i,u,d,p){this.tag=i,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Uo(0),this.expirationTimes=Uo(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Uo(0),this.identifierPrefix=d,this.onRecoverableError=p,this.mutableSourceEagerHydrationData=null}function hl(n,i,u,d,p,g,v,k,x){return n=new Pv(n,i,u,k,x),i===1?(i=1,g===!0&&(i|=8)):i=0,g=Bt(3,null,null,i),n.current=g,g.stateNode=n,g.memoizedState={element:d,isDehydrated:u,cache:null,transitions:null,pendingSuspenseBoundaries:null},Tu(g),n}function Lv(n,i,u){var d=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:z,key:d==null?null:""+d,children:n,containerInfo:i,implementation:u}}function dp(n){if(!n)return Pn;n=n._reactInternals;e:{if(ar(n)!==n||n.tag!==1)throw Error(t(170));var i=n;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(vt(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(t(171))}if(n.tag===1){var u=n.type;if(vt(u))return Uf(n,u,i)}return i}function fp(n,i,u,d,p,g,v,k,x){return n=hl(u,d,!0,n,p,g,v,k,x),n.context=dp(null),u=n.current,d=ht(),p=zn(u),g=vn(d,p),g.callback=i??null,$n(u,g,p),n.current.lanes=p,_i(n,p,d),Et(n,d),n}function Ra(n,i,u,d){var p=i.current,g=ht(),v=zn(p);return u=dp(u),i.context===null?i.context=u:i.pendingContext=u,i=vn(g,v),i.payload={element:n},d=d===void 0?null:d,d!==null&&(i.callback=d),n=$n(p,i,v),n!==null&&(Qt(n,p,v,g),sa(n,p,v)),v}function Ia(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function hp(n,i){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var u=n.retryLane;n.retryLane=u!==0&&u<i?u:i}}function pl(n,i){hp(n,i),(n=n.alternate)&&hp(n,i)}function jv(){return null}var pp=typeof reportError=="function"?reportError:function(n){console.error(n)};function ml(n){this._internalRoot=n}Ca.prototype.render=ml.prototype.render=function(n){var i=this._internalRoot;if(i===null)throw Error(t(409));Ra(n,i,null,null)},Ca.prototype.unmount=ml.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var i=n.containerInfo;mr(function(){Ra(null,n,null,null)}),i[pn]=null}};function Ca(n){this._internalRoot=n}Ca.prototype.unstable_scheduleHydration=function(n){if(n){var i=Jd();n={blockedOn:null,target:n,priority:i};for(var u=0;u<Rn.length&&i!==0&&i<Rn[u].priority;u++);Rn.splice(u,0,n),u===0&&Xd(n)}};function gl(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function Na(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function mp(){}function $v(n,i,u,d,p){if(p){if(typeof d=="function"){var g=d;d=function(){var L=Ia(v);g.call(L)}}var v=fp(i,d,n,0,null,!1,!1,"",mp);return n._reactRootContainer=v,n[pn]=v.current,Ai(n.nodeType===8?n.parentNode:n),mr(),v}for(;p=n.lastChild;)n.removeChild(p);if(typeof d=="function"){var k=d;d=function(){var L=Ia(x);k.call(L)}}var x=hl(n,0,!1,null,null,!1,!1,"",mp);return n._reactRootContainer=x,n[pn]=x.current,Ai(n.nodeType===8?n.parentNode:n),mr(function(){Ra(i,x,u,d)}),x}function Aa(n,i,u,d,p){var g=u._reactRootContainer;if(g){var v=g;if(typeof p=="function"){var k=p;p=function(){var x=Ia(v);k.call(x)}}Ra(i,v,n,p)}else v=$v(u,i,n,p,d);return Ia(v)}Wd=function(n){switch(n.tag){case 3:var i=n.stateNode;if(i.current.memoizedState.isDehydrated){var u=yi(i.pendingLanes);u!==0&&(zo(i,u|1),Et(i,Fe()),(we&6)===0&&(Kr=Fe()+500,Ln()))}break;case 13:mr(function(){var d=_n(n,1);if(d!==null){var p=ht();Qt(d,n,1,p)}}),pl(n,1)}},Fo=function(n){if(n.tag===13){var i=_n(n,134217728);if(i!==null){var u=ht();Qt(i,n,134217728,u)}pl(n,134217728)}},Kd=function(n){if(n.tag===13){var i=zn(n),u=_n(n,i);if(u!==null){var d=ht();Qt(u,n,i,d)}pl(n,i)}},Jd=function(){return Re},Qd=function(n,i){var u=Re;try{return Re=n,i()}finally{Re=u}},Po=function(n,i,u){switch(i){case"input":if(ko(n,u),i=u.name,u.type==="radio"&&i!=null){for(u=n;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<u.length;i++){var d=u[i];if(d!==n&&d.form===n.form){var p=Ks(d);if(!p)throw Error(t(90));bd(d),ko(d,p)}}}break;case"textarea":Td(n,u);break;case"select":i=u.value,i!=null&&Tr(n,!!u.multiple,i,!1)}},jd=ol,$d=mr;var Dv={usingClientEntryPoint:!1,Events:[ji,$r,Ks,Pd,Ld,ol]},Ki={findFiberByHostInstance:or,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Mv={bundleType:Ki.bundleType,version:Ki.version,rendererPackageName:Ki.rendererPackageName,rendererConfig:Ki.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:$.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=zd(n),n===null?null:n.stateNode},findFiberByHostInstance:Ki.findFiberByHostInstance||jv,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Pa=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Pa.isDisabled&&Pa.supportsFiber)try{Cs=Pa.inject(Mv),an=Pa}catch{}}return St.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Dv,St.createPortal=function(n,i){var u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!gl(i))throw Error(t(200));return Lv(n,i,null,u)},St.createRoot=function(n,i){if(!gl(n))throw Error(t(299));var u=!1,d="",p=pp;return i!=null&&(i.unstable_strictMode===!0&&(u=!0),i.identifierPrefix!==void 0&&(d=i.identifierPrefix),i.onRecoverableError!==void 0&&(p=i.onRecoverableError)),i=hl(n,1,!1,null,null,u,!1,d,p),n[pn]=i.current,Ai(n.nodeType===8?n.parentNode:n),new ml(i)},St.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var i=n._reactInternals;if(i===void 0)throw typeof n.render=="function"?Error(t(188)):(n=Object.keys(n).join(","),Error(t(268,n)));return n=zd(i),n=n===null?null:n.stateNode,n},St.flushSync=function(n){return mr(n)},St.hydrate=function(n,i,u){if(!Na(i))throw Error(t(200));return Aa(null,n,i,!0,u)},St.hydrateRoot=function(n,i,u){if(!gl(n))throw Error(t(405));var d=u!=null&&u.hydratedSources||null,p=!1,g="",v=pp;if(u!=null&&(u.unstable_strictMode===!0&&(p=!0),u.identifierPrefix!==void 0&&(g=u.identifierPrefix),u.onRecoverableError!==void 0&&(v=u.onRecoverableError)),i=fp(i,null,n,1,u??null,p,!1,g,v),n[pn]=i.current,Ai(n),d)for(n=0;n<d.length;n++)u=d[n],p=u._getVersion,p=p(u._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[u,p]:i.mutableSourceEagerHydrationData.push(u,p);return new Ca(i)},St.render=function(n,i,u){if(!Na(i))throw Error(t(200));return Aa(null,n,i,!1,u)},St.unmountComponentAtNode=function(n){if(!Na(n))throw Error(t(40));return n._reactRootContainer?(mr(function(){Aa(null,null,n,!1,function(){n._reactRootContainer=null,n[pn]=null})}),!0):!1},St.unstable_batchedUpdates=ol,St.unstable_renderSubtreeIntoContainer=function(n,i,u,d){if(!Na(u))throw Error(t(200));if(n==null||n._reactInternals===void 0)throw Error(t(38));return Aa(n,i,u,!1,d)},St.version="18.3.1-next-f1338f8080-20240426",St}var Sp;function Kv(){if(Sp)return vl.exports;Sp=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),vl.exports=Wv(),vl.exports}var Op;function Jv(){if(Op)return La;Op=1;var s=Kv();return La.createRoot=s.createRoot,La.hydrateRoot=s.hydrateRoot,La}var Qv=Jv();const Yv=Or(Qv);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xv=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Yg=(...s)=>s.filter((e,t,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===t).join(" ").trim();/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var ew={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tw=at.forwardRef(({color:s="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:a="",children:o,iconNode:l,...c},f)=>at.createElement("svg",{ref:f,...ew,width:e,height:e,stroke:s,strokeWidth:r?Number(t)*24/Number(e):t,className:Yg("lucide",a),...c},[...l.map(([h,m])=>at.createElement(h,m)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ho=(s,e)=>{const t=at.forwardRef(({className:r,...a},o)=>at.createElement(tw,{ref:o,iconNode:e,className:Yg(`lucide-${Xv(s)}`,r),...a}));return t.displayName=`${s}`,t};/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nw=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],kp=ho("BookOpen",nw);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rw=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],iw=ho("LoaderCircle",rw);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sw=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]],aw=ho("MessageSquare",sw);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ow=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],uw=ho("Send",ow);var Tp;(function(s){s.STRING="string",s.NUMBER="number",s.INTEGER="integer",s.BOOLEAN="boolean",s.ARRAY="array",s.OBJECT="object"})(Tp||(Tp={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var xp;(function(s){s.LANGUAGE_UNSPECIFIED="language_unspecified",s.PYTHON="python"})(xp||(xp={}));var Rp;(function(s){s.OUTCOME_UNSPECIFIED="outcome_unspecified",s.OUTCOME_OK="outcome_ok",s.OUTCOME_FAILED="outcome_failed",s.OUTCOME_DEADLINE_EXCEEDED="outcome_deadline_exceeded"})(Rp||(Rp={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ip=["user","model","function","system"];var Cp;(function(s){s.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",s.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",s.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",s.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",s.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT"})(Cp||(Cp={}));var Np;(function(s){s.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",s.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",s.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",s.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",s.BLOCK_NONE="BLOCK_NONE"})(Np||(Np={}));var Ap;(function(s){s.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",s.NEGLIGIBLE="NEGLIGIBLE",s.LOW="LOW",s.MEDIUM="MEDIUM",s.HIGH="HIGH"})(Ap||(Ap={}));var Pp;(function(s){s.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",s.SAFETY="SAFETY",s.OTHER="OTHER"})(Pp||(Pp={}));var ss;(function(s){s.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",s.STOP="STOP",s.MAX_TOKENS="MAX_TOKENS",s.SAFETY="SAFETY",s.RECITATION="RECITATION",s.LANGUAGE="LANGUAGE",s.OTHER="OTHER"})(ss||(ss={}));var Lp;(function(s){s.TASK_TYPE_UNSPECIFIED="TASK_TYPE_UNSPECIFIED",s.RETRIEVAL_QUERY="RETRIEVAL_QUERY",s.RETRIEVAL_DOCUMENT="RETRIEVAL_DOCUMENT",s.SEMANTIC_SIMILARITY="SEMANTIC_SIMILARITY",s.CLASSIFICATION="CLASSIFICATION",s.CLUSTERING="CLUSTERING"})(Lp||(Lp={}));var jp;(function(s){s.MODE_UNSPECIFIED="MODE_UNSPECIFIED",s.AUTO="AUTO",s.ANY="ANY",s.NONE="NONE"})(jp||(jp={}));var $p;(function(s){s.MODE_UNSPECIFIED="MODE_UNSPECIFIED",s.MODE_DYNAMIC="MODE_DYNAMIC"})($p||($p={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rt extends Error{constructor(e){super(`[GoogleGenerativeAI Error]: ${e}`)}}class Qr extends Rt{constructor(e,t){super(e),this.response=t}}class Xg extends Rt{constructor(e,t,r,a){super(e),this.status=t,this.statusText=r,this.errorDetails=a}}class Yn extends Rt{}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lw="https://generativelanguage.googleapis.com",cw="v1beta",dw="0.21.0",fw="genai-js";var Er;(function(s){s.GENERATE_CONTENT="generateContent",s.STREAM_GENERATE_CONTENT="streamGenerateContent",s.COUNT_TOKENS="countTokens",s.EMBED_CONTENT="embedContent",s.BATCH_EMBED_CONTENTS="batchEmbedContents"})(Er||(Er={}));class hw{constructor(e,t,r,a,o){this.model=e,this.task=t,this.apiKey=r,this.stream=a,this.requestOptions=o}toString(){var e,t;const r=((e=this.requestOptions)===null||e===void 0?void 0:e.apiVersion)||cw;let o=`${((t=this.requestOptions)===null||t===void 0?void 0:t.baseUrl)||lw}/${r}/${this.model}:${this.task}`;return this.stream&&(o+="?alt=sse"),o}}function pw(s){const e=[];return s!=null&&s.apiClient&&e.push(s.apiClient),e.push(`${fw}/${dw}`),e.join(" ")}async function mw(s){var e;const t=new Headers;t.append("Content-Type","application/json"),t.append("x-goog-api-client",pw(s.requestOptions)),t.append("x-goog-api-key",s.apiKey);let r=(e=s.requestOptions)===null||e===void 0?void 0:e.customHeaders;if(r){if(!(r instanceof Headers))try{r=new Headers(r)}catch(a){throw new Yn(`unable to convert customHeaders value ${JSON.stringify(r)} to Headers: ${a.message}`)}for(const[a,o]of r.entries()){if(a==="x-goog-api-key")throw new Yn(`Cannot set reserved header name ${a}`);if(a==="x-goog-api-client")throw new Yn(`Header name ${a} can only be set using the apiClient field`);t.append(a,o)}}return t}async function gw(s,e,t,r,a,o){const l=new hw(s,e,t,r,o);return{url:l.toString(),fetchOptions:Object.assign(Object.assign({},ww(o)),{method:"POST",headers:await mw(l),body:a})}}async function ws(s,e,t,r,a,o={},l=fetch){const{url:c,fetchOptions:f}=await gw(s,e,t,r,a,o);return yw(c,f,l)}async function yw(s,e,t=fetch){let r;try{r=await t(s,e)}catch(a){_w(a,s)}return r.ok||await vw(r,s),r}function _w(s,e){let t=s;throw s instanceof Xg||s instanceof Yn||(t=new Rt(`Error fetching from ${e.toString()}: ${s.message}`),t.stack=s.stack),t}async function vw(s,e){let t="",r;try{const a=await s.json();t=a.error.message,a.error.details&&(t+=` ${JSON.stringify(a.error.details)}`,r=a.error.details)}catch{}throw new Xg(`Error fetching from ${e.toString()}: [${s.status} ${s.statusText}] ${t}`,s.status,s.statusText,r)}function ww(s){const e={};if((s==null?void 0:s.signal)!==void 0||(s==null?void 0:s.timeout)>=0){const t=new AbortController;(s==null?void 0:s.timeout)>=0&&setTimeout(()=>t.abort(),s.timeout),s!=null&&s.signal&&s.signal.addEventListener("abort",()=>{t.abort()}),e.signal=t.signal}return e}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rd(s){return s.text=()=>{if(s.candidates&&s.candidates.length>0){if(s.candidates.length>1&&console.warn(`This response had ${s.candidates.length} candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates.`),Va(s.candidates[0]))throw new Qr(`${Zn(s)}`,s);return bw(s)}else if(s.promptFeedback)throw new Qr(`Text not available. ${Zn(s)}`,s);return""},s.functionCall=()=>{if(s.candidates&&s.candidates.length>0){if(s.candidates.length>1&&console.warn(`This response had ${s.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),Va(s.candidates[0]))throw new Qr(`${Zn(s)}`,s);return console.warn("response.functionCall() is deprecated. Use response.functionCalls() instead."),Dp(s)[0]}else if(s.promptFeedback)throw new Qr(`Function call not available. ${Zn(s)}`,s)},s.functionCalls=()=>{if(s.candidates&&s.candidates.length>0){if(s.candidates.length>1&&console.warn(`This response had ${s.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),Va(s.candidates[0]))throw new Qr(`${Zn(s)}`,s);return Dp(s)}else if(s.promptFeedback)throw new Qr(`Function call not available. ${Zn(s)}`,s)},s}function bw(s){var e,t,r,a;const o=[];if(!((t=(e=s.candidates)===null||e===void 0?void 0:e[0].content)===null||t===void 0)&&t.parts)for(const l of(a=(r=s.candidates)===null||r===void 0?void 0:r[0].content)===null||a===void 0?void 0:a.parts)l.text&&o.push(l.text),l.executableCode&&o.push("\n```"+l.executableCode.language+`
`+l.executableCode.code+"\n```\n"),l.codeExecutionResult&&o.push("\n```\n"+l.codeExecutionResult.output+"\n```\n");return o.length>0?o.join(""):""}function Dp(s){var e,t,r,a;const o=[];if(!((t=(e=s.candidates)===null||e===void 0?void 0:e[0].content)===null||t===void 0)&&t.parts)for(const l of(a=(r=s.candidates)===null||r===void 0?void 0:r[0].content)===null||a===void 0?void 0:a.parts)l.functionCall&&o.push(l.functionCall);if(o.length>0)return o}const Ew=[ss.RECITATION,ss.SAFETY,ss.LANGUAGE];function Va(s){return!!s.finishReason&&Ew.includes(s.finishReason)}function Zn(s){var e,t,r;let a="";if((!s.candidates||s.candidates.length===0)&&s.promptFeedback)a+="Response was blocked",!((e=s.promptFeedback)===null||e===void 0)&&e.blockReason&&(a+=` due to ${s.promptFeedback.blockReason}`),!((t=s.promptFeedback)===null||t===void 0)&&t.blockReasonMessage&&(a+=`: ${s.promptFeedback.blockReasonMessage}`);else if(!((r=s.candidates)===null||r===void 0)&&r[0]){const o=s.candidates[0];Va(o)&&(a+=`Candidate was blocked due to ${o.finishReason}`,o.finishMessage&&(a+=`: ${o.finishMessage}`))}return a}function fs(s){return this instanceof fs?(this.v=s,this):new fs(s)}function Sw(s,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(s,e||[]),a,o=[];return a={},l("next"),l("throw"),l("return"),a[Symbol.asyncIterator]=function(){return this},a;function l(y){r[y]&&(a[y]=function(w){return new Promise(function(b,E){o.push([y,w,b,E])>1||c(y,w)})})}function c(y,w){try{f(r[y](w))}catch(b){_(o[0][3],b)}}function f(y){y.value instanceof fs?Promise.resolve(y.value.v).then(h,m):_(o[0][2],y)}function h(y){c("next",y)}function m(y){c("throw",y)}function _(y,w){y(w),o.shift(),o.length&&c(o[0][0],o[0][1])}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mp=/^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;function Ow(s){const e=s.body.pipeThrough(new TextDecoderStream("utf8",{fatal:!0})),t=xw(e),[r,a]=t.tee();return{stream:Tw(r),response:kw(a)}}async function kw(s){const e=[],t=s.getReader();for(;;){const{done:r,value:a}=await t.read();if(r)return rd(Rw(e));e.push(a)}}function Tw(s){return Sw(this,arguments,function*(){const t=s.getReader();for(;;){const{value:r,done:a}=yield fs(t.read());if(a)break;yield yield fs(rd(r))}})}function xw(s){const e=s.getReader();return new ReadableStream({start(r){let a="";return o();function o(){return e.read().then(({value:l,done:c})=>{if(c){if(a.trim()){r.error(new Rt("Failed to parse stream"));return}r.close();return}a+=l;let f=a.match(Mp),h;for(;f;){try{h=JSON.parse(f[1])}catch{r.error(new Rt(`Error parsing JSON response: "${f[1]}"`));return}r.enqueue(h),a=a.substring(f[0].length),f=a.match(Mp)}return o()})}}})}function Rw(s){const e=s[s.length-1],t={promptFeedback:e==null?void 0:e.promptFeedback};for(const r of s){if(r.candidates)for(const a of r.candidates){const o=a.index;if(t.candidates||(t.candidates=[]),t.candidates[o]||(t.candidates[o]={index:a.index}),t.candidates[o].citationMetadata=a.citationMetadata,t.candidates[o].groundingMetadata=a.groundingMetadata,t.candidates[o].finishReason=a.finishReason,t.candidates[o].finishMessage=a.finishMessage,t.candidates[o].safetyRatings=a.safetyRatings,a.content&&a.content.parts){t.candidates[o].content||(t.candidates[o].content={role:a.content.role||"user",parts:[]});const l={};for(const c of a.content.parts)c.text&&(l.text=c.text),c.functionCall&&(l.functionCall=c.functionCall),c.executableCode&&(l.executableCode=c.executableCode),c.codeExecutionResult&&(l.codeExecutionResult=c.codeExecutionResult),Object.keys(l).length===0&&(l.text=""),t.candidates[o].content.parts.push(l)}}r.usageMetadata&&(t.usageMetadata=r.usageMetadata)}return t}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ey(s,e,t,r){const a=await ws(e,Er.STREAM_GENERATE_CONTENT,s,!0,JSON.stringify(t),r);return Ow(a)}async function ty(s,e,t,r){const o=await(await ws(e,Er.GENERATE_CONTENT,s,!1,JSON.stringify(t),r)).json();return{response:rd(o)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ny(s){if(s!=null){if(typeof s=="string")return{role:"system",parts:[{text:s}]};if(s.text)return{role:"system",parts:[s]};if(s.parts)return s.role?s:{role:"system",parts:s.parts}}}function hs(s){let e=[];if(typeof s=="string")e=[{text:s}];else for(const t of s)typeof t=="string"?e.push({text:t}):e.push(t);return Iw(e)}function Iw(s){const e={role:"user",parts:[]},t={role:"function",parts:[]};let r=!1,a=!1;for(const o of s)"functionResponse"in o?(t.parts.push(o),a=!0):(e.parts.push(o),r=!0);if(r&&a)throw new Rt("Within a single message, FunctionResponse cannot be mixed with other type of part in the request for sending chat message.");if(!r&&!a)throw new Rt("No content is provided for sending chat message.");return r?e:t}function Cw(s,e){var t;let r={model:e==null?void 0:e.model,generationConfig:e==null?void 0:e.generationConfig,safetySettings:e==null?void 0:e.safetySettings,tools:e==null?void 0:e.tools,toolConfig:e==null?void 0:e.toolConfig,systemInstruction:e==null?void 0:e.systemInstruction,cachedContent:(t=e==null?void 0:e.cachedContent)===null||t===void 0?void 0:t.name,contents:[]};const a=s.generateContentRequest!=null;if(s.contents){if(a)throw new Yn("CountTokensRequest must have one of contents or generateContentRequest, not both.");r.contents=s.contents}else if(a)r=Object.assign(Object.assign({},r),s.generateContentRequest);else{const o=hs(s);r.contents=[o]}return{generateContentRequest:r}}function Up(s){let e;return s.contents?e=s:e={contents:[hs(s)]},s.systemInstruction&&(e.systemInstruction=ny(s.systemInstruction)),e}function Nw(s){return typeof s=="string"||Array.isArray(s)?{content:hs(s)}:s}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zp=["text","inlineData","functionCall","functionResponse","executableCode","codeExecutionResult"],Aw={user:["text","inlineData"],function:["functionResponse"],model:["text","functionCall","executableCode","codeExecutionResult"],system:["text"]};function Pw(s){let e=!1;for(const t of s){const{role:r,parts:a}=t;if(!e&&r!=="user")throw new Rt(`First content should be with role 'user', got ${r}`);if(!Ip.includes(r))throw new Rt(`Each item should include role field. Got ${r} but valid roles are: ${JSON.stringify(Ip)}`);if(!Array.isArray(a))throw new Rt("Content should have 'parts' property with an array of Parts");if(a.length===0)throw new Rt("Each Content should have at least one part");const o={text:0,inlineData:0,functionCall:0,functionResponse:0,fileData:0,executableCode:0,codeExecutionResult:0};for(const c of a)for(const f of zp)f in c&&(o[f]+=1);const l=Aw[r];for(const c of zp)if(!l.includes(c)&&o[c]>0)throw new Rt(`Content with role '${r}' can't contain '${c}' part`);e=!0}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fp="SILENT_ERROR";class Lw{constructor(e,t,r,a={}){this.model=t,this.params=r,this._requestOptions=a,this._history=[],this._sendPromise=Promise.resolve(),this._apiKey=e,r!=null&&r.history&&(Pw(r.history),this._history=r.history)}async getHistory(){return await this._sendPromise,this._history}async sendMessage(e,t={}){var r,a,o,l,c,f;await this._sendPromise;const h=hs(e),m={safetySettings:(r=this.params)===null||r===void 0?void 0:r.safetySettings,generationConfig:(a=this.params)===null||a===void 0?void 0:a.generationConfig,tools:(o=this.params)===null||o===void 0?void 0:o.tools,toolConfig:(l=this.params)===null||l===void 0?void 0:l.toolConfig,systemInstruction:(c=this.params)===null||c===void 0?void 0:c.systemInstruction,cachedContent:(f=this.params)===null||f===void 0?void 0:f.cachedContent,contents:[...this._history,h]},_=Object.assign(Object.assign({},this._requestOptions),t);let y;return this._sendPromise=this._sendPromise.then(()=>ty(this._apiKey,this.model,m,_)).then(w=>{var b;if(w.response.candidates&&w.response.candidates.length>0){this._history.push(h);const E=Object.assign({parts:[],role:"model"},(b=w.response.candidates)===null||b===void 0?void 0:b[0].content);this._history.push(E)}else{const E=Zn(w.response);E&&console.warn(`sendMessage() was unsuccessful. ${E}. Inspect response object for details.`)}y=w}),await this._sendPromise,y}async sendMessageStream(e,t={}){var r,a,o,l,c,f;await this._sendPromise;const h=hs(e),m={safetySettings:(r=this.params)===null||r===void 0?void 0:r.safetySettings,generationConfig:(a=this.params)===null||a===void 0?void 0:a.generationConfig,tools:(o=this.params)===null||o===void 0?void 0:o.tools,toolConfig:(l=this.params)===null||l===void 0?void 0:l.toolConfig,systemInstruction:(c=this.params)===null||c===void 0?void 0:c.systemInstruction,cachedContent:(f=this.params)===null||f===void 0?void 0:f.cachedContent,contents:[...this._history,h]},_=Object.assign(Object.assign({},this._requestOptions),t),y=ey(this._apiKey,this.model,m,_);return this._sendPromise=this._sendPromise.then(()=>y).catch(w=>{throw new Error(Fp)}).then(w=>w.response).then(w=>{if(w.candidates&&w.candidates.length>0){this._history.push(h);const b=Object.assign({},w.candidates[0].content);b.role||(b.role="model"),this._history.push(b)}else{const b=Zn(w);b&&console.warn(`sendMessageStream() was unsuccessful. ${b}. Inspect response object for details.`)}}).catch(w=>{w.message!==Fp&&console.error(w)}),y}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jw(s,e,t,r){return(await ws(e,Er.COUNT_TOKENS,s,!1,JSON.stringify(t),r)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $w(s,e,t,r){return(await ws(e,Er.EMBED_CONTENT,s,!1,JSON.stringify(t),r)).json()}async function Dw(s,e,t,r){const a=t.requests.map(l=>Object.assign(Object.assign({},l),{model:e}));return(await ws(e,Er.BATCH_EMBED_CONTENTS,s,!1,JSON.stringify({requests:a}),r)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bp{constructor(e,t,r={}){this.apiKey=e,this._requestOptions=r,t.model.includes("/")?this.model=t.model:this.model=`models/${t.model}`,this.generationConfig=t.generationConfig||{},this.safetySettings=t.safetySettings||[],this.tools=t.tools,this.toolConfig=t.toolConfig,this.systemInstruction=ny(t.systemInstruction),this.cachedContent=t.cachedContent}async generateContent(e,t={}){var r;const a=Up(e),o=Object.assign(Object.assign({},this._requestOptions),t);return ty(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(r=this.cachedContent)===null||r===void 0?void 0:r.name},a),o)}async generateContentStream(e,t={}){var r;const a=Up(e),o=Object.assign(Object.assign({},this._requestOptions),t);return ey(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(r=this.cachedContent)===null||r===void 0?void 0:r.name},a),o)}startChat(e){var t;return new Lw(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(t=this.cachedContent)===null||t===void 0?void 0:t.name},e),this._requestOptions)}async countTokens(e,t={}){const r=Cw(e,{model:this.model,generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:this.cachedContent}),a=Object.assign(Object.assign({},this._requestOptions),t);return jw(this.apiKey,this.model,r,a)}async embedContent(e,t={}){const r=Nw(e),a=Object.assign(Object.assign({},this._requestOptions),t);return $w(this.apiKey,this.model,r,a)}async batchEmbedContents(e,t={}){const r=Object.assign(Object.assign({},this._requestOptions),t);return Dw(this.apiKey,this.model,e,r)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mw{constructor(e){this.apiKey=e}getGenerativeModel(e,t){if(!e.model)throw new Rt("Must provide a model name. Example: genai.getGenerativeModel({ model: 'my-model-name' })");return new Bp(this.apiKey,e,t)}getGenerativeModelFromCachedContent(e,t,r){if(!e.name)throw new Yn("Cached content must contain a `name` field.");if(!e.model)throw new Yn("Cached content must contain a `model` field.");const a=["model","systemInstruction"];for(const l of a)if(t!=null&&t[l]&&e[l]&&(t==null?void 0:t[l])!==e[l]){if(l==="model"){const c=t.model.startsWith("models/")?t.model.replace("models/",""):t.model,f=e.model.startsWith("models/")?e.model.replace("models/",""):e.model;if(c===f)continue}throw new Yn(`Different value for "${l}" specified in modelParams (${t[l]}) and cachedContent (${e[l]})`)}const o=Object.assign(Object.assign({},t),{model:e.model,tools:e.tools,toolConfig:e.toolConfig,systemInstruction:e.systemInstruction,cachedContent:e});return new Bp(this.apiKey,o,r)}}class Uw{constructor(e){Object.defineProperty(this,"pageContent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.pageContent=e.pageContent!==void 0?e.pageContent.toString():"",this.metadata=e.metadata??{},this.id=e.id}}var Te;(function(s){s.assertEqual=a=>{};function e(a){}s.assertIs=e;function t(a){throw new Error}s.assertNever=t,s.arrayToEnum=a=>{const o={};for(const l of a)o[l]=l;return o},s.getValidEnumValues=a=>{const o=s.objectKeys(a).filter(c=>typeof a[a[c]]!="number"),l={};for(const c of o)l[c]=a[c];return s.objectValues(l)},s.objectValues=a=>s.objectKeys(a).map(function(o){return a[o]}),s.objectKeys=typeof Object.keys=="function"?a=>Object.keys(a):a=>{const o=[];for(const l in a)Object.prototype.hasOwnProperty.call(a,l)&&o.push(l);return o},s.find=(a,o)=>{for(const l of a)if(o(l))return l},s.isInteger=typeof Number.isInteger=="function"?a=>Number.isInteger(a):a=>typeof a=="number"&&Number.isFinite(a)&&Math.floor(a)===a;function r(a,o=" | "){return a.map(l=>typeof l=="string"?`'${l}'`:l).join(o)}s.joinValues=r,s.jsonStringifyReplacer=(a,o)=>typeof o=="bigint"?o.toString():o})(Te||(Te={}));var Hp;(function(s){s.mergeShapes=(e,t)=>({...e,...t})})(Hp||(Hp={}));const se=Te.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Wn=s=>{switch(typeof s){case"undefined":return se.undefined;case"string":return se.string;case"number":return Number.isNaN(s)?se.nan:se.number;case"boolean":return se.boolean;case"function":return se.function;case"bigint":return se.bigint;case"symbol":return se.symbol;case"object":return Array.isArray(s)?se.array:s===null?se.null:s.then&&typeof s.then=="function"&&s.catch&&typeof s.catch=="function"?se.promise:typeof Map<"u"&&s instanceof Map?se.map:typeof Set<"u"&&s instanceof Set?se.set:typeof Date<"u"&&s instanceof Date?se.date:se.object;default:return se.unknown}},V=Te.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Sn extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){const t=e||function(o){return o.message},r={_errors:[]},a=o=>{for(const l of o.issues)if(l.code==="invalid_union")l.unionErrors.map(a);else if(l.code==="invalid_return_type")a(l.returnTypeError);else if(l.code==="invalid_arguments")a(l.argumentsError);else if(l.path.length===0)r._errors.push(t(l));else{let c=r,f=0;for(;f<l.path.length;){const h=l.path[f];f===l.path.length-1?(c[h]=c[h]||{_errors:[]},c[h]._errors.push(t(l))):c[h]=c[h]||{_errors:[]},c=c[h],f++}}};return a(this),r}static assert(e){if(!(e instanceof Sn))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Te.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){const t={},r=[];for(const a of this.issues)if(a.path.length>0){const o=a.path[0];t[o]=t[o]||[],t[o].push(e(a))}else r.push(e(a));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}}Sn.create=s=>new Sn(s);const Dc=(s,e)=>{let t;switch(s.code){case V.invalid_type:s.received===se.undefined?t="Required":t=`Expected ${s.expected}, received ${s.received}`;break;case V.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(s.expected,Te.jsonStringifyReplacer)}`;break;case V.unrecognized_keys:t=`Unrecognized key(s) in object: ${Te.joinValues(s.keys,", ")}`;break;case V.invalid_union:t="Invalid input";break;case V.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${Te.joinValues(s.options)}`;break;case V.invalid_enum_value:t=`Invalid enum value. Expected ${Te.joinValues(s.options)}, received '${s.received}'`;break;case V.invalid_arguments:t="Invalid function arguments";break;case V.invalid_return_type:t="Invalid function return type";break;case V.invalid_date:t="Invalid date";break;case V.invalid_string:typeof s.validation=="object"?"includes"in s.validation?(t=`Invalid input: must include "${s.validation.includes}"`,typeof s.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${s.validation.position}`)):"startsWith"in s.validation?t=`Invalid input: must start with "${s.validation.startsWith}"`:"endsWith"in s.validation?t=`Invalid input: must end with "${s.validation.endsWith}"`:Te.assertNever(s.validation):s.validation!=="regex"?t=`Invalid ${s.validation}`:t="Invalid";break;case V.too_small:s.type==="array"?t=`Array must contain ${s.exact?"exactly":s.inclusive?"at least":"more than"} ${s.minimum} element(s)`:s.type==="string"?t=`String must contain ${s.exact?"exactly":s.inclusive?"at least":"over"} ${s.minimum} character(s)`:s.type==="number"?t=`Number must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${s.minimum}`:s.type==="bigint"?t=`Number must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${s.minimum}`:s.type==="date"?t=`Date must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(s.minimum))}`:t="Invalid input";break;case V.too_big:s.type==="array"?t=`Array must contain ${s.exact?"exactly":s.inclusive?"at most":"less than"} ${s.maximum} element(s)`:s.type==="string"?t=`String must contain ${s.exact?"exactly":s.inclusive?"at most":"under"} ${s.maximum} character(s)`:s.type==="number"?t=`Number must be ${s.exact?"exactly":s.inclusive?"less than or equal to":"less than"} ${s.maximum}`:s.type==="bigint"?t=`BigInt must be ${s.exact?"exactly":s.inclusive?"less than or equal to":"less than"} ${s.maximum}`:s.type==="date"?t=`Date must be ${s.exact?"exactly":s.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(s.maximum))}`:t="Invalid input";break;case V.custom:t="Invalid input";break;case V.invalid_intersection_types:t="Intersection results could not be merged";break;case V.not_multiple_of:t=`Number must be a multiple of ${s.multipleOf}`;break;case V.not_finite:t="Number must be finite";break;default:t=e.defaultError,Te.assertNever(s)}return{message:t}};let zw=Dc;function Fw(){return zw}const Bw=s=>{const{data:e,path:t,errorMaps:r,issueData:a}=s,o=[...t,...a.path||[]],l={...a,path:o};if(a.message!==void 0)return{...a,path:o,message:a.message};let c="";const f=r.filter(h=>!!h).slice().reverse();for(const h of f)c=h(l,{data:e,defaultError:c}).message;return{...a,path:o,message:c}};function X(s,e){const t=Fw(),r=Bw({issueData:e,data:s.data,path:s.path,errorMaps:[s.common.contextualErrorMap,s.schemaErrorMap,t,t===Dc?void 0:Dc].filter(a=>!!a)});s.common.issues.push(r)}class Lt{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){const r=[];for(const a of t){if(a.status==="aborted")return me;a.status==="dirty"&&e.dirty(),r.push(a.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,t){const r=[];for(const a of t){const o=await a.key,l=await a.value;r.push({key:o,value:l})}return Lt.mergeObjectSync(e,r)}static mergeObjectSync(e,t){const r={};for(const a of t){const{key:o,value:l}=a;if(o.status==="aborted"||l.status==="aborted")return me;o.status==="dirty"&&e.dirty(),l.status==="dirty"&&e.dirty(),o.value!=="__proto__"&&(typeof l.value<"u"||a.alwaysSet)&&(r[o.value]=l.value)}return{status:e.value,value:r}}}const me=Object.freeze({status:"aborted"}),ts=s=>({status:"dirty",value:s}),Gt=s=>({status:"valid",value:s}),Gp=s=>s.status==="aborted",qp=s=>s.status==="dirty",ni=s=>s.status==="valid",Ka=s=>typeof Promise<"u"&&s instanceof Promise;var oe;(function(s){s.errToObj=e=>typeof e=="string"?{message:e}:e||{},s.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(oe||(oe={}));class tr{constructor(e,t,r,a){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=a}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Vp=(s,e)=>{if(ni(e))return{success:!0,data:e.value};if(!s.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new Sn(s.common.issues);return this._error=t,this._error}}};function _e(s){if(!s)return{};const{errorMap:e,invalid_type_error:t,required_error:r,description:a}=s;if(e&&(t||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:a}:{errorMap:(l,c)=>{const{message:f}=s;return l.code==="invalid_enum_value"?{message:f??c.defaultError}:typeof c.data>"u"?{message:f??r??c.defaultError}:l.code!=="invalid_type"?{message:c.defaultError}:{message:f??t??c.defaultError}},description:a}}class be{get description(){return this._def.description}_getType(e){return Wn(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:Wn(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Lt,ctx:{common:e.parent.common,data:e.data,parsedType:Wn(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(Ka(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){const r={common:{issues:[],async:(t==null?void 0:t.async)??!1,contextualErrorMap:t==null?void 0:t.errorMap},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Wn(e)},a=this._parseSync({data:e,path:r.path,parent:r});return Vp(r,a)}"~validate"(e){var r,a;const t={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Wn(e)};if(!this["~standard"].async)try{const o=this._parseSync({data:e,path:[],parent:t});return ni(o)?{value:o.value}:{issues:t.common.issues}}catch(o){(a=(r=o==null?void 0:o.message)==null?void 0:r.toLowerCase())!=null&&a.includes("encountered")&&(this["~standard"].async=!0),t.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:t}).then(o=>ni(o)?{value:o.value}:{issues:t.common.issues})}async parseAsync(e,t){const r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){const r={common:{issues:[],contextualErrorMap:t==null?void 0:t.errorMap,async:!0},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Wn(e)},a=this._parse({data:e,path:r.path,parent:r}),o=await(Ka(a)?a:Promise.resolve(a));return Vp(r,o)}refine(e,t){const r=a=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(a):t;return this._refinement((a,o)=>{const l=e(a),c=()=>o.addIssue({code:V.custom,...r(a)});return typeof Promise<"u"&&l instanceof Promise?l.then(f=>f?!0:(c(),!1)):l?!0:(c(),!1)})}refinement(e,t){return this._refinement((r,a)=>e(r)?!0:(a.addIssue(typeof t=="function"?t(r,a):t),!1))}_refinement(e){return new ii({schema:this,typeName:Z.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return Xn.create(this,this._def)}nullable(){return si.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return fn.create(this)}promise(){return Xa.create(this,this._def)}or(e){return Qa.create([this,e],this._def)}and(e){return Ya.create(this,e,this._def)}transform(e){return new ii({..._e(this._def),schema:this,typeName:Z.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new zc({..._e(this._def),innerType:this,defaultValue:t,typeName:Z.ZodDefault})}brand(){return new d0({typeName:Z.ZodBranded,type:this,..._e(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new Fc({..._e(this._def),innerType:this,catchValue:t,typeName:Z.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return id.create(this,e)}readonly(){return Bc.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Hw=/^c[^\s-]{8,}$/i,Gw=/^[0-9a-z]+$/,qw=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Vw=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Zw=/^[a-z0-9_-]{21}$/i,Ww=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Kw=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Jw=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Qw="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let El;const Yw=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Xw=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,e0=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,t0=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,n0=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,r0=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,ry="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",i0=new RegExp(`^${ry}$`);function iy(s){let e="[0-5]\\d";s.precision?e=`${e}\\.\\d{${s.precision}}`:s.precision==null&&(e=`${e}(\\.\\d+)?`);const t=s.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${t}`}function s0(s){return new RegExp(`^${iy(s)}$`)}function a0(s){let e=`${ry}T${iy(s)}`;const t=[];return t.push(s.local?"Z?":"Z"),s.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function o0(s,e){return!!((e==="v4"||!e)&&Yw.test(s)||(e==="v6"||!e)&&e0.test(s))}function u0(s,e){if(!Ww.test(s))return!1;try{const[t]=s.split(".");if(!t)return!1;const r=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),a=JSON.parse(atob(r));return!(typeof a!="object"||a===null||"typ"in a&&(a==null?void 0:a.typ)!=="JWT"||!a.alg||e&&a.alg!==e)}catch{return!1}}function l0(s,e){return!!((e==="v4"||!e)&&Xw.test(s)||(e==="v6"||!e)&&t0.test(s))}class Jn extends be{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==se.string){const o=this._getOrReturnCtx(e);return X(o,{code:V.invalid_type,expected:se.string,received:o.parsedType}),me}const r=new Lt;let a;for(const o of this._def.checks)if(o.kind==="min")e.data.length<o.value&&(a=this._getOrReturnCtx(e,a),X(a,{code:V.too_small,minimum:o.value,type:"string",inclusive:!0,exact:!1,message:o.message}),r.dirty());else if(o.kind==="max")e.data.length>o.value&&(a=this._getOrReturnCtx(e,a),X(a,{code:V.too_big,maximum:o.value,type:"string",inclusive:!0,exact:!1,message:o.message}),r.dirty());else if(o.kind==="length"){const l=e.data.length>o.value,c=e.data.length<o.value;(l||c)&&(a=this._getOrReturnCtx(e,a),l?X(a,{code:V.too_big,maximum:o.value,type:"string",inclusive:!0,exact:!0,message:o.message}):c&&X(a,{code:V.too_small,minimum:o.value,type:"string",inclusive:!0,exact:!0,message:o.message}),r.dirty())}else if(o.kind==="email")Jw.test(e.data)||(a=this._getOrReturnCtx(e,a),X(a,{validation:"email",code:V.invalid_string,message:o.message}),r.dirty());else if(o.kind==="emoji")El||(El=new RegExp(Qw,"u")),El.test(e.data)||(a=this._getOrReturnCtx(e,a),X(a,{validation:"emoji",code:V.invalid_string,message:o.message}),r.dirty());else if(o.kind==="uuid")Vw.test(e.data)||(a=this._getOrReturnCtx(e,a),X(a,{validation:"uuid",code:V.invalid_string,message:o.message}),r.dirty());else if(o.kind==="nanoid")Zw.test(e.data)||(a=this._getOrReturnCtx(e,a),X(a,{validation:"nanoid",code:V.invalid_string,message:o.message}),r.dirty());else if(o.kind==="cuid")Hw.test(e.data)||(a=this._getOrReturnCtx(e,a),X(a,{validation:"cuid",code:V.invalid_string,message:o.message}),r.dirty());else if(o.kind==="cuid2")Gw.test(e.data)||(a=this._getOrReturnCtx(e,a),X(a,{validation:"cuid2",code:V.invalid_string,message:o.message}),r.dirty());else if(o.kind==="ulid")qw.test(e.data)||(a=this._getOrReturnCtx(e,a),X(a,{validation:"ulid",code:V.invalid_string,message:o.message}),r.dirty());else if(o.kind==="url")try{new URL(e.data)}catch{a=this._getOrReturnCtx(e,a),X(a,{validation:"url",code:V.invalid_string,message:o.message}),r.dirty()}else o.kind==="regex"?(o.regex.lastIndex=0,o.regex.test(e.data)||(a=this._getOrReturnCtx(e,a),X(a,{validation:"regex",code:V.invalid_string,message:o.message}),r.dirty())):o.kind==="trim"?e.data=e.data.trim():o.kind==="includes"?e.data.includes(o.value,o.position)||(a=this._getOrReturnCtx(e,a),X(a,{code:V.invalid_string,validation:{includes:o.value,position:o.position},message:o.message}),r.dirty()):o.kind==="toLowerCase"?e.data=e.data.toLowerCase():o.kind==="toUpperCase"?e.data=e.data.toUpperCase():o.kind==="startsWith"?e.data.startsWith(o.value)||(a=this._getOrReturnCtx(e,a),X(a,{code:V.invalid_string,validation:{startsWith:o.value},message:o.message}),r.dirty()):o.kind==="endsWith"?e.data.endsWith(o.value)||(a=this._getOrReturnCtx(e,a),X(a,{code:V.invalid_string,validation:{endsWith:o.value},message:o.message}),r.dirty()):o.kind==="datetime"?a0(o).test(e.data)||(a=this._getOrReturnCtx(e,a),X(a,{code:V.invalid_string,validation:"datetime",message:o.message}),r.dirty()):o.kind==="date"?i0.test(e.data)||(a=this._getOrReturnCtx(e,a),X(a,{code:V.invalid_string,validation:"date",message:o.message}),r.dirty()):o.kind==="time"?s0(o).test(e.data)||(a=this._getOrReturnCtx(e,a),X(a,{code:V.invalid_string,validation:"time",message:o.message}),r.dirty()):o.kind==="duration"?Kw.test(e.data)||(a=this._getOrReturnCtx(e,a),X(a,{validation:"duration",code:V.invalid_string,message:o.message}),r.dirty()):o.kind==="ip"?o0(e.data,o.version)||(a=this._getOrReturnCtx(e,a),X(a,{validation:"ip",code:V.invalid_string,message:o.message}),r.dirty()):o.kind==="jwt"?u0(e.data,o.alg)||(a=this._getOrReturnCtx(e,a),X(a,{validation:"jwt",code:V.invalid_string,message:o.message}),r.dirty()):o.kind==="cidr"?l0(e.data,o.version)||(a=this._getOrReturnCtx(e,a),X(a,{validation:"cidr",code:V.invalid_string,message:o.message}),r.dirty()):o.kind==="base64"?n0.test(e.data)||(a=this._getOrReturnCtx(e,a),X(a,{validation:"base64",code:V.invalid_string,message:o.message}),r.dirty()):o.kind==="base64url"?r0.test(e.data)||(a=this._getOrReturnCtx(e,a),X(a,{validation:"base64url",code:V.invalid_string,message:o.message}),r.dirty()):Te.assertNever(o);return{status:r.value,value:e.data}}_regex(e,t,r){return this.refinement(a=>e.test(a),{validation:t,code:V.invalid_string,...oe.errToObj(r)})}_addCheck(e){return new Jn({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...oe.errToObj(e)})}url(e){return this._addCheck({kind:"url",...oe.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...oe.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...oe.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...oe.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...oe.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...oe.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...oe.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...oe.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...oe.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...oe.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...oe.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...oe.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(e==null?void 0:e.offset)??!1,local:(e==null?void 0:e.local)??!1,...oe.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...oe.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...oe.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...oe.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t==null?void 0:t.position,...oe.errToObj(t==null?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...oe.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...oe.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...oe.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...oe.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...oe.errToObj(t)})}nonempty(e){return this.min(1,oe.errToObj(e))}trim(){return new Jn({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Jn({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Jn({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}Jn.create=s=>new Jn({checks:[],typeName:Z.ZodString,coerce:(s==null?void 0:s.coerce)??!1,..._e(s)});function c0(s,e){const t=(s.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,a=t>r?t:r,o=Number.parseInt(s.toFixed(a).replace(".","")),l=Number.parseInt(e.toFixed(a).replace(".",""));return o%l/10**a}class ps extends be{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==se.number){const o=this._getOrReturnCtx(e);return X(o,{code:V.invalid_type,expected:se.number,received:o.parsedType}),me}let r;const a=new Lt;for(const o of this._def.checks)o.kind==="int"?Te.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),X(r,{code:V.invalid_type,expected:"integer",received:"float",message:o.message}),a.dirty()):o.kind==="min"?(o.inclusive?e.data<o.value:e.data<=o.value)&&(r=this._getOrReturnCtx(e,r),X(r,{code:V.too_small,minimum:o.value,type:"number",inclusive:o.inclusive,exact:!1,message:o.message}),a.dirty()):o.kind==="max"?(o.inclusive?e.data>o.value:e.data>=o.value)&&(r=this._getOrReturnCtx(e,r),X(r,{code:V.too_big,maximum:o.value,type:"number",inclusive:o.inclusive,exact:!1,message:o.message}),a.dirty()):o.kind==="multipleOf"?c0(e.data,o.value)!==0&&(r=this._getOrReturnCtx(e,r),X(r,{code:V.not_multiple_of,multipleOf:o.value,message:o.message}),a.dirty()):o.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),X(r,{code:V.not_finite,message:o.message}),a.dirty()):Te.assertNever(o);return{status:a.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,oe.toString(t))}gt(e,t){return this.setLimit("min",e,!1,oe.toString(t))}lte(e,t){return this.setLimit("max",e,!0,oe.toString(t))}lt(e,t){return this.setLimit("max",e,!1,oe.toString(t))}setLimit(e,t,r,a){return new ps({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:oe.toString(a)}]})}_addCheck(e){return new ps({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:oe.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:oe.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:oe.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:oe.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:oe.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:oe.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:oe.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:oe.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:oe.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Te.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(t===null||r.value>t)&&(t=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(t)&&Number.isFinite(e)}}ps.create=s=>new ps({checks:[],typeName:Z.ZodNumber,coerce:(s==null?void 0:s.coerce)||!1,..._e(s)});class ms extends be{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==se.bigint)return this._getInvalidInput(e);let r;const a=new Lt;for(const o of this._def.checks)o.kind==="min"?(o.inclusive?e.data<o.value:e.data<=o.value)&&(r=this._getOrReturnCtx(e,r),X(r,{code:V.too_small,type:"bigint",minimum:o.value,inclusive:o.inclusive,message:o.message}),a.dirty()):o.kind==="max"?(o.inclusive?e.data>o.value:e.data>=o.value)&&(r=this._getOrReturnCtx(e,r),X(r,{code:V.too_big,type:"bigint",maximum:o.value,inclusive:o.inclusive,message:o.message}),a.dirty()):o.kind==="multipleOf"?e.data%o.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),X(r,{code:V.not_multiple_of,multipleOf:o.value,message:o.message}),a.dirty()):Te.assertNever(o);return{status:a.value,value:e.data}}_getInvalidInput(e){const t=this._getOrReturnCtx(e);return X(t,{code:V.invalid_type,expected:se.bigint,received:t.parsedType}),me}gte(e,t){return this.setLimit("min",e,!0,oe.toString(t))}gt(e,t){return this.setLimit("min",e,!1,oe.toString(t))}lte(e,t){return this.setLimit("max",e,!0,oe.toString(t))}lt(e,t){return this.setLimit("max",e,!1,oe.toString(t))}setLimit(e,t,r,a){return new ms({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:oe.toString(a)}]})}_addCheck(e){return new ms({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:oe.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:oe.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:oe.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:oe.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:oe.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}ms.create=s=>new ms({checks:[],typeName:Z.ZodBigInt,coerce:(s==null?void 0:s.coerce)??!1,..._e(s)});class Zp extends be{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==se.boolean){const r=this._getOrReturnCtx(e);return X(r,{code:V.invalid_type,expected:se.boolean,received:r.parsedType}),me}return Gt(e.data)}}Zp.create=s=>new Zp({typeName:Z.ZodBoolean,coerce:(s==null?void 0:s.coerce)||!1,..._e(s)});class Ja extends be{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==se.date){const o=this._getOrReturnCtx(e);return X(o,{code:V.invalid_type,expected:se.date,received:o.parsedType}),me}if(Number.isNaN(e.data.getTime())){const o=this._getOrReturnCtx(e);return X(o,{code:V.invalid_date}),me}const r=new Lt;let a;for(const o of this._def.checks)o.kind==="min"?e.data.getTime()<o.value&&(a=this._getOrReturnCtx(e,a),X(a,{code:V.too_small,message:o.message,inclusive:!0,exact:!1,minimum:o.value,type:"date"}),r.dirty()):o.kind==="max"?e.data.getTime()>o.value&&(a=this._getOrReturnCtx(e,a),X(a,{code:V.too_big,message:o.message,inclusive:!0,exact:!1,maximum:o.value,type:"date"}),r.dirty()):Te.assertNever(o);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Ja({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:oe.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:oe.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}}Ja.create=s=>new Ja({checks:[],coerce:(s==null?void 0:s.coerce)||!1,typeName:Z.ZodDate,..._e(s)});class Wp extends be{_parse(e){if(this._getType(e)!==se.symbol){const r=this._getOrReturnCtx(e);return X(r,{code:V.invalid_type,expected:se.symbol,received:r.parsedType}),me}return Gt(e.data)}}Wp.create=s=>new Wp({typeName:Z.ZodSymbol,..._e(s)});class Kp extends be{_parse(e){if(this._getType(e)!==se.undefined){const r=this._getOrReturnCtx(e);return X(r,{code:V.invalid_type,expected:se.undefined,received:r.parsedType}),me}return Gt(e.data)}}Kp.create=s=>new Kp({typeName:Z.ZodUndefined,..._e(s)});class Jp extends be{_parse(e){if(this._getType(e)!==se.null){const r=this._getOrReturnCtx(e);return X(r,{code:V.invalid_type,expected:se.null,received:r.parsedType}),me}return Gt(e.data)}}Jp.create=s=>new Jp({typeName:Z.ZodNull,..._e(s)});class Mc extends be{constructor(){super(...arguments),this._any=!0}_parse(e){return Gt(e.data)}}Mc.create=s=>new Mc({typeName:Z.ZodAny,..._e(s)});class Qp extends be{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Gt(e.data)}}Qp.create=s=>new Qp({typeName:Z.ZodUnknown,..._e(s)});class nr extends be{_parse(e){const t=this._getOrReturnCtx(e);return X(t,{code:V.invalid_type,expected:se.never,received:t.parsedType}),me}}nr.create=s=>new nr({typeName:Z.ZodNever,..._e(s)});class Yp extends be{_parse(e){if(this._getType(e)!==se.undefined){const r=this._getOrReturnCtx(e);return X(r,{code:V.invalid_type,expected:se.void,received:r.parsedType}),me}return Gt(e.data)}}Yp.create=s=>new Yp({typeName:Z.ZodVoid,..._e(s)});class fn extends be{_parse(e){const{ctx:t,status:r}=this._processInputParams(e),a=this._def;if(t.parsedType!==se.array)return X(t,{code:V.invalid_type,expected:se.array,received:t.parsedType}),me;if(a.exactLength!==null){const l=t.data.length>a.exactLength.value,c=t.data.length<a.exactLength.value;(l||c)&&(X(t,{code:l?V.too_big:V.too_small,minimum:c?a.exactLength.value:void 0,maximum:l?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),r.dirty())}if(a.minLength!==null&&t.data.length<a.minLength.value&&(X(t,{code:V.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),r.dirty()),a.maxLength!==null&&t.data.length>a.maxLength.value&&(X(t,{code:V.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),r.dirty()),t.common.async)return Promise.all([...t.data].map((l,c)=>a.type._parseAsync(new tr(t,l,t.path,c)))).then(l=>Lt.mergeArray(r,l));const o=[...t.data].map((l,c)=>a.type._parseSync(new tr(t,l,t.path,c)));return Lt.mergeArray(r,o)}get element(){return this._def.type}min(e,t){return new fn({...this._def,minLength:{value:e,message:oe.toString(t)}})}max(e,t){return new fn({...this._def,maxLength:{value:e,message:oe.toString(t)}})}length(e,t){return new fn({...this._def,exactLength:{value:e,message:oe.toString(t)}})}nonempty(e){return this.min(1,e)}}fn.create=(s,e)=>new fn({type:s,minLength:null,maxLength:null,exactLength:null,typeName:Z.ZodArray,..._e(e)});function Yr(s){if(s instanceof Ve){const e={};for(const t in s.shape){const r=s.shape[t];e[t]=Xn.create(Yr(r))}return new Ve({...s._def,shape:()=>e})}else return s instanceof fn?new fn({...s._def,type:Yr(s.element)}):s instanceof Xn?Xn.create(Yr(s.unwrap())):s instanceof si?si.create(Yr(s.unwrap())):s instanceof Sr?Sr.create(s.items.map(e=>Yr(e))):s}class Ve extends be{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),t=Te.objectKeys(e);return this._cached={shape:e,keys:t},this._cached}_parse(e){if(this._getType(e)!==se.object){const h=this._getOrReturnCtx(e);return X(h,{code:V.invalid_type,expected:se.object,received:h.parsedType}),me}const{status:r,ctx:a}=this._processInputParams(e),{shape:o,keys:l}=this._getCached(),c=[];if(!(this._def.catchall instanceof nr&&this._def.unknownKeys==="strip"))for(const h in a.data)l.includes(h)||c.push(h);const f=[];for(const h of l){const m=o[h],_=a.data[h];f.push({key:{status:"valid",value:h},value:m._parse(new tr(a,_,a.path,h)),alwaysSet:h in a.data})}if(this._def.catchall instanceof nr){const h=this._def.unknownKeys;if(h==="passthrough")for(const m of c)f.push({key:{status:"valid",value:m},value:{status:"valid",value:a.data[m]}});else if(h==="strict")c.length>0&&(X(a,{code:V.unrecognized_keys,keys:c}),r.dirty());else if(h!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const h=this._def.catchall;for(const m of c){const _=a.data[m];f.push({key:{status:"valid",value:m},value:h._parse(new tr(a,_,a.path,m)),alwaysSet:m in a.data})}}return a.common.async?Promise.resolve().then(async()=>{const h=[];for(const m of f){const _=await m.key,y=await m.value;h.push({key:_,value:y,alwaysSet:m.alwaysSet})}return h}).then(h=>Lt.mergeObjectSync(r,h)):Lt.mergeObjectSync(r,f)}get shape(){return this._def.shape()}strict(e){return oe.errToObj,new Ve({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,r)=>{var o,l;const a=((l=(o=this._def).errorMap)==null?void 0:l.call(o,t,r).message)??r.defaultError;return t.code==="unrecognized_keys"?{message:oe.errToObj(e).message??a}:{message:a}}}:{}})}strip(){return new Ve({...this._def,unknownKeys:"strip"})}passthrough(){return new Ve({...this._def,unknownKeys:"passthrough"})}extend(e){return new Ve({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Ve({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:Z.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new Ve({...this._def,catchall:e})}pick(e){const t={};for(const r of Te.objectKeys(e))e[r]&&this.shape[r]&&(t[r]=this.shape[r]);return new Ve({...this._def,shape:()=>t})}omit(e){const t={};for(const r of Te.objectKeys(this.shape))e[r]||(t[r]=this.shape[r]);return new Ve({...this._def,shape:()=>t})}deepPartial(){return Yr(this)}partial(e){const t={};for(const r of Te.objectKeys(this.shape)){const a=this.shape[r];e&&!e[r]?t[r]=a:t[r]=a.optional()}return new Ve({...this._def,shape:()=>t})}required(e){const t={};for(const r of Te.objectKeys(this.shape))if(e&&!e[r])t[r]=this.shape[r];else{let o=this.shape[r];for(;o instanceof Xn;)o=o._def.innerType;t[r]=o}return new Ve({...this._def,shape:()=>t})}keyof(){return sy(Te.objectKeys(this.shape))}}Ve.create=(s,e)=>new Ve({shape:()=>s,unknownKeys:"strip",catchall:nr.create(),typeName:Z.ZodObject,..._e(e)});Ve.strictCreate=(s,e)=>new Ve({shape:()=>s,unknownKeys:"strict",catchall:nr.create(),typeName:Z.ZodObject,..._e(e)});Ve.lazycreate=(s,e)=>new Ve({shape:s,unknownKeys:"strip",catchall:nr.create(),typeName:Z.ZodObject,..._e(e)});class Qa extends be{_parse(e){const{ctx:t}=this._processInputParams(e),r=this._def.options;function a(o){for(const c of o)if(c.result.status==="valid")return c.result;for(const c of o)if(c.result.status==="dirty")return t.common.issues.push(...c.ctx.common.issues),c.result;const l=o.map(c=>new Sn(c.ctx.common.issues));return X(t,{code:V.invalid_union,unionErrors:l}),me}if(t.common.async)return Promise.all(r.map(async o=>{const l={...t,common:{...t.common,issues:[]},parent:null};return{result:await o._parseAsync({data:t.data,path:t.path,parent:l}),ctx:l}})).then(a);{let o;const l=[];for(const f of r){const h={...t,common:{...t.common,issues:[]},parent:null},m=f._parseSync({data:t.data,path:t.path,parent:h});if(m.status==="valid")return m;m.status==="dirty"&&!o&&(o={result:m,ctx:h}),h.common.issues.length&&l.push(h.common.issues)}if(o)return t.common.issues.push(...o.ctx.common.issues),o.result;const c=l.map(f=>new Sn(f));return X(t,{code:V.invalid_union,unionErrors:c}),me}}get options(){return this._def.options}}Qa.create=(s,e)=>new Qa({options:s,typeName:Z.ZodUnion,..._e(e)});function Uc(s,e){const t=Wn(s),r=Wn(e);if(s===e)return{valid:!0,data:s};if(t===se.object&&r===se.object){const a=Te.objectKeys(e),o=Te.objectKeys(s).filter(c=>a.indexOf(c)!==-1),l={...s,...e};for(const c of o){const f=Uc(s[c],e[c]);if(!f.valid)return{valid:!1};l[c]=f.data}return{valid:!0,data:l}}else if(t===se.array&&r===se.array){if(s.length!==e.length)return{valid:!1};const a=[];for(let o=0;o<s.length;o++){const l=s[o],c=e[o],f=Uc(l,c);if(!f.valid)return{valid:!1};a.push(f.data)}return{valid:!0,data:a}}else return t===se.date&&r===se.date&&+s==+e?{valid:!0,data:s}:{valid:!1}}class Ya extends be{_parse(e){const{status:t,ctx:r}=this._processInputParams(e),a=(o,l)=>{if(Gp(o)||Gp(l))return me;const c=Uc(o.value,l.value);return c.valid?((qp(o)||qp(l))&&t.dirty(),{status:t.value,value:c.data}):(X(r,{code:V.invalid_intersection_types}),me)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([o,l])=>a(o,l)):a(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}Ya.create=(s,e,t)=>new Ya({left:s,right:e,typeName:Z.ZodIntersection,..._e(t)});class Sr extends be{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==se.array)return X(r,{code:V.invalid_type,expected:se.array,received:r.parsedType}),me;if(r.data.length<this._def.items.length)return X(r,{code:V.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),me;!this._def.rest&&r.data.length>this._def.items.length&&(X(r,{code:V.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const o=[...r.data].map((l,c)=>{const f=this._def.items[c]||this._def.rest;return f?f._parse(new tr(r,l,r.path,c)):null}).filter(l=>!!l);return r.common.async?Promise.all(o).then(l=>Lt.mergeArray(t,l)):Lt.mergeArray(t,o)}get items(){return this._def.items}rest(e){return new Sr({...this._def,rest:e})}}Sr.create=(s,e)=>{if(!Array.isArray(s))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Sr({items:s,typeName:Z.ZodTuple,rest:null,..._e(e)})};class Xp extends be{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==se.map)return X(r,{code:V.invalid_type,expected:se.map,received:r.parsedType}),me;const a=this._def.keyType,o=this._def.valueType,l=[...r.data.entries()].map(([c,f],h)=>({key:a._parse(new tr(r,c,r.path,[h,"key"])),value:o._parse(new tr(r,f,r.path,[h,"value"]))}));if(r.common.async){const c=new Map;return Promise.resolve().then(async()=>{for(const f of l){const h=await f.key,m=await f.value;if(h.status==="aborted"||m.status==="aborted")return me;(h.status==="dirty"||m.status==="dirty")&&t.dirty(),c.set(h.value,m.value)}return{status:t.value,value:c}})}else{const c=new Map;for(const f of l){const h=f.key,m=f.value;if(h.status==="aborted"||m.status==="aborted")return me;(h.status==="dirty"||m.status==="dirty")&&t.dirty(),c.set(h.value,m.value)}return{status:t.value,value:c}}}}Xp.create=(s,e,t)=>new Xp({valueType:e,keyType:s,typeName:Z.ZodMap,..._e(t)});class gs extends be{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==se.set)return X(r,{code:V.invalid_type,expected:se.set,received:r.parsedType}),me;const a=this._def;a.minSize!==null&&r.data.size<a.minSize.value&&(X(r,{code:V.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),t.dirty()),a.maxSize!==null&&r.data.size>a.maxSize.value&&(X(r,{code:V.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),t.dirty());const o=this._def.valueType;function l(f){const h=new Set;for(const m of f){if(m.status==="aborted")return me;m.status==="dirty"&&t.dirty(),h.add(m.value)}return{status:t.value,value:h}}const c=[...r.data.values()].map((f,h)=>o._parse(new tr(r,f,r.path,h)));return r.common.async?Promise.all(c).then(f=>l(f)):l(c)}min(e,t){return new gs({...this._def,minSize:{value:e,message:oe.toString(t)}})}max(e,t){return new gs({...this._def,maxSize:{value:e,message:oe.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}gs.create=(s,e)=>new gs({valueType:s,minSize:null,maxSize:null,typeName:Z.ZodSet,..._e(e)});class em extends be{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}em.create=(s,e)=>new em({getter:s,typeName:Z.ZodLazy,..._e(e)});class tm extends be{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return X(t,{received:t.data,code:V.invalid_literal,expected:this._def.value}),me}return{status:"valid",value:e.data}}get value(){return this._def.value}}tm.create=(s,e)=>new tm({value:s,typeName:Z.ZodLiteral,..._e(e)});function sy(s,e){return new ri({values:s,typeName:Z.ZodEnum,..._e(e)})}class ri extends be{_parse(e){if(typeof e.data!="string"){const t=this._getOrReturnCtx(e),r=this._def.values;return X(t,{expected:Te.joinValues(r),received:t.parsedType,code:V.invalid_type}),me}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const t=this._getOrReturnCtx(e),r=this._def.values;return X(t,{received:t.data,code:V.invalid_enum_value,options:r}),me}return Gt(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return ri.create(e,{...this._def,...t})}exclude(e,t=this._def){return ri.create(this.options.filter(r=>!e.includes(r)),{...this._def,...t})}}ri.create=sy;class nm extends be{_parse(e){const t=Te.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==se.string&&r.parsedType!==se.number){const a=Te.objectValues(t);return X(r,{expected:Te.joinValues(a),received:r.parsedType,code:V.invalid_type}),me}if(this._cache||(this._cache=new Set(Te.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const a=Te.objectValues(t);return X(r,{received:r.data,code:V.invalid_enum_value,options:a}),me}return Gt(e.data)}get enum(){return this._def.values}}nm.create=(s,e)=>new nm({values:s,typeName:Z.ZodNativeEnum,..._e(e)});class Xa extends be{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==se.promise&&t.common.async===!1)return X(t,{code:V.invalid_type,expected:se.promise,received:t.parsedType}),me;const r=t.parsedType===se.promise?t.data:Promise.resolve(t.data);return Gt(r.then(a=>this._def.type.parseAsync(a,{path:t.path,errorMap:t.common.contextualErrorMap})))}}Xa.create=(s,e)=>new Xa({type:s,typeName:Z.ZodPromise,..._e(e)});class ii extends be{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Z.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:r}=this._processInputParams(e),a=this._def.effect||null,o={addIssue:l=>{X(r,l),l.fatal?t.abort():t.dirty()},get path(){return r.path}};if(o.addIssue=o.addIssue.bind(o),a.type==="preprocess"){const l=a.transform(r.data,o);if(r.common.async)return Promise.resolve(l).then(async c=>{if(t.value==="aborted")return me;const f=await this._def.schema._parseAsync({data:c,path:r.path,parent:r});return f.status==="aborted"?me:f.status==="dirty"||t.value==="dirty"?ts(f.value):f});{if(t.value==="aborted")return me;const c=this._def.schema._parseSync({data:l,path:r.path,parent:r});return c.status==="aborted"?me:c.status==="dirty"||t.value==="dirty"?ts(c.value):c}}if(a.type==="refinement"){const l=c=>{const f=a.refinement(c,o);if(r.common.async)return Promise.resolve(f);if(f instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return c};if(r.common.async===!1){const c=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return c.status==="aborted"?me:(c.status==="dirty"&&t.dirty(),l(c.value),{status:t.value,value:c.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(c=>c.status==="aborted"?me:(c.status==="dirty"&&t.dirty(),l(c.value).then(()=>({status:t.value,value:c.value}))))}if(a.type==="transform")if(r.common.async===!1){const l=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!ni(l))return me;const c=a.transform(l.value,o);if(c instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:c}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(l=>ni(l)?Promise.resolve(a.transform(l.value,o)).then(c=>({status:t.value,value:c})):me);Te.assertNever(a)}}ii.create=(s,e,t)=>new ii({schema:s,typeName:Z.ZodEffects,effect:e,..._e(t)});ii.createWithPreprocess=(s,e,t)=>new ii({schema:e,effect:{type:"preprocess",transform:s},typeName:Z.ZodEffects,..._e(t)});class Xn extends be{_parse(e){return this._getType(e)===se.undefined?Gt(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Xn.create=(s,e)=>new Xn({innerType:s,typeName:Z.ZodOptional,..._e(e)});class si extends be{_parse(e){return this._getType(e)===se.null?Gt(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}si.create=(s,e)=>new si({innerType:s,typeName:Z.ZodNullable,..._e(e)});class zc extends be{_parse(e){const{ctx:t}=this._processInputParams(e);let r=t.data;return t.parsedType===se.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}zc.create=(s,e)=>new zc({innerType:s,typeName:Z.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,..._e(e)});class Fc extends be{_parse(e){const{ctx:t}=this._processInputParams(e),r={...t,common:{...t.common,issues:[]}},a=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return Ka(a)?a.then(o=>({status:"valid",value:o.status==="valid"?o.value:this._def.catchValue({get error(){return new Sn(r.common.issues)},input:r.data})})):{status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new Sn(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}Fc.create=(s,e)=>new Fc({innerType:s,typeName:Z.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,..._e(e)});class rm extends be{_parse(e){if(this._getType(e)!==se.nan){const r=this._getOrReturnCtx(e);return X(r,{code:V.invalid_type,expected:se.nan,received:r.parsedType}),me}return{status:"valid",value:e.data}}}rm.create=s=>new rm({typeName:Z.ZodNaN,..._e(s)});class d0 extends be{_parse(e){const{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}}class id extends be{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const o=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return o.status==="aborted"?me:o.status==="dirty"?(t.dirty(),ts(o.value)):this._def.out._parseAsync({data:o.value,path:r.path,parent:r})})();{const a=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?me:a.status==="dirty"?(t.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:r.path,parent:r})}}static create(e,t){return new id({in:e,out:t,typeName:Z.ZodPipeline})}}class Bc extends be{_parse(e){const t=this._def.innerType._parse(e),r=a=>(ni(a)&&(a.value=Object.freeze(a.value)),a);return Ka(t)?t.then(a=>r(a)):r(t)}unwrap(){return this._def.innerType}}Bc.create=(s,e)=>new Bc({innerType:s,typeName:Z.ZodReadonly,..._e(e)});var Z;(function(s){s.ZodString="ZodString",s.ZodNumber="ZodNumber",s.ZodNaN="ZodNaN",s.ZodBigInt="ZodBigInt",s.ZodBoolean="ZodBoolean",s.ZodDate="ZodDate",s.ZodSymbol="ZodSymbol",s.ZodUndefined="ZodUndefined",s.ZodNull="ZodNull",s.ZodAny="ZodAny",s.ZodUnknown="ZodUnknown",s.ZodNever="ZodNever",s.ZodVoid="ZodVoid",s.ZodArray="ZodArray",s.ZodObject="ZodObject",s.ZodUnion="ZodUnion",s.ZodDiscriminatedUnion="ZodDiscriminatedUnion",s.ZodIntersection="ZodIntersection",s.ZodTuple="ZodTuple",s.ZodRecord="ZodRecord",s.ZodMap="ZodMap",s.ZodSet="ZodSet",s.ZodFunction="ZodFunction",s.ZodLazy="ZodLazy",s.ZodLiteral="ZodLiteral",s.ZodEnum="ZodEnum",s.ZodEffects="ZodEffects",s.ZodNativeEnum="ZodNativeEnum",s.ZodOptional="ZodOptional",s.ZodNullable="ZodNullable",s.ZodDefault="ZodDefault",s.ZodCatch="ZodCatch",s.ZodPromise="ZodPromise",s.ZodBranded="ZodBranded",s.ZodPipeline="ZodPipeline",s.ZodReadonly="ZodReadonly"})(Z||(Z={}));const f0=Jn.create,im=Mc.create;nr.create;fn.create;const h0=Ve.create;Qa.create;Ya.create;Sr.create;ri.create;Xa.create;Xn.create;si.create;var Qi={exports:{}},Sl={},Ol,sm;function p0(){if(sm)return Ol;sm=1;function s(e,t){typeof t=="boolean"&&(t={forever:t}),this._originalTimeouts=JSON.parse(JSON.stringify(e)),this._timeouts=e,this._options=t||{},this._maxRetryTime=t&&t.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}return Ol=s,s.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)},s.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null},s.prototype.retry=function(e){if(this._timeout&&clearTimeout(this._timeout),!e)return!1;var t=new Date().getTime();if(e&&t-this._operationStart>=this._maxRetryTime)return this._errors.push(e),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(e);var r=this._timeouts.shift();if(r===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),r=this._cachedTimeouts.slice(-1);else return!1;var a=this;return this._timer=setTimeout(function(){a._attempts++,a._operationTimeoutCb&&(a._timeout=setTimeout(function(){a._operationTimeoutCb(a._attempts)},a._operationTimeout),a._options.unref&&a._timeout.unref()),a._fn(a._attempts)},r),this._options.unref&&this._timer.unref(),!0},s.prototype.attempt=function(e,t){this._fn=e,t&&(t.timeout&&(this._operationTimeout=t.timeout),t.cb&&(this._operationTimeoutCb=t.cb));var r=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){r._operationTimeoutCb()},r._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)},s.prototype.try=function(e){console.log("Using RetryOperation.try() is deprecated"),this.attempt(e)},s.prototype.start=function(e){console.log("Using RetryOperation.start() is deprecated"),this.attempt(e)},s.prototype.start=s.prototype.try,s.prototype.errors=function(){return this._errors},s.prototype.attempts=function(){return this._attempts},s.prototype.mainError=function(){if(this._errors.length===0)return null;for(var e={},t=null,r=0,a=0;a<this._errors.length;a++){var o=this._errors[a],l=o.message,c=(e[l]||0)+1;e[l]=c,c>=r&&(t=o,r=c)}return t},Ol}var am;function m0(){return am||(am=1,(function(s){var e=p0();s.operation=function(t){var r=s.timeouts(t);return new e(r,{forever:t&&(t.forever||t.retries===1/0),unref:t&&t.unref,maxRetryTime:t&&t.maxRetryTime})},s.timeouts=function(t){if(t instanceof Array)return[].concat(t);var r={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var a in t)r[a]=t[a];if(r.minTimeout>r.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var o=[],l=0;l<r.retries;l++)o.push(this.createTimeout(l,r));return t&&t.forever&&!o.length&&o.push(this.createTimeout(l,r)),o.sort(function(c,f){return c-f}),o},s.createTimeout=function(t,r){var a=r.randomize?Math.random()+1:1,o=Math.round(a*Math.max(r.minTimeout,1)*Math.pow(r.factor,t));return o=Math.min(o,r.maxTimeout),o},s.wrap=function(t,r,a){if(r instanceof Array&&(a=r,r=null),!a){a=[];for(var o in t)typeof t[o]=="function"&&a.push(o)}for(var l=0;l<a.length;l++){var c=a[l],f=t[c];t[c]=(function(m){var _=s.operation(r),y=Array.prototype.slice.call(arguments,1),w=y.pop();y.push(function(b){_.retry(b)||(b&&(arguments[0]=_.mainError()),w.apply(this,arguments))}),_.attempt(function(){m.apply(t,y)})}).bind(t,f),t[c].options=r}}})(Sl)),Sl}var kl,om;function g0(){return om||(om=1,kl=m0()),kl}var um;function y0(){if(um)return Qi.exports;um=1;const s=g0(),e=["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed"];class t extends Error{constructor(c){super(),c instanceof Error?(this.originalError=c,{message:c}=c):(this.originalError=new Error(c),this.originalError.stack=this.stack),this.name="AbortError",this.message=c}}const r=(l,c,f)=>{const h=f.retries-(c-1);return l.attemptNumber=c,l.retriesLeft=h,l},a=l=>e.includes(l),o=(l,c)=>new Promise((f,h)=>{c={onFailedAttempt:()=>{},retries:10,...c};const m=s.operation(c);m.attempt(async _=>{try{f(await l(_))}catch(y){if(!(y instanceof Error)){h(new TypeError(`Non-error was thrown: "${y}". You should only throw errors.`));return}if(y instanceof t)m.stop(),h(y.originalError);else if(y instanceof TypeError&&!a(y.message))m.stop(),h(y);else{r(y,_,c);try{await c.onFailedAttempt(y)}catch(w){h(w);return}m.retry(y)||h(m.mainError())}}})});return Qi.exports=o,Qi.exports.default=o,Qi.exports.AbortError=t,Qi.exports}var _0=y0();const Hc=Or(_0),v0=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i;function as(s){return typeof s=="string"&&v0.test(s)}function w0(s){if(!as(s))throw TypeError("Invalid UUID");var e,t=new Uint8Array(16);return t[0]=(e=parseInt(s.slice(0,8),16))>>>24,t[1]=e>>>16&255,t[2]=e>>>8&255,t[3]=e&255,t[4]=(e=parseInt(s.slice(9,13),16))>>>8,t[5]=e&255,t[6]=(e=parseInt(s.slice(14,18),16))>>>8,t[7]=e&255,t[8]=(e=parseInt(s.slice(19,23),16))>>>8,t[9]=e&255,t[10]=(e=parseInt(s.slice(24,36),16))/1099511627776&255,t[11]=e/4294967296&255,t[12]=e>>>24&255,t[13]=e>>>16&255,t[14]=e>>>8&255,t[15]=e&255,t}var st=[];for(var Tl=0;Tl<256;++Tl)st.push((Tl+256).toString(16).slice(1));function sd(s,e=0){return(st[s[e+0]]+st[s[e+1]]+st[s[e+2]]+st[s[e+3]]+"-"+st[s[e+4]]+st[s[e+5]]+"-"+st[s[e+6]]+st[s[e+7]]+"-"+st[s[e+8]]+st[s[e+9]]+"-"+st[s[e+10]]+st[s[e+11]]+st[s[e+12]]+st[s[e+13]]+st[s[e+14]]+st[s[e+15]]).toLowerCase()}var ja,b0=new Uint8Array(16);function ay(){if(!ja&&(ja=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!ja))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ja(b0)}function E0(s){s=unescape(encodeURIComponent(s));for(var e=[],t=0;t<s.length;++t)e.push(s.charCodeAt(t));return e}var S0="6ba7b810-9dad-11d1-80b4-00c04fd430c8",O0="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function k0(s,e,t){function r(a,o,l,c){var f;if(typeof a=="string"&&(a=E0(a)),typeof o=="string"&&(o=w0(o)),((f=o)===null||f===void 0?void 0:f.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var h=new Uint8Array(16+a.length);if(h.set(o),h.set(a,o.length),h=t(h),h[6]=h[6]&15|e,h[8]=h[8]&63|128,l){c=c||0;for(var m=0;m<16;++m)l[c+m]=h[m];return l}return sd(h)}try{r.name=s}catch{}return r.DNS=S0,r.URL=O0,r}var T0=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const lm={randomUUID:T0};function Tt(s,e,t){if(lm.randomUUID&&!s)return lm.randomUUID();s=s||{};var r=s.random||(s.rng||ay)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,sd(r)}function x0(s,e,t,r){switch(s){case 0:return e&t^~e&r;case 1:return e^t^r;case 2:return e&t^e&r^t&r;case 3:return e^t^r}}function xl(s,e){return s<<e|s>>>32-e}function R0(s){var e=[1518500249,1859775393,2400959708,3395469782],t=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof s=="string"){var r=unescape(encodeURIComponent(s));s=[];for(var a=0;a<r.length;++a)s.push(r.charCodeAt(a))}else Array.isArray(s)||(s=Array.prototype.slice.call(s));s.push(128);for(var o=s.length/4+2,l=Math.ceil(o/16),c=new Array(l),f=0;f<l;++f){for(var h=new Uint32Array(16),m=0;m<16;++m)h[m]=s[f*64+m*4]<<24|s[f*64+m*4+1]<<16|s[f*64+m*4+2]<<8|s[f*64+m*4+3];c[f]=h}c[l-1][14]=(s.length-1)*8/Math.pow(2,32),c[l-1][14]=Math.floor(c[l-1][14]),c[l-1][15]=(s.length-1)*8&4294967295;for(var _=0;_<l;++_){for(var y=new Uint32Array(80),w=0;w<16;++w)y[w]=c[_][w];for(var b=16;b<80;++b)y[b]=xl(y[b-3]^y[b-8]^y[b-14]^y[b-16],1);for(var E=t[0],S=t[1],O=t[2],R=t[3],T=t[4],$=0;$<80;++$){var P=Math.floor($/20),z=xl(E,5)+x0(P,S,O,R)+T+e[P]+y[$]>>>0;T=R,R=O,O=xl(S,30)>>>0,S=E,E=z}t[0]=t[0]+E>>>0,t[1]=t[1]+S>>>0,t[2]=t[2]+O>>>0,t[3]=t[3]+R>>>0,t[4]=t[4]+T>>>0}return[t[0]>>24&255,t[0]>>16&255,t[0]>>8&255,t[0]&255,t[1]>>24&255,t[1]>>16&255,t[1]>>8&255,t[1]&255,t[2]>>24&255,t[2]>>16&255,t[2]>>8&255,t[2]&255,t[3]>>24&255,t[3]>>16&255,t[3]>>8&255,t[3]&255,t[4]>>24&255,t[4]>>16&255,t[4]>>8&255,t[4]&255]}var ns=k0("v5",80,R0),cm=null,dm=null,Yt=0;function I0(s,e,t){s=s||{};var r=0,a=new Uint8Array(16),o=s.random||(s.rng||ay)(),l=s.msecs!==void 0?s.msecs:Date.now(),c=s.seq!==void 0?s.seq:null,f=dm,h=cm;return l>Yt&&s.msecs===void 0&&(Yt=l,c!==null&&(f=null,h=null)),c!==null&&(c>2147483647&&(c=2147483647),f=c>>>19&4095,h=c&524287),(f===null||h===null)&&(f=o[6]&127,f=f<<8|o[7],h=o[8]&63,h=h<<8|o[9],h=h<<5|o[10]>>>3),l+1e4>Yt&&c===null?++h>524287&&(h=0,++f>4095&&(f=0,Yt++)):Yt=l,dm=f,cm=h,a[r++]=Yt/1099511627776&255,a[r++]=Yt/4294967296&255,a[r++]=Yt/16777216&255,a[r++]=Yt/65536&255,a[r++]=Yt/256&255,a[r++]=Yt&255,a[r++]=f>>>4&15|112,a[r++]=f&255,a[r++]=h>>>13&63|128,a[r++]=h>>>5&255,a[r++]=h<<3&255|o[10]&7,a[r++]=o[11],a[r++]=o[12],a[r++]=o[13],a[r++]=o[14],a[r++]=o[15],e||sd(a)}let C0=class{getStore(){}run(e,t){return t()}};const Rl=Symbol.for("ls:tracing_async_local_storage"),N0=new C0;let A0=class{getInstance(){return globalThis[Rl]??N0}initializeGlobalInstance(e){globalThis[Rl]===void 0&&(globalThis[Rl]=e)}};const P0=new A0;function L0(s=!1){const e=P0.getInstance().getStore();if(!s&&e===void 0)throw new Error(`Could not get the current run tree.

Please make sure you are calling this method within a traceable function and that tracing is enabled.`);return e}function ad(s){return typeof s=="function"&&"langsmith:traceable"in s}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2022 Joachim Wester
 * MIT licensed
 */const j0=Object.prototype.hasOwnProperty;function $0(s,e){return j0.call(s,e)}function D0(s){if(Array.isArray(s)){const t=new Array(s.length);for(let r=0;r<t.length;r++)t[r]=""+r;return t}if(Object.keys)return Object.keys(s);let e=[];for(let t in s)$0(s,t)&&e.push(t);return e}function ai(s){switch(typeof s){case"object":return JSON.parse(JSON.stringify(s));case"undefined":return null;default:return s}}function Gc(s){let e=0;const t=s.length;let r;for(;e<t;){if(r=s.charCodeAt(e),r>=48&&r<=57){e++;continue}return!1}return!0}function M0(s){return s.replace(/~1/g,"/").replace(/~0/g,"~")}function qc(s){if(s===void 0)return!0;if(s){if(Array.isArray(s)){for(let t=0,r=s.length;t<r;t++)if(qc(s[t]))return!0}else if(typeof s=="object"){const t=D0(s),r=t.length;for(var e=0;e<r;e++)if(qc(s[t[e]]))return!0}}return!1}function fm(s,e){const t=[s];for(const r in e){const a=typeof e[r]=="object"?JSON.stringify(e[r],null,2):e[r];typeof a<"u"&&t.push(`${r}: ${a}`)}return t.join(`
`)}class U0 extends Error{constructor(e,t,r,a,o){super(fm(e,{name:t,index:r,operation:a,tree:o})),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"index",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"operation",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"tree",{enumerable:!0,configurable:!0,writable:!0,value:o}),Object.setPrototypeOf(this,new.target.prototype),this.message=fm(e,{name:t,index:r,operation:a,tree:o})}}const Ze=U0,Xr={add:function(s,e,t){return s[e]=this.value,{newDocument:t}},remove:function(s,e,t){var r=s[e];return delete s[e],{newDocument:t,removed:r}},replace:function(s,e,t){var r=s[e];return s[e]=this.value,{newDocument:t,removed:r}},move:function(s,e,t){let r=Vc(t,this.path);r&&(r=ai(r));const a=os(t,{op:"remove",path:this.from}).removed;return os(t,{op:"add",path:this.path,value:a}),{newDocument:t,removed:r}},copy:function(s,e,t){const r=Vc(t,this.from);return os(t,{op:"add",path:this.path,value:ai(r)}),{newDocument:t}},test:function(s,e,t){return{newDocument:t,test:to(s[e],this.value)}},_get:function(s,e,t){return this.value=s[e],{newDocument:t}}};var z0={add:function(s,e,t){return Gc(e)?s.splice(e,0,this.value):s[e]=this.value,{newDocument:t,index:e}},remove:function(s,e,t){var r=s.splice(e,1);return{newDocument:t,removed:r[0]}},replace:function(s,e,t){var r=s[e];return s[e]=this.value,{newDocument:t,removed:r}},move:Xr.move,copy:Xr.copy,test:Xr.test,_get:Xr._get};function Vc(s,e){if(e=="")return s;var t={op:"_get",path:e};return os(s,t),t.value}function os(s,e,t=!1,r=!0,a=!0,o=0){if(t&&(typeof t=="function"?t(e,0,s,e.path):Zc(e,0)),e.path===""){let l={newDocument:s};if(e.op==="add")return l.newDocument=e.value,l;if(e.op==="replace")return l.newDocument=e.value,l.removed=s,l;if(e.op==="move"||e.op==="copy")return l.newDocument=Vc(s,e.from),e.op==="move"&&(l.removed=s),l;if(e.op==="test"){if(l.test=to(s,e.value),l.test===!1)throw new Ze("Test operation failed","TEST_OPERATION_FAILED",o,e,s);return l.newDocument=s,l}else{if(e.op==="remove")return l.removed=s,l.newDocument=null,l;if(e.op==="_get")return e.value=s,l;if(t)throw new Ze("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",o,e,s);return l}}else{r||(s=ai(s));const c=(e.path||"").split("/");let f=s,h=1,m=c.length,_,y,w;for(typeof t=="function"?w=t:w=Zc;;){if(y=c[h],y&&y.indexOf("~")!=-1&&(y=M0(y)),a&&(y=="__proto__"||y=="prototype"&&h>0&&c[h-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(t&&_===void 0&&(f[y]===void 0?_=c.slice(0,h).join("/"):h==m-1&&(_=e.path),_!==void 0&&w(e,0,s,_)),h++,Array.isArray(f)){if(y==="-")y=f.length;else{if(t&&!Gc(y))throw new Ze("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",o,e,s);Gc(y)&&(y=~~y)}if(h>=m){if(t&&e.op==="add"&&y>f.length)throw new Ze("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",o,e,s);const b=z0[e.op].call(e,f,y,s);if(b.test===!1)throw new Ze("Test operation failed","TEST_OPERATION_FAILED",o,e,s);return b}}else if(h>=m){const b=Xr[e.op].call(e,f,y,s);if(b.test===!1)throw new Ze("Test operation failed","TEST_OPERATION_FAILED",o,e,s);return b}if(f=f[y],t&&h<m&&(!f||typeof f!="object"))throw new Ze("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",o,e,s)}}}function eo(s,e,t,r=!0,a=!0){if(t&&!Array.isArray(e))throw new Ze("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(s=ai(s));const o=new Array(e.length);for(let l=0,c=e.length;l<c;l++)o[l]=os(s,e[l],t,!0,a,l),s=o[l].newDocument;return o.newDocument=s,o}function Zc(s,e,t,r){if(typeof s!="object"||s===null||Array.isArray(s))throw new Ze("Operation is not an object","OPERATION_NOT_AN_OBJECT",e,s,t);if(Xr[s.op]){if(typeof s.path!="string")throw new Ze("Operation `path` property is not a string","OPERATION_PATH_INVALID",e,s,t);if(s.path.indexOf("/")!==0&&s.path.length>0)throw new Ze('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",e,s,t);if((s.op==="move"||s.op==="copy")&&typeof s.from!="string")throw new Ze("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",e,s,t);if((s.op==="add"||s.op==="replace"||s.op==="test")&&s.value===void 0)throw new Ze("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",e,s,t);if((s.op==="add"||s.op==="replace"||s.op==="test")&&qc(s.value))throw new Ze("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",e,s,t);if(t){if(s.op=="add"){var a=s.path.split("/").length,o=r.split("/").length;if(a!==o+1&&a!==o)throw new Ze("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",e,s,t)}else if(s.op==="replace"||s.op==="remove"||s.op==="_get"){if(s.path!==r)throw new Ze("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",e,s,t)}else if(s.op==="move"||s.op==="copy"){var l={op:"_get",path:s.from,value:void 0},c=F0([l],t);if(c&&c.name==="OPERATION_PATH_UNRESOLVABLE")throw new Ze("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",e,s,t)}}}else throw new Ze("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",e,s,t)}function F0(s,e,t){try{if(!Array.isArray(s))throw new Ze("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(e)eo(ai(e),ai(s),t||!0);else{t=t||Zc;for(var r=0;r<s.length;r++)t(s[r],r,e,void 0)}}catch(a){if(a instanceof Ze)return a;throw a}}function to(s,e){if(s===e)return!0;if(s&&e&&typeof s=="object"&&typeof e=="object"){var t=Array.isArray(s),r=Array.isArray(e),a,o,l;if(t&&r){if(o=s.length,o!=e.length)return!1;for(a=o;a--!==0;)if(!to(s[a],e[a]))return!1;return!0}if(t!=r)return!1;var c=Object.keys(s);if(o=c.length,o!==Object.keys(e).length)return!1;for(a=o;a--!==0;)if(!e.hasOwnProperty(c[a]))return!1;for(a=o;a--!==0;)if(l=c[a],!to(s[l],e[l]))return!1;return!0}return s!==s&&e!==e}const B0="gen_ai.operation.name",H0="gen_ai.system",hm="gen_ai.request.model",G0="gen_ai.response.model",pm="gen_ai.usage.input_tokens",mm="gen_ai.usage.output_tokens",gm="gen_ai.usage.total_tokens",q0="gen_ai.request.max_tokens",V0="gen_ai.request.temperature",Z0="gen_ai.request.top_p",W0="gen_ai.request.frequency_penalty",K0="gen_ai.request.presence_penalty",J0="gen_ai.response.finish_reasons",Q0="gen_ai.prompt",Y0="gen_ai.completion",X0="gen_ai.request.extra_query",eb="gen_ai.request.extra_body",tb="gen_ai.serialized.name",nb="gen_ai.serialized.signature",rb="gen_ai.serialized.doc",ib="gen_ai.response.id",sb="gen_ai.response.service_tier",ab="gen_ai.response.system_fingerprint",ob="gen_ai.usage.input_token_details",ub="gen_ai.usage.output_token_details",lb="langsmith.trace.session_id",cb="langsmith.trace.session_name",db="langsmith.span.kind",fb="langsmith.trace.name",hb="langsmith.metadata",ym="langsmith.span.tags",pb="langsmith.request.streaming",mb="langsmith.request.headers",gb=(...s)=>fetch(...s),oy=Symbol.for("ls:fetch_implementation"),yb=()=>{const s=globalThis[oy];return s?typeof s=="function"&&"Headers"in s&&"Request"in s&&"Response"in s:!1},_b=s=>async(...e)=>{if(s||xt("DEBUG")==="true"){const[r,a]=e;console.log(` ${(a==null?void 0:a.method)||"GET"} ${r}`)}const t=await(globalThis[oy]??gb)(...e);return(s||xt("DEBUG")==="true")&&console.log(` ${t.status} ${t.statusText} ${t.url}`),t},uy=()=>xt("PROJECT")??hn("LANGCHAIN_SESSION")??"default",_m={};function Wc(s){_m[s]||(console.warn(s),_m[s]=!0)}const vb=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function pe(s,e){if(!vb.test(s)){const t=e!==void 0?`Invalid UUID for ${e}: ${s}`:`Invalid UUID: ${s}`;throw new Error(t)}return s}function wb(s){const e=typeof s=="string"?Date.parse(s):s;return I0({msecs:e,seq:0})}const ly="0.3.87";var us={};let dn;const bb=()=>typeof window<"u"&&typeof window.document<"u",Eb=()=>typeof globalThis=="object"&&globalThis.constructor&&globalThis.constructor.name==="DedicatedWorkerGlobalScope",Sb=()=>typeof window<"u"&&window.name==="nodejs"||typeof navigator<"u"&&navigator.userAgent.includes("jsdom"),cy=()=>typeof Deno<"u",Ob=()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"&&!cy(),dy=()=>dn||(typeof Bun<"u"?dn="bun":bb()?dn="browser":Ob()?dn="node":Eb()?dn="webworker":Sb()?dn="jsdom":cy()?dn="deno":dn="other",dn);let Il;function fy(){if(Il===void 0){const s=dy(),e=Tb();Il={library:"langsmith",runtime:s,sdk:"langsmith-js",sdk_version:ly,...e}}return Il}function hy(){const s=kb(),e={},t=["LANGCHAIN_API_KEY","LANGCHAIN_ENDPOINT","LANGCHAIN_TRACING_V2","LANGCHAIN_PROJECT","LANGCHAIN_SESSION","LANGSMITH_API_KEY","LANGSMITH_ENDPOINT","LANGSMITH_TRACING_V2","LANGSMITH_PROJECT","LANGSMITH_SESSION"];for(const[r,a]of Object.entries(s))typeof a=="string"&&!t.includes(r)&&!r.toLowerCase().includes("key")&&!r.toLowerCase().includes("secret")&&!r.toLowerCase().includes("token")&&(r==="LANGCHAIN_REVISION_ID"?e.revision_id=a:e[r]=a);return e}function kb(){const s={};try{if(typeof process<"u"&&us)for(const[e,t]of Object.entries(us))(e.startsWith("LANGCHAIN_")||e.startsWith("LANGSMITH_"))&&t!=null&&((e.toLowerCase().includes("key")||e.toLowerCase().includes("secret")||e.toLowerCase().includes("token"))&&typeof t=="string"?s[e]=t.slice(0,2)+"*".repeat(t.length-4)+t.slice(-2):s[e]=t)}catch{}return s}function hn(s){try{return typeof process<"u"?us==null?void 0:us[s]:void 0}catch{return}}function xt(s){return hn(`LANGSMITH_${s}`)||hn(`LANGCHAIN_${s}`)}let Cl;function Tb(){if(Cl!==void 0)return Cl;const s=["VERCEL_GIT_COMMIT_SHA","NEXT_PUBLIC_VERCEL_GIT_COMMIT_SHA","COMMIT_REF","RENDER_GIT_COMMIT","CI_COMMIT_SHA","CIRCLE_SHA1","CF_PAGES_COMMIT_SHA","REACT_APP_GIT_SHA","SOURCE_VERSION","GITHUB_SHA","TRAVIS_COMMIT","GIT_COMMIT","BUILD_VCS_NUMBER","bamboo_planRepository_revision","Build.SourceVersion","BITBUCKET_COMMIT","DRONE_COMMIT_SHA","SEMAPHORE_GIT_SHA","BUILDKITE_COMMIT"],e={};for(const t of s){const r=hn(t);r!==void 0&&(e[t]=r)}return Cl=e,e}function py(){return hn("OTEL_ENABLED")==="true"||xt("OTEL_ENABLED")==="true"}class xb{constructor(){Object.defineProperty(this,"hasWarned",{enumerable:!0,configurable:!0,writable:!0,value:!1})}startActiveSpan(e,...t){!this.hasWarned&&py()&&(console.warn('You have enabled OTEL export via the `OTEL_ENABLED` or `LANGSMITH_OTEL_ENABLED` environment variable, but have not initialized the required OTEL instances. Please add:\n```\nimport { initializeOTEL } from "langsmith/experimental/otel/setup";\ninitializeOTEL();\n```\nat the beginning of your code.'),this.hasWarned=!0);let r;if(t.length===1&&typeof t[0]=="function"?r=t[0]:t.length===2&&typeof t[1]=="function"?r=t[1]:t.length===3&&typeof t[2]=="function"&&(r=t[2]),typeof r=="function")return r()}}class Rb{constructor(){Object.defineProperty(this,"mockTracer",{enumerable:!0,configurable:!0,writable:!0,value:new xb})}getTracer(e,t){return this.mockTracer}getActiveSpan(){}setSpan(e,t){return e}getSpan(e){}setSpanContext(e,t){return e}getTracerProvider(){}setGlobalTracerProvider(e){return!1}}class Ib{active(){return{}}with(e,t){return t()}}const Nl=Symbol.for("ls:otel_trace"),Al=Symbol.for("ls:otel_context"),vm=Symbol.for("ls:otel_get_default_otlp_tracer_provider"),Cb=new Rb,Nb=new Ib;class Ab{getTraceInstance(){return globalThis[Nl]??Cb}getContextInstance(){return globalThis[Al]??Nb}initializeGlobalInstances(e){globalThis[Nl]===void 0&&(globalThis[Nl]=e.trace),globalThis[Al]===void 0&&(globalThis[Al]=e.context)}setDefaultOTLPTracerComponents(e){globalThis[vm]=e}getDefaultOTLPTracerComponents(){return globalThis[vm]??void 0}}const od=new Ab;function my(){return od.getTraceInstance()}function Pb(){return od.getContextInstance()}function Lb(){return od.getDefaultOTLPTracerComponents()}const jb={llm:"chat",tool:"execute_tool",retriever:"embeddings",embedding:"embeddings",prompt:"chat"};function $b(s){return jb[s]||s}class Db{constructor(){Object.defineProperty(this,"spans",{enumerable:!0,configurable:!0,writable:!0,value:new Map})}exportBatch(e,t){for(const r of e)try{if(!r.run)continue;if(r.operation==="post"){const a=this.createSpanForRun(r,r.run,t.get(r.id));a&&!r.run.end_time&&this.spans.set(r.id,a)}else this.updateSpanForRun(r,r.run)}catch(a){console.error(`Error processing operation ${r.id}:`,a)}}createSpanForRun(e,t,r){const a=r&&my().getSpan(r);if(a)try{return this.finishSpanSetup(a,t,e)}catch(o){console.error(`Failed to create span for run ${e.id}:`,o);return}}finishSpanSetup(e,t,r){return this.setSpanAttributes(e,t,r),t.error?(e.setStatus({code:2}),e.recordException(new Error(t.error))):e.setStatus({code:1}),t.end_time&&e.end(new Date(t.end_time)),e}updateSpanForRun(e,t){try{const r=this.spans.get(e.id);if(!r){console.debug(`No span found for run ${e.id} during update`);return}this.setSpanAttributes(r,t,e),t.error?(r.setStatus({code:2}),r.recordException(new Error(t.error))):r.setStatus({code:1});const a=t.end_time;a&&(r.end(new Date(a)),this.spans.delete(e.id))}catch(r){console.error(`Failed to update span for run ${e.id}:`,r)}}extractModelName(e){var t;if((t=e.extra)!=null&&t.metadata){const r=e.extra.metadata;if(r.ls_model_name)return r.ls_model_name;if(r.invocation_params){const a=r.invocation_params;if(a.model)return a.model;if(a.model_name)return a.model_name}}}setSpanAttributes(e,t,r){var c;if("run_type"in t&&t.run_type){e.setAttribute(db,t.run_type);const f=$b(t.run_type||"chain");e.setAttribute(B0,f)}"name"in t&&t.name&&e.setAttribute(fb,t.name),"session_id"in t&&t.session_id&&e.setAttribute(lb,t.session_id),"session_name"in t&&t.session_name&&e.setAttribute(cb,t.session_name),this.setGenAiSystem(e,t);const a=this.extractModelName(t);a&&e.setAttribute(hm,a),"prompt_tokens"in t&&typeof t.prompt_tokens=="number"&&e.setAttribute(pm,t.prompt_tokens),"completion_tokens"in t&&typeof t.completion_tokens=="number"&&e.setAttribute(mm,t.completion_tokens),"total_tokens"in t&&typeof t.total_tokens=="number"&&e.setAttribute(gm,t.total_tokens),this.setInvocationParameters(e,t);const o=((c=t.extra)==null?void 0:c.metadata)||{};for(const[f,h]of Object.entries(o))h!=null&&e.setAttribute(`${hb}.${f}`,String(h));const l=t.tags;if(l&&Array.isArray(l)?e.setAttribute(ym,l.join(", ")):l&&e.setAttribute(ym,String(l)),"serialized"in t&&typeof t.serialized=="object"){const f=t.serialized;f.name&&e.setAttribute(tb,String(f.name)),f.signature&&e.setAttribute(nb,String(f.signature)),f.doc&&e.setAttribute(rb,String(f.doc))}this.setIOAttributes(e,r)}setGenAiSystem(e,t){let r="langchain";const a=this.extractModelName(t);if(a){const o=a.toLowerCase();o.includes("anthropic")||o.startsWith("claude")?r="anthropic":o.includes("bedrock")?r="aws.bedrock":o.includes("azure")&&o.includes("openai")?r="az.ai.openai":o.includes("azure")&&o.includes("inference")?r="az.ai.inference":o.includes("cohere")?r="cohere":o.includes("deepseek")?r="deepseek":o.includes("gemini")?r="gemini":o.includes("groq")?r="groq":o.includes("watson")||o.includes("ibm")?r="ibm.watsonx.ai":o.includes("mistral")?r="mistral_ai":o.includes("gpt")||o.includes("openai")?r="openai":o.includes("perplexity")||o.includes("sonar")?r="perplexity":o.includes("vertex")?r="vertex_ai":(o.includes("xai")||o.includes("grok"))&&(r="xai")}e.setAttribute(H0,r)}setInvocationParameters(e,t){var a,o;if(!((o=(a=t.extra)==null?void 0:a.metadata)!=null&&o.invocation_params))return;const r=t.extra.metadata.invocation_params;r.max_tokens!==void 0&&e.setAttribute(q0,r.max_tokens),r.temperature!==void 0&&e.setAttribute(V0,r.temperature),r.top_p!==void 0&&e.setAttribute(Z0,r.top_p),r.frequency_penalty!==void 0&&e.setAttribute(W0,r.frequency_penalty),r.presence_penalty!==void 0&&e.setAttribute(K0,r.presence_penalty)}setIOAttributes(e,t){if(t.run.inputs)try{const r=t.run.inputs;typeof r=="object"&&r!==null&&(r.model&&Array.isArray(r.messages)&&e.setAttribute(hm,r.model),r.stream!==void 0&&e.setAttribute(pb,r.stream),r.extra_headers&&e.setAttribute(mb,JSON.stringify(r.extra_headers)),r.extra_query&&e.setAttribute(X0,JSON.stringify(r.extra_query)),r.extra_body&&e.setAttribute(eb,JSON.stringify(r.extra_body))),e.setAttribute(Q0,JSON.stringify(r))}catch(r){console.debug(`Failed to process inputs for run ${t.id}`,r)}if(t.run.outputs)try{const r=t.run.outputs,a=this.getUnifiedRunTokens(r);if(a&&(e.setAttribute(pm,a[0]),e.setAttribute(mm,a[1]),e.setAttribute(gm,a[0]+a[1])),r&&typeof r=="object"){if(r.model&&e.setAttribute(G0,String(r.model)),r.id&&e.setAttribute(ib,r.id),r.choices&&Array.isArray(r.choices)){const o=r.choices.map(l=>l.finish_reason).filter(l=>l).map(String);o.length>0&&e.setAttribute(J0,o.join(", "))}if(r.service_tier&&e.setAttribute(sb,r.service_tier),r.system_fingerprint&&e.setAttribute(ab,r.system_fingerprint),r.usage_metadata&&typeof r.usage_metadata=="object"){const o=r.usage_metadata;o.input_token_details&&e.setAttribute(ob,JSON.stringify(o.input_token_details)),o.output_token_details&&e.setAttribute(ub,JSON.stringify(o.output_token_details))}}e.setAttribute(Y0,JSON.stringify(r))}catch(r){console.debug(`Failed to process outputs for run ${t.id}`,r)}}getUnifiedRunTokens(e){if(!e)return null;let t=this.extractUnifiedRunTokens(e.usage_metadata);if(t)return t;const r=Object.keys(e);for(const l of r){const c=e[l];if(!(!c||typeof c!="object")&&(t=this.extractUnifiedRunTokens(c.usage_metadata),t||c.lc===1&&c.kwargs&&typeof c.kwargs=="object"&&(t=this.extractUnifiedRunTokens(c.kwargs.usage_metadata),t)))return t}const a=e.generations||[];if(!Array.isArray(a))return null;const o=Array.isArray(a[0])?a.flat():a;for(const l of o)if(typeof l=="object"&&l.message&&typeof l.message=="object"&&l.message.kwargs&&typeof l.message.kwargs=="object"&&(t=this.extractUnifiedRunTokens(l.message.kwargs.usage_metadata),t))return t;return null}extractUnifiedRunTokens(e){return!e||typeof e!="object"||typeof e.input_tokens!="number"||typeof e.output_tokens!="number"?null:[e.input_tokens,e.output_tokens]}}const Mb=Object.prototype.toString,Ub=s=>Mb.call(s)==="[object Error]",zb=new Set(["network error","Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed","fetch failed","terminated"," A network error occurred.","Network connection lost"]);function Fb(s){if(!(s&&Ub(s)&&s.name==="TypeError"&&typeof s.message=="string"))return!1;const{message:t,stack:r}=s;return t==="Load failed"?r===void 0||"__sentry_captured__"in s:t.startsWith("error sending request for url")?!0:zb.has(t)}function Bb(s){if(typeof s=="number"){if(s<0)throw new TypeError("Expected `retries` to be a non-negative number.");if(Number.isNaN(s))throw new TypeError("Expected `retries` to be a valid number or Infinity, got NaN.")}else if(s!==void 0)throw new TypeError("Expected `retries` to be a number or Infinity.")}function $a(s,e,{min:t=0,allowInfinity:r=!1}={}){if(e!==void 0){if(typeof e!="number"||Number.isNaN(e))throw new TypeError(`Expected \`${s}\` to be a number${r?" or Infinity":""}.`);if(!r&&!Number.isFinite(e))throw new TypeError(`Expected \`${s}\` to be a finite number.`);if(e<t)throw new TypeError(`Expected \`${s}\` to be  ${t}.`)}}class Hb extends Error{constructor(e){super(),e instanceof Error?(this.originalError=e,{message:e}=e):(this.originalError=new Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}}function Gb(s,e){const t=Math.max(1,s+1),r=e.randomize?Math.random()+1:1;let a=Math.round(r*e.minTimeout*e.factor**(t-1));return a=Math.min(a,e.maxTimeout),a}function wm(s,e){return Number.isFinite(e)?e-(performance.now()-s):e}async function qb({error:s,attemptNumber:e,retriesConsumed:t,startTime:r,options:a}){var w,b,E;const o=s instanceof Error?s:new TypeError(`Non-error was thrown: "${s}". You should only throw errors.`);if(o instanceof Hb)throw o.originalError;const l=Number.isFinite(a.retries)?Math.max(0,a.retries-t):a.retries,c=a.maxRetryTime??Number.POSITIVE_INFINITY,f=Object.freeze({error:o,attemptNumber:e,retriesLeft:l,retriesConsumed:t});if(await a.onFailedAttempt(f),wm(r,c)<=0)throw o;const h=await a.shouldConsumeRetry(f),m=wm(r,c);if(m<=0||l<=0)throw o;if(o instanceof TypeError&&!Fb(o)){if(h)throw o;return(w=a.signal)==null||w.throwIfAborted(),!1}if(!await a.shouldRetry(f))throw o;if(!h)return(b=a.signal)==null||b.throwIfAborted(),!1;const _=Gb(t,a),y=Math.min(_,m);return y>0&&await new Promise((S,O)=>{var $,P;const R=()=>{var z;clearTimeout(T),(z=a.signal)==null||z.removeEventListener("abort",R),O(a.signal.reason)},T=setTimeout(()=>{var z;(z=a.signal)==null||z.removeEventListener("abort",R),S()},y);a.unref&&(($=T.unref)==null||$.call(T)),(P=a.signal)==null||P.addEventListener("abort",R,{once:!0})}),(E=a.signal)==null||E.throwIfAborted(),!0}async function Vb(s,e={}){var o,l,c;if(e={...e},Bb(e.retries),Object.hasOwn(e,"forever"))throw new Error("The `forever` option is no longer supported. For many use-cases, you can set `retries: Infinity` instead.");e.retries??(e.retries=10),e.factor??(e.factor=2),e.minTimeout??(e.minTimeout=1e3),e.maxTimeout??(e.maxTimeout=Number.POSITIVE_INFINITY),e.maxRetryTime??(e.maxRetryTime=Number.POSITIVE_INFINITY),e.randomize??(e.randomize=!1),e.onFailedAttempt??(e.onFailedAttempt=()=>{}),e.shouldRetry??(e.shouldRetry=()=>!0),e.shouldConsumeRetry??(e.shouldConsumeRetry=()=>!0),$a("factor",e.factor,{min:0,allowInfinity:!1}),$a("minTimeout",e.minTimeout,{min:0,allowInfinity:!1}),$a("maxTimeout",e.maxTimeout,{min:0,allowInfinity:!0}),$a("maxRetryTime",e.maxRetryTime,{min:0,allowInfinity:!0}),e.factor>0||(e.factor=1),(o=e.signal)==null||o.throwIfAborted();let t=0,r=0;const a=performance.now();for(;!Number.isFinite(e.retries)||r<=e.retries;){t++;try{(l=e.signal)==null||l.throwIfAborted();const f=await s(t);return(c=e.signal)==null||c.throwIfAborted(),f}catch(f){await qb({error:f,attemptNumber:t,retriesConsumed:r,startTime:a,options:e})&&r++}}throw new Error("Retry attempts exhausted without throwing an error.")}var Da={},Pl={exports:{}},bm;function Zb(){return bm||(bm=1,(function(s){var e=Object.prototype.hasOwnProperty,t="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(t=!1));function a(f,h,m){this.fn=f,this.context=h,this.once=m||!1}function o(f,h,m,_,y){if(typeof m!="function")throw new TypeError("The listener must be a function");var w=new a(m,_||f,y),b=t?t+h:h;return f._events[b]?f._events[b].fn?f._events[b]=[f._events[b],w]:f._events[b].push(w):(f._events[b]=w,f._eventsCount++),f}function l(f,h){--f._eventsCount===0?f._events=new r:delete f._events[h]}function c(){this._events=new r,this._eventsCount=0}c.prototype.eventNames=function(){var h=[],m,_;if(this._eventsCount===0)return h;for(_ in m=this._events)e.call(m,_)&&h.push(t?_.slice(1):_);return Object.getOwnPropertySymbols?h.concat(Object.getOwnPropertySymbols(m)):h},c.prototype.listeners=function(h){var m=t?t+h:h,_=this._events[m];if(!_)return[];if(_.fn)return[_.fn];for(var y=0,w=_.length,b=new Array(w);y<w;y++)b[y]=_[y].fn;return b},c.prototype.listenerCount=function(h){var m=t?t+h:h,_=this._events[m];return _?_.fn?1:_.length:0},c.prototype.emit=function(h,m,_,y,w,b){var E=t?t+h:h;if(!this._events[E])return!1;var S=this._events[E],O=arguments.length,R,T;if(S.fn){switch(S.once&&this.removeListener(h,S.fn,void 0,!0),O){case 1:return S.fn.call(S.context),!0;case 2:return S.fn.call(S.context,m),!0;case 3:return S.fn.call(S.context,m,_),!0;case 4:return S.fn.call(S.context,m,_,y),!0;case 5:return S.fn.call(S.context,m,_,y,w),!0;case 6:return S.fn.call(S.context,m,_,y,w,b),!0}for(T=1,R=new Array(O-1);T<O;T++)R[T-1]=arguments[T];S.fn.apply(S.context,R)}else{var $=S.length,P;for(T=0;T<$;T++)switch(S[T].once&&this.removeListener(h,S[T].fn,void 0,!0),O){case 1:S[T].fn.call(S[T].context);break;case 2:S[T].fn.call(S[T].context,m);break;case 3:S[T].fn.call(S[T].context,m,_);break;case 4:S[T].fn.call(S[T].context,m,_,y);break;default:if(!R)for(P=1,R=new Array(O-1);P<O;P++)R[P-1]=arguments[P];S[T].fn.apply(S[T].context,R)}}return!0},c.prototype.on=function(h,m,_){return o(this,h,m,_,!1)},c.prototype.once=function(h,m,_){return o(this,h,m,_,!0)},c.prototype.removeListener=function(h,m,_,y){var w=t?t+h:h;if(!this._events[w])return this;if(!m)return l(this,w),this;var b=this._events[w];if(b.fn)b.fn===m&&(!y||b.once)&&(!_||b.context===_)&&l(this,w);else{for(var E=0,S=[],O=b.length;E<O;E++)(b[E].fn!==m||y&&!b[E].once||_&&b[E].context!==_)&&S.push(b[E]);S.length?this._events[w]=S.length===1?S[0]:S:l(this,w)}return this},c.prototype.removeAllListeners=function(h){var m;return h?(m=t?t+h:h,this._events[m]&&l(this,m)):(this._events=new r,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=t,c.EventEmitter=c,s.exports=c})(Pl)),Pl.exports}var Yi={exports:{}},Ll,Em;function Wb(){return Em||(Em=1,Ll=(s,e)=>(e=e||(()=>{}),s.then(t=>new Promise(r=>{r(e())}).then(()=>t),t=>new Promise(r=>{r(e())}).then(()=>{throw t})))),Ll}var Sm;function Kb(){if(Sm)return Yi.exports;Sm=1;const s=Wb();class e extends Error{constructor(a){super(a),this.name="TimeoutError"}}const t=(r,a,o)=>new Promise((l,c)=>{if(typeof a!="number"||a<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(a===1/0){l(r);return}const f=setTimeout(()=>{if(typeof o=="function"){try{l(o())}catch(_){c(_)}return}const h=typeof o=="string"?o:`Promise timed out after ${a} milliseconds`,m=o instanceof Error?o:new e(h);typeof r.cancel=="function"&&r.cancel(),c(m)},a);s(r.then(l,c),()=>{clearTimeout(f)})});return Yi.exports=t,Yi.exports.default=t,Yi.exports.TimeoutError=e,Yi.exports}var Ma={},Ua={},Om;function Jb(){if(Om)return Ua;Om=1,Object.defineProperty(Ua,"__esModule",{value:!0});function s(e,t,r){let a=0,o=e.length;for(;o>0;){const l=o/2|0;let c=a+l;r(e[c],t)<=0?(a=++c,o-=l+1):o=l}return a}return Ua.default=s,Ua}var km;function Qb(){if(km)return Ma;km=1,Object.defineProperty(Ma,"__esModule",{value:!0});const s=Jb();class e{constructor(){this._queue=[]}enqueue(r,a){a=Object.assign({priority:0},a);const o={priority:a.priority,run:r};if(this.size&&this._queue[this.size-1].priority>=a.priority){this._queue.push(o);return}const l=s.default(this._queue,o,(c,f)=>f.priority-c.priority);this._queue.splice(l,0,o)}dequeue(){const r=this._queue.shift();return r==null?void 0:r.run}filter(r){return this._queue.filter(a=>a.priority===r.priority).map(a=>a.run)}get size(){return this._queue.length}}return Ma.default=e,Ma}var Tm;function Yb(){if(Tm)return Da;Tm=1,Object.defineProperty(Da,"__esModule",{value:!0});const s=Zb(),e=Kb(),t=Qb(),r=()=>{},a=new e.TimeoutError;class o extends s{constructor(c){var f,h,m,_;if(super(),this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=r,this._resolveIdle=r,c=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:t.default},c),!(typeof c.intervalCap=="number"&&c.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(h=(f=c.intervalCap)===null||f===void 0?void 0:f.toString())!==null&&h!==void 0?h:""}\` (${typeof c.intervalCap})`);if(c.interval===void 0||!(Number.isFinite(c.interval)&&c.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(_=(m=c.interval)===null||m===void 0?void 0:m.toString())!==null&&_!==void 0?_:""}\` (${typeof c.interval})`);this._carryoverConcurrencyCount=c.carryoverConcurrencyCount,this._isIntervalIgnored=c.intervalCap===1/0||c.interval===0,this._intervalCap=c.intervalCap,this._interval=c.interval,this._queue=new c.queueClass,this._queueClass=c.queueClass,this.concurrency=c.concurrency,this._timeout=c.timeout,this._throwOnTimeout=c.throwOnTimeout===!0,this._isPaused=c.autoStart===!1}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=r,this._pendingCount===0&&(this._resolveIdle(),this._resolveIdle=r,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){const c=Date.now();if(this._intervalId===void 0){const f=this._intervalEnd-c;if(f<0)this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;else return this._timeoutId===void 0&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},f)),!0}return!1}_tryToStartAnother(){if(this._queue.size===0)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){const c=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){const f=this._queue.dequeue();return f?(this.emit("active"),f(),c&&this._initializeIntervalIfNeeded(),!0):!1}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||this._intervalId!==void 0||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){this._intervalCount===0&&this._pendingCount===0&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(c){if(!(typeof c=="number"&&c>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${c}\` (${typeof c})`);this._concurrency=c,this._processQueue()}async add(c,f={}){return new Promise((h,m)=>{const _=async()=>{this._pendingCount++,this._intervalCount++;try{const y=this._timeout===void 0&&f.timeout===void 0?c():e.default(Promise.resolve(c()),f.timeout===void 0?this._timeout:f.timeout,()=>{(f.throwOnTimeout===void 0?this._throwOnTimeout:f.throwOnTimeout)&&m(a)});h(await y)}catch(y){m(y)}this._next()};this._queue.enqueue(_,f),this._tryToStartAnother(),this.emit("add")})}async addAll(c,f){return Promise.all(c.map(async h=>this.add(h,f)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(this._queue.size!==0)return new Promise(c=>{const f=this._resolveEmpty;this._resolveEmpty=()=>{f(),c()}})}async onIdle(){if(!(this._pendingCount===0&&this._queue.size===0))return new Promise(c=>{const f=this._resolveIdle;this._resolveIdle=()=>{f(),c()}})}get size(){return this._queue.size}sizeBy(c){return this._queue.filter(c).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(c){this._timeout=c}}return Da.default=o,Da}var Xb=Yb();const En=Or(Xb),eE=[408,425,429,500,502,503,504];let xm=class{constructor(e){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxQueueSizeBytes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onFailedResponseHook",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queueSizeBytes",{enumerable:!0,configurable:!0,writable:!0,value:0}),this.maxConcurrency=e.maxConcurrency??1/0,this.maxRetries=e.maxRetries??6,this.maxQueueSizeBytes=e.maxQueueSizeBytes,"default"in En?this.queue=new En.default({concurrency:this.maxConcurrency}):this.queue=new En({concurrency:this.maxConcurrency}),this.onFailedResponseHook=e==null?void 0:e.onFailedResponseHook}call(e,...t){return this.callWithOptions({},e,...t)}callWithOptions(e,t,...r){const a=e.sizeBytes??0;if(this.maxQueueSizeBytes!==void 0&&a>0&&this.queueSizeBytes+a>this.maxQueueSizeBytes)return Promise.reject(new Error(`Queue size limit (${this.maxQueueSizeBytes} bytes) exceeded. Current queue size: ${this.queueSizeBytes} bytes, attempted addition: ${a} bytes.`));a>0&&(this.queueSizeBytes+=a);const o=this.onFailedResponseHook;let l=this.queue.add(()=>Vb(()=>t(...r).catch(c=>{throw c instanceof Error?c:new Error(c)}),{async onFailedAttempt({error:c}){if(c.message.startsWith("Cancel")||c.message.startsWith("TimeoutError")||c.name==="TimeoutError"||c.message.startsWith("AbortError")||(c==null?void 0:c.code)==="ECONNABORTED")throw c;const f=c==null?void 0:c.response;if(o&&await o(f))return;const h=(f==null?void 0:f.status)??(c==null?void 0:c.status);if(h&&!eE.includes(+h))throw c},retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0});return a>0&&(l=l.finally(()=>{this.queueSizeBytes-=a})),e.signal?Promise.race([l,new Promise((c,f)=>{var h;(h=e.signal)==null||h.addEventListener("abort",()=>{f(new Error("AbortError"))})})]):l}};function Rm(s){return typeof(s==null?void 0:s._getType)=="function"}function Im(s){const e={type:s._getType(),data:{content:s.content}};return s!=null&&s.additional_kwargs&&Object.keys(s.additional_kwargs).length>0&&(e.data.additional_kwargs={...s.additional_kwargs}),e}var za={exports:{}},jl,Cm;function po(){if(Cm)return jl;Cm=1;const s="2.0.0",e=256,t=Number.MAX_SAFE_INTEGER||9007199254740991,r=16,a=e-6;return jl={MAX_LENGTH:e,MAX_SAFE_COMPONENT_LENGTH:r,MAX_SAFE_BUILD_LENGTH:a,MAX_SAFE_INTEGER:t,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:s,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},jl}var $l,Nm;function mo(){if(Nm)return $l;Nm=1;var s={};return $l=typeof process=="object"&&s&&s.NODE_DEBUG&&/\bsemver\b/i.test(s.NODE_DEBUG)?(...t)=>console.error("SEMVER",...t):()=>{},$l}var Am;function bs(){return Am||(Am=1,(function(s,e){const{MAX_SAFE_COMPONENT_LENGTH:t,MAX_SAFE_BUILD_LENGTH:r,MAX_LENGTH:a}=po(),o=mo();e=s.exports={};const l=e.re=[],c=e.safeRe=[],f=e.src=[],h=e.safeSrc=[],m=e.t={};let _=0;const y="[a-zA-Z0-9-]",w=[["\\s",1],["\\d",a],[y,r]],b=S=>{for(const[O,R]of w)S=S.split(`${O}*`).join(`${O}{0,${R}}`).split(`${O}+`).join(`${O}{1,${R}}`);return S},E=(S,O,R)=>{const T=b(O),$=_++;o(S,$,O),m[S]=$,f[$]=O,h[$]=T,l[$]=new RegExp(O,R?"g":void 0),c[$]=new RegExp(T,R?"g":void 0)};E("NUMERICIDENTIFIER","0|[1-9]\\d*"),E("NUMERICIDENTIFIERLOOSE","\\d+"),E("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${y}*`),E("MAINVERSION",`(${f[m.NUMERICIDENTIFIER]})\\.(${f[m.NUMERICIDENTIFIER]})\\.(${f[m.NUMERICIDENTIFIER]})`),E("MAINVERSIONLOOSE",`(${f[m.NUMERICIDENTIFIERLOOSE]})\\.(${f[m.NUMERICIDENTIFIERLOOSE]})\\.(${f[m.NUMERICIDENTIFIERLOOSE]})`),E("PRERELEASEIDENTIFIER",`(?:${f[m.NONNUMERICIDENTIFIER]}|${f[m.NUMERICIDENTIFIER]})`),E("PRERELEASEIDENTIFIERLOOSE",`(?:${f[m.NONNUMERICIDENTIFIER]}|${f[m.NUMERICIDENTIFIERLOOSE]})`),E("PRERELEASE",`(?:-(${f[m.PRERELEASEIDENTIFIER]}(?:\\.${f[m.PRERELEASEIDENTIFIER]})*))`),E("PRERELEASELOOSE",`(?:-?(${f[m.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${f[m.PRERELEASEIDENTIFIERLOOSE]})*))`),E("BUILDIDENTIFIER",`${y}+`),E("BUILD",`(?:\\+(${f[m.BUILDIDENTIFIER]}(?:\\.${f[m.BUILDIDENTIFIER]})*))`),E("FULLPLAIN",`v?${f[m.MAINVERSION]}${f[m.PRERELEASE]}?${f[m.BUILD]}?`),E("FULL",`^${f[m.FULLPLAIN]}$`),E("LOOSEPLAIN",`[v=\\s]*${f[m.MAINVERSIONLOOSE]}${f[m.PRERELEASELOOSE]}?${f[m.BUILD]}?`),E("LOOSE",`^${f[m.LOOSEPLAIN]}$`),E("GTLT","((?:<|>)?=?)"),E("XRANGEIDENTIFIERLOOSE",`${f[m.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),E("XRANGEIDENTIFIER",`${f[m.NUMERICIDENTIFIER]}|x|X|\\*`),E("XRANGEPLAIN",`[v=\\s]*(${f[m.XRANGEIDENTIFIER]})(?:\\.(${f[m.XRANGEIDENTIFIER]})(?:\\.(${f[m.XRANGEIDENTIFIER]})(?:${f[m.PRERELEASE]})?${f[m.BUILD]}?)?)?`),E("XRANGEPLAINLOOSE",`[v=\\s]*(${f[m.XRANGEIDENTIFIERLOOSE]})(?:\\.(${f[m.XRANGEIDENTIFIERLOOSE]})(?:\\.(${f[m.XRANGEIDENTIFIERLOOSE]})(?:${f[m.PRERELEASELOOSE]})?${f[m.BUILD]}?)?)?`),E("XRANGE",`^${f[m.GTLT]}\\s*${f[m.XRANGEPLAIN]}$`),E("XRANGELOOSE",`^${f[m.GTLT]}\\s*${f[m.XRANGEPLAINLOOSE]}$`),E("COERCEPLAIN",`(^|[^\\d])(\\d{1,${t}})(?:\\.(\\d{1,${t}}))?(?:\\.(\\d{1,${t}}))?`),E("COERCE",`${f[m.COERCEPLAIN]}(?:$|[^\\d])`),E("COERCEFULL",f[m.COERCEPLAIN]+`(?:${f[m.PRERELEASE]})?(?:${f[m.BUILD]})?(?:$|[^\\d])`),E("COERCERTL",f[m.COERCE],!0),E("COERCERTLFULL",f[m.COERCEFULL],!0),E("LONETILDE","(?:~>?)"),E("TILDETRIM",`(\\s*)${f[m.LONETILDE]}\\s+`,!0),e.tildeTrimReplace="$1~",E("TILDE",`^${f[m.LONETILDE]}${f[m.XRANGEPLAIN]}$`),E("TILDELOOSE",`^${f[m.LONETILDE]}${f[m.XRANGEPLAINLOOSE]}$`),E("LONECARET","(?:\\^)"),E("CARETTRIM",`(\\s*)${f[m.LONECARET]}\\s+`,!0),e.caretTrimReplace="$1^",E("CARET",`^${f[m.LONECARET]}${f[m.XRANGEPLAIN]}$`),E("CARETLOOSE",`^${f[m.LONECARET]}${f[m.XRANGEPLAINLOOSE]}$`),E("COMPARATORLOOSE",`^${f[m.GTLT]}\\s*(${f[m.LOOSEPLAIN]})$|^$`),E("COMPARATOR",`^${f[m.GTLT]}\\s*(${f[m.FULLPLAIN]})$|^$`),E("COMPARATORTRIM",`(\\s*)${f[m.GTLT]}\\s*(${f[m.LOOSEPLAIN]}|${f[m.XRANGEPLAIN]})`,!0),e.comparatorTrimReplace="$1$2$3",E("HYPHENRANGE",`^\\s*(${f[m.XRANGEPLAIN]})\\s+-\\s+(${f[m.XRANGEPLAIN]})\\s*$`),E("HYPHENRANGELOOSE",`^\\s*(${f[m.XRANGEPLAINLOOSE]})\\s+-\\s+(${f[m.XRANGEPLAINLOOSE]})\\s*$`),E("STAR","(<|>)?=?\\s*\\*"),E("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),E("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")})(za,za.exports)),za.exports}var Dl,Pm;function ud(){if(Pm)return Dl;Pm=1;const s=Object.freeze({loose:!0}),e=Object.freeze({});return Dl=r=>r?typeof r!="object"?s:r:e,Dl}var Ml,Lm;function gy(){if(Lm)return Ml;Lm=1;const s=/^[0-9]+$/,e=(r,a)=>{if(typeof r=="number"&&typeof a=="number")return r===a?0:r<a?-1:1;const o=s.test(r),l=s.test(a);return o&&l&&(r=+r,a=+a),r===a?0:o&&!l?-1:l&&!o?1:r<a?-1:1};return Ml={compareIdentifiers:e,rcompareIdentifiers:(r,a)=>e(a,r)},Ml}var Ul,jm;function yt(){if(jm)return Ul;jm=1;const s=mo(),{MAX_LENGTH:e,MAX_SAFE_INTEGER:t}=po(),{safeRe:r,t:a}=bs(),o=ud(),{compareIdentifiers:l}=gy();class c{constructor(h,m){if(m=o(m),h instanceof c){if(h.loose===!!m.loose&&h.includePrerelease===!!m.includePrerelease)return h;h=h.version}else if(typeof h!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof h}".`);if(h.length>e)throw new TypeError(`version is longer than ${e} characters`);s("SemVer",h,m),this.options=m,this.loose=!!m.loose,this.includePrerelease=!!m.includePrerelease;const _=h.trim().match(m.loose?r[a.LOOSE]:r[a.FULL]);if(!_)throw new TypeError(`Invalid Version: ${h}`);if(this.raw=h,this.major=+_[1],this.minor=+_[2],this.patch=+_[3],this.major>t||this.major<0)throw new TypeError("Invalid major version");if(this.minor>t||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>t||this.patch<0)throw new TypeError("Invalid patch version");_[4]?this.prerelease=_[4].split(".").map(y=>{if(/^[0-9]+$/.test(y)){const w=+y;if(w>=0&&w<t)return w}return y}):this.prerelease=[],this.build=_[5]?_[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(h){if(s("SemVer.compare",this.version,this.options,h),!(h instanceof c)){if(typeof h=="string"&&h===this.version)return 0;h=new c(h,this.options)}return h.version===this.version?0:this.compareMain(h)||this.comparePre(h)}compareMain(h){return h instanceof c||(h=new c(h,this.options)),this.major<h.major?-1:this.major>h.major?1:this.minor<h.minor?-1:this.minor>h.minor?1:this.patch<h.patch?-1:this.patch>h.patch?1:0}comparePre(h){if(h instanceof c||(h=new c(h,this.options)),this.prerelease.length&&!h.prerelease.length)return-1;if(!this.prerelease.length&&h.prerelease.length)return 1;if(!this.prerelease.length&&!h.prerelease.length)return 0;let m=0;do{const _=this.prerelease[m],y=h.prerelease[m];if(s("prerelease compare",m,_,y),_===void 0&&y===void 0)return 0;if(y===void 0)return 1;if(_===void 0)return-1;if(_===y)continue;return l(_,y)}while(++m)}compareBuild(h){h instanceof c||(h=new c(h,this.options));let m=0;do{const _=this.build[m],y=h.build[m];if(s("build compare",m,_,y),_===void 0&&y===void 0)return 0;if(y===void 0)return 1;if(_===void 0)return-1;if(_===y)continue;return l(_,y)}while(++m)}inc(h,m,_){if(h.startsWith("pre")){if(!m&&_===!1)throw new Error("invalid increment argument: identifier is empty");if(m){const y=`-${m}`.match(this.options.loose?r[a.PRERELEASELOOSE]:r[a.PRERELEASE]);if(!y||y[1]!==m)throw new Error(`invalid identifier: ${m}`)}}switch(h){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",m,_);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",m,_);break;case"prepatch":this.prerelease.length=0,this.inc("patch",m,_),this.inc("pre",m,_);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",m,_),this.inc("pre",m,_);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const y=Number(_)?1:0;if(this.prerelease.length===0)this.prerelease=[y];else{let w=this.prerelease.length;for(;--w>=0;)typeof this.prerelease[w]=="number"&&(this.prerelease[w]++,w=-2);if(w===-1){if(m===this.prerelease.join(".")&&_===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(y)}}if(m){let w=[m,y];_===!1&&(w=[m]),l(this.prerelease[0],m)===0?isNaN(this.prerelease[1])&&(this.prerelease=w):this.prerelease=w}break}default:throw new Error(`invalid increment argument: ${h}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}return Ul=c,Ul}var zl,$m;function li(){if($m)return zl;$m=1;const s=yt();return zl=(t,r,a=!1)=>{if(t instanceof s)return t;try{return new s(t,r)}catch(o){if(!a)return null;throw o}},zl}var Fl,Dm;function tE(){if(Dm)return Fl;Dm=1;const s=li();return Fl=(t,r)=>{const a=s(t,r);return a?a.version:null},Fl}var Bl,Mm;function nE(){if(Mm)return Bl;Mm=1;const s=li();return Bl=(t,r)=>{const a=s(t.trim().replace(/^[=v]+/,""),r);return a?a.version:null},Bl}var Hl,Um;function rE(){if(Um)return Hl;Um=1;const s=yt();return Hl=(t,r,a,o,l)=>{typeof a=="string"&&(l=o,o=a,a=void 0);try{return new s(t instanceof s?t.version:t,a).inc(r,o,l).version}catch{return null}},Hl}var Gl,zm;function iE(){if(zm)return Gl;zm=1;const s=li();return Gl=(t,r)=>{const a=s(t,null,!0),o=s(r,null,!0),l=a.compare(o);if(l===0)return null;const c=l>0,f=c?a:o,h=c?o:a,m=!!f.prerelease.length;if(!!h.prerelease.length&&!m){if(!h.patch&&!h.minor)return"major";if(h.compareMain(f)===0)return h.minor&&!h.patch?"minor":"patch"}const y=m?"pre":"";return a.major!==o.major?y+"major":a.minor!==o.minor?y+"minor":a.patch!==o.patch?y+"patch":"prerelease"},Gl}var ql,Fm;function sE(){if(Fm)return ql;Fm=1;const s=yt();return ql=(t,r)=>new s(t,r).major,ql}var Vl,Bm;function aE(){if(Bm)return Vl;Bm=1;const s=yt();return Vl=(t,r)=>new s(t,r).minor,Vl}var Zl,Hm;function oE(){if(Hm)return Zl;Hm=1;const s=yt();return Zl=(t,r)=>new s(t,r).patch,Zl}var Wl,Gm;function uE(){if(Gm)return Wl;Gm=1;const s=li();return Wl=(t,r)=>{const a=s(t,r);return a&&a.prerelease.length?a.prerelease:null},Wl}var Kl,qm;function rn(){if(qm)return Kl;qm=1;const s=yt();return Kl=(t,r,a)=>new s(t,a).compare(new s(r,a)),Kl}var Jl,Vm;function lE(){if(Vm)return Jl;Vm=1;const s=rn();return Jl=(t,r,a)=>s(r,t,a),Jl}var Ql,Zm;function cE(){if(Zm)return Ql;Zm=1;const s=rn();return Ql=(t,r)=>s(t,r,!0),Ql}var Yl,Wm;function ld(){if(Wm)return Yl;Wm=1;const s=yt();return Yl=(t,r,a)=>{const o=new s(t,a),l=new s(r,a);return o.compare(l)||o.compareBuild(l)},Yl}var Xl,Km;function dE(){if(Km)return Xl;Km=1;const s=ld();return Xl=(t,r)=>t.sort((a,o)=>s(a,o,r)),Xl}var ec,Jm;function fE(){if(Jm)return ec;Jm=1;const s=ld();return ec=(t,r)=>t.sort((a,o)=>s(o,a,r)),ec}var tc,Qm;function go(){if(Qm)return tc;Qm=1;const s=rn();return tc=(t,r,a)=>s(t,r,a)>0,tc}var nc,Ym;function cd(){if(Ym)return nc;Ym=1;const s=rn();return nc=(t,r,a)=>s(t,r,a)<0,nc}var rc,Xm;function yy(){if(Xm)return rc;Xm=1;const s=rn();return rc=(t,r,a)=>s(t,r,a)===0,rc}var ic,eg;function _y(){if(eg)return ic;eg=1;const s=rn();return ic=(t,r,a)=>s(t,r,a)!==0,ic}var sc,tg;function dd(){if(tg)return sc;tg=1;const s=rn();return sc=(t,r,a)=>s(t,r,a)>=0,sc}var ac,ng;function fd(){if(ng)return ac;ng=1;const s=rn();return ac=(t,r,a)=>s(t,r,a)<=0,ac}var oc,rg;function vy(){if(rg)return oc;rg=1;const s=yy(),e=_y(),t=go(),r=dd(),a=cd(),o=fd();return oc=(c,f,h,m)=>{switch(f){case"===":return typeof c=="object"&&(c=c.version),typeof h=="object"&&(h=h.version),c===h;case"!==":return typeof c=="object"&&(c=c.version),typeof h=="object"&&(h=h.version),c!==h;case"":case"=":case"==":return s(c,h,m);case"!=":return e(c,h,m);case">":return t(c,h,m);case">=":return r(c,h,m);case"<":return a(c,h,m);case"<=":return o(c,h,m);default:throw new TypeError(`Invalid operator: ${f}`)}},oc}var uc,ig;function hE(){if(ig)return uc;ig=1;const s=yt(),e=li(),{safeRe:t,t:r}=bs();return uc=(o,l)=>{if(o instanceof s)return o;if(typeof o=="number"&&(o=String(o)),typeof o!="string")return null;l=l||{};let c=null;if(!l.rtl)c=o.match(l.includePrerelease?t[r.COERCEFULL]:t[r.COERCE]);else{const w=l.includePrerelease?t[r.COERCERTLFULL]:t[r.COERCERTL];let b;for(;(b=w.exec(o))&&(!c||c.index+c[0].length!==o.length);)(!c||b.index+b[0].length!==c.index+c[0].length)&&(c=b),w.lastIndex=b.index+b[1].length+b[2].length;w.lastIndex=-1}if(c===null)return null;const f=c[2],h=c[3]||"0",m=c[4]||"0",_=l.includePrerelease&&c[5]?`-${c[5]}`:"",y=l.includePrerelease&&c[6]?`+${c[6]}`:"";return e(`${f}.${h}.${m}${_}${y}`,l)},uc}var lc,sg;function pE(){if(sg)return lc;sg=1;class s{constructor(){this.max=1e3,this.map=new Map}get(t){const r=this.map.get(t);if(r!==void 0)return this.map.delete(t),this.map.set(t,r),r}delete(t){return this.map.delete(t)}set(t,r){if(!this.delete(t)&&r!==void 0){if(this.map.size>=this.max){const o=this.map.keys().next().value;this.delete(o)}this.map.set(t,r)}return this}}return lc=s,lc}var cc,ag;function sn(){if(ag)return cc;ag=1;const s=/\s+/g;class e{constructor(G,ee){if(ee=a(ee),G instanceof e)return G.loose===!!ee.loose&&G.includePrerelease===!!ee.includePrerelease?G:new e(G.raw,ee);if(G instanceof o)return this.raw=G.value,this.set=[[G]],this.formatted=void 0,this;if(this.options=ee,this.loose=!!ee.loose,this.includePrerelease=!!ee.includePrerelease,this.raw=G.trim().replace(s," "),this.set=this.raw.split("||").map(J=>this.parseRange(J.trim())).filter(J=>J.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const J=this.set[0];if(this.set=this.set.filter(D=>!E(D[0])),this.set.length===0)this.set=[J];else if(this.set.length>1){for(const D of this.set)if(D.length===1&&S(D[0])){this.set=[D];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let G=0;G<this.set.length;G++){G>0&&(this.formatted+="||");const ee=this.set[G];for(let J=0;J<ee.length;J++)J>0&&(this.formatted+=" "),this.formatted+=ee[J].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(G){const J=((this.options.includePrerelease&&w)|(this.options.loose&&b))+":"+G,D=r.get(J);if(D)return D;const U=this.options.loose,M=U?f[h.HYPHENRANGELOOSE]:f[h.HYPHENRANGE];G=G.replace(M,Ue(this.options.includePrerelease)),l("hyphen replace",G),G=G.replace(f[h.COMPARATORTRIM],m),l("comparator trim",G),G=G.replace(f[h.TILDETRIM],_),l("tilde trim",G),G=G.replace(f[h.CARETTRIM],y),l("caret trim",G);let I=G.split(" ").map(ce=>R(ce,this.options)).join(" ").split(/\s+/).map(ce=>He(ce,this.options));U&&(I=I.filter(ce=>(l("loose invalid filter",ce,this.options),!!ce.match(f[h.COMPARATORLOOSE])))),l("range list",I);const j=new Map,te=I.map(ce=>new o(ce,this.options));for(const ce of te){if(E(ce))return[ce];j.set(ce.value,ce)}j.size>1&&j.has("")&&j.delete("");const le=[...j.values()];return r.set(J,le),le}intersects(G,ee){if(!(G instanceof e))throw new TypeError("a Range is required");return this.set.some(J=>O(J,ee)&&G.set.some(D=>O(D,ee)&&J.every(U=>D.every(M=>U.intersects(M,ee)))))}test(G){if(!G)return!1;if(typeof G=="string")try{G=new c(G,this.options)}catch{return!1}for(let ee=0;ee<this.set.length;ee++)if(Ge(this.set[ee],G,this.options))return!0;return!1}}cc=e;const t=pE(),r=new t,a=ud(),o=yo(),l=mo(),c=yt(),{safeRe:f,t:h,comparatorTrimReplace:m,tildeTrimReplace:_,caretTrimReplace:y}=bs(),{FLAG_INCLUDE_PRERELEASE:w,FLAG_LOOSE:b}=po(),E=K=>K.value==="<0.0.0-0",S=K=>K.value==="",O=(K,G)=>{let ee=!0;const J=K.slice();let D=J.pop();for(;ee&&J.length;)ee=J.every(U=>D.intersects(U,G)),D=J.pop();return ee},R=(K,G)=>(K=K.replace(f[h.BUILD],""),l("comp",K,G),K=z(K,G),l("caret",K),K=$(K,G),l("tildes",K),K=W(K,G),l("xrange",K),K=Ae(K,G),l("stars",K),K),T=K=>!K||K.toLowerCase()==="x"||K==="*",$=(K,G)=>K.trim().split(/\s+/).map(ee=>P(ee,G)).join(" "),P=(K,G)=>{const ee=G.loose?f[h.TILDELOOSE]:f[h.TILDE];return K.replace(ee,(J,D,U,M,I)=>{l("tilde",K,J,D,U,M,I);let j;return T(D)?j="":T(U)?j=`>=${D}.0.0 <${+D+1}.0.0-0`:T(M)?j=`>=${D}.${U}.0 <${D}.${+U+1}.0-0`:I?(l("replaceTilde pr",I),j=`>=${D}.${U}.${M}-${I} <${D}.${+U+1}.0-0`):j=`>=${D}.${U}.${M} <${D}.${+U+1}.0-0`,l("tilde return",j),j})},z=(K,G)=>K.trim().split(/\s+/).map(ee=>Q(ee,G)).join(" "),Q=(K,G)=>{l("caret",K,G);const ee=G.loose?f[h.CARETLOOSE]:f[h.CARET],J=G.includePrerelease?"-0":"";return K.replace(ee,(D,U,M,I,j)=>{l("caret",K,D,U,M,I,j);let te;return T(U)?te="":T(M)?te=`>=${U}.0.0${J} <${+U+1}.0.0-0`:T(I)?U==="0"?te=`>=${U}.${M}.0${J} <${U}.${+M+1}.0-0`:te=`>=${U}.${M}.0${J} <${+U+1}.0.0-0`:j?(l("replaceCaret pr",j),U==="0"?M==="0"?te=`>=${U}.${M}.${I}-${j} <${U}.${M}.${+I+1}-0`:te=`>=${U}.${M}.${I}-${j} <${U}.${+M+1}.0-0`:te=`>=${U}.${M}.${I}-${j} <${+U+1}.0.0-0`):(l("no pr"),U==="0"?M==="0"?te=`>=${U}.${M}.${I}${J} <${U}.${M}.${+I+1}-0`:te=`>=${U}.${M}.${I}${J} <${U}.${+M+1}.0-0`:te=`>=${U}.${M}.${I} <${+U+1}.0.0-0`),l("caret return",te),te})},W=(K,G)=>(l("replaceXRanges",K,G),K.split(/\s+/).map(ee=>Ee(ee,G)).join(" ")),Ee=(K,G)=>{K=K.trim();const ee=G.loose?f[h.XRANGELOOSE]:f[h.XRANGE];return K.replace(ee,(J,D,U,M,I,j)=>{l("xRange",K,J,D,U,M,I,j);const te=T(U),le=te||T(M),ce=le||T(I),ge=ce;return D==="="&&ge&&(D=""),j=G.includePrerelease?"-0":"",te?D===">"||D==="<"?J="<0.0.0-0":J="*":D&&ge?(le&&(M=0),I=0,D===">"?(D=">=",le?(U=+U+1,M=0,I=0):(M=+M+1,I=0)):D==="<="&&(D="<",le?U=+U+1:M=+M+1),D==="<"&&(j="-0"),J=`${D+U}.${M}.${I}${j}`):le?J=`>=${U}.0.0${j} <${+U+1}.0.0-0`:ce&&(J=`>=${U}.${M}.0${j} <${U}.${+M+1}.0-0`),l("xRange return",J),J})},Ae=(K,G)=>(l("replaceStars",K,G),K.trim().replace(f[h.STAR],"")),He=(K,G)=>(l("replaceGTE0",K,G),K.trim().replace(f[G.includePrerelease?h.GTE0PRE:h.GTE0],"")),Ue=K=>(G,ee,J,D,U,M,I,j,te,le,ce,ge)=>(T(J)?ee="":T(D)?ee=`>=${J}.0.0${K?"-0":""}`:T(U)?ee=`>=${J}.${D}.0${K?"-0":""}`:M?ee=`>=${ee}`:ee=`>=${ee}${K?"-0":""}`,T(te)?j="":T(le)?j=`<${+te+1}.0.0-0`:T(ce)?j=`<${te}.${+le+1}.0-0`:ge?j=`<=${te}.${le}.${ce}-${ge}`:K?j=`<${te}.${le}.${+ce+1}-0`:j=`<=${j}`,`${ee} ${j}`.trim()),Ge=(K,G,ee)=>{for(let J=0;J<K.length;J++)if(!K[J].test(G))return!1;if(G.prerelease.length&&!ee.includePrerelease){for(let J=0;J<K.length;J++)if(l(K[J].semver),K[J].semver!==o.ANY&&K[J].semver.prerelease.length>0){const D=K[J].semver;if(D.major===G.major&&D.minor===G.minor&&D.patch===G.patch)return!0}return!1}return!0};return cc}var dc,og;function yo(){if(og)return dc;og=1;const s=Symbol("SemVer ANY");class e{static get ANY(){return s}constructor(m,_){if(_=t(_),m instanceof e){if(m.loose===!!_.loose)return m;m=m.value}m=m.trim().split(/\s+/).join(" "),l("comparator",m,_),this.options=_,this.loose=!!_.loose,this.parse(m),this.semver===s?this.value="":this.value=this.operator+this.semver.version,l("comp",this)}parse(m){const _=this.options.loose?r[a.COMPARATORLOOSE]:r[a.COMPARATOR],y=m.match(_);if(!y)throw new TypeError(`Invalid comparator: ${m}`);this.operator=y[1]!==void 0?y[1]:"",this.operator==="="&&(this.operator=""),y[2]?this.semver=new c(y[2],this.options.loose):this.semver=s}toString(){return this.value}test(m){if(l("Comparator.test",m,this.options.loose),this.semver===s||m===s)return!0;if(typeof m=="string")try{m=new c(m,this.options)}catch{return!1}return o(m,this.operator,this.semver,this.options)}intersects(m,_){if(!(m instanceof e))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new f(m.value,_).test(this.value):m.operator===""?m.value===""?!0:new f(this.value,_).test(m.semver):(_=t(_),_.includePrerelease&&(this.value==="<0.0.0-0"||m.value==="<0.0.0-0")||!_.includePrerelease&&(this.value.startsWith("<0.0.0")||m.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&m.operator.startsWith(">")||this.operator.startsWith("<")&&m.operator.startsWith("<")||this.semver.version===m.semver.version&&this.operator.includes("=")&&m.operator.includes("=")||o(this.semver,"<",m.semver,_)&&this.operator.startsWith(">")&&m.operator.startsWith("<")||o(this.semver,">",m.semver,_)&&this.operator.startsWith("<")&&m.operator.startsWith(">")))}}dc=e;const t=ud(),{safeRe:r,t:a}=bs(),o=vy(),l=mo(),c=yt(),f=sn();return dc}var fc,ug;function _o(){if(ug)return fc;ug=1;const s=sn();return fc=(t,r,a)=>{try{r=new s(r,a)}catch{return!1}return r.test(t)},fc}var hc,lg;function mE(){if(lg)return hc;lg=1;const s=sn();return hc=(t,r)=>new s(t,r).set.map(a=>a.map(o=>o.value).join(" ").trim().split(" ")),hc}var pc,cg;function gE(){if(cg)return pc;cg=1;const s=yt(),e=sn();return pc=(r,a,o)=>{let l=null,c=null,f=null;try{f=new e(a,o)}catch{return null}return r.forEach(h=>{f.test(h)&&(!l||c.compare(h)===-1)&&(l=h,c=new s(l,o))}),l},pc}var mc,dg;function yE(){if(dg)return mc;dg=1;const s=yt(),e=sn();return mc=(r,a,o)=>{let l=null,c=null,f=null;try{f=new e(a,o)}catch{return null}return r.forEach(h=>{f.test(h)&&(!l||c.compare(h)===1)&&(l=h,c=new s(l,o))}),l},mc}var gc,fg;function _E(){if(fg)return gc;fg=1;const s=yt(),e=sn(),t=go();return gc=(a,o)=>{a=new e(a,o);let l=new s("0.0.0");if(a.test(l)||(l=new s("0.0.0-0"),a.test(l)))return l;l=null;for(let c=0;c<a.set.length;++c){const f=a.set[c];let h=null;f.forEach(m=>{const _=new s(m.semver.version);switch(m.operator){case">":_.prerelease.length===0?_.patch++:_.prerelease.push(0),_.raw=_.format();case"":case">=":(!h||t(_,h))&&(h=_);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${m.operator}`)}}),h&&(!l||t(l,h))&&(l=h)}return l&&a.test(l)?l:null},gc}var yc,hg;function vE(){if(hg)return yc;hg=1;const s=sn();return yc=(t,r)=>{try{return new s(t,r).range||"*"}catch{return null}},yc}var _c,pg;function hd(){if(pg)return _c;pg=1;const s=yt(),e=yo(),{ANY:t}=e,r=sn(),a=_o(),o=go(),l=cd(),c=fd(),f=dd();return _c=(m,_,y,w)=>{m=new s(m,w),_=new r(_,w);let b,E,S,O,R;switch(y){case">":b=o,E=c,S=l,O=">",R=">=";break;case"<":b=l,E=f,S=o,O="<",R="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(a(m,_,w))return!1;for(let T=0;T<_.set.length;++T){const $=_.set[T];let P=null,z=null;if($.forEach(Q=>{Q.semver===t&&(Q=new e(">=0.0.0")),P=P||Q,z=z||Q,b(Q.semver,P.semver,w)?P=Q:S(Q.semver,z.semver,w)&&(z=Q)}),P.operator===O||P.operator===R||(!z.operator||z.operator===O)&&E(m,z.semver))return!1;if(z.operator===R&&S(m,z.semver))return!1}return!0},_c}var vc,mg;function wE(){if(mg)return vc;mg=1;const s=hd();return vc=(t,r,a)=>s(t,r,">",a),vc}var wc,gg;function bE(){if(gg)return wc;gg=1;const s=hd();return wc=(t,r,a)=>s(t,r,"<",a),wc}var bc,yg;function EE(){if(yg)return bc;yg=1;const s=sn();return bc=(t,r,a)=>(t=new s(t,a),r=new s(r,a),t.intersects(r,a)),bc}var Ec,_g;function SE(){if(_g)return Ec;_g=1;const s=_o(),e=rn();return Ec=(t,r,a)=>{const o=[];let l=null,c=null;const f=t.sort((y,w)=>e(y,w,a));for(const y of f)s(y,r,a)?(c=y,l||(l=y)):(c&&o.push([l,c]),c=null,l=null);l&&o.push([l,null]);const h=[];for(const[y,w]of o)y===w?h.push(y):!w&&y===f[0]?h.push("*"):w?y===f[0]?h.push(`<=${w}`):h.push(`${y} - ${w}`):h.push(`>=${y}`);const m=h.join(" || "),_=typeof r.raw=="string"?r.raw:String(r);return m.length<_.length?m:r},Ec}var Sc,vg;function OE(){if(vg)return Sc;vg=1;const s=sn(),e=yo(),{ANY:t}=e,r=_o(),a=rn(),o=(_,y,w={})=>{if(_===y)return!0;_=new s(_,w),y=new s(y,w);let b=!1;e:for(const E of _.set){for(const S of y.set){const O=f(E,S,w);if(b=b||O!==null,O)continue e}if(b)return!1}return!0},l=[new e(">=0.0.0-0")],c=[new e(">=0.0.0")],f=(_,y,w)=>{if(_===y)return!0;if(_.length===1&&_[0].semver===t){if(y.length===1&&y[0].semver===t)return!0;w.includePrerelease?_=l:_=c}if(y.length===1&&y[0].semver===t){if(w.includePrerelease)return!0;y=c}const b=new Set;let E,S;for(const W of _)W.operator===">"||W.operator===">="?E=h(E,W,w):W.operator==="<"||W.operator==="<="?S=m(S,W,w):b.add(W.semver);if(b.size>1)return null;let O;if(E&&S){if(O=a(E.semver,S.semver,w),O>0)return null;if(O===0&&(E.operator!==">="||S.operator!=="<="))return null}for(const W of b){if(E&&!r(W,String(E),w)||S&&!r(W,String(S),w))return null;for(const Ee of y)if(!r(W,String(Ee),w))return!1;return!0}let R,T,$,P,z=S&&!w.includePrerelease&&S.semver.prerelease.length?S.semver:!1,Q=E&&!w.includePrerelease&&E.semver.prerelease.length?E.semver:!1;z&&z.prerelease.length===1&&S.operator==="<"&&z.prerelease[0]===0&&(z=!1);for(const W of y){if(P=P||W.operator===">"||W.operator===">=",$=$||W.operator==="<"||W.operator==="<=",E){if(Q&&W.semver.prerelease&&W.semver.prerelease.length&&W.semver.major===Q.major&&W.semver.minor===Q.minor&&W.semver.patch===Q.patch&&(Q=!1),W.operator===">"||W.operator===">="){if(R=h(E,W,w),R===W&&R!==E)return!1}else if(E.operator===">="&&!r(E.semver,String(W),w))return!1}if(S){if(z&&W.semver.prerelease&&W.semver.prerelease.length&&W.semver.major===z.major&&W.semver.minor===z.minor&&W.semver.patch===z.patch&&(z=!1),W.operator==="<"||W.operator==="<="){if(T=m(S,W,w),T===W&&T!==S)return!1}else if(S.operator==="<="&&!r(S.semver,String(W),w))return!1}if(!W.operator&&(S||E)&&O!==0)return!1}return!(E&&$&&!S&&O!==0||S&&P&&!E&&O!==0||Q||z)},h=(_,y,w)=>{if(!_)return y;const b=a(_.semver,y.semver,w);return b>0?_:b<0||y.operator===">"&&_.operator===">="?y:_},m=(_,y,w)=>{if(!_)return y;const b=a(_.semver,y.semver,w);return b<0?_:b>0||y.operator==="<"&&_.operator==="<="?y:_};return Sc=o,Sc}var Oc,wg;function kE(){if(wg)return Oc;wg=1;const s=bs(),e=po(),t=yt(),r=gy(),a=li(),o=tE(),l=nE(),c=rE(),f=iE(),h=sE(),m=aE(),_=oE(),y=uE(),w=rn(),b=lE(),E=cE(),S=ld(),O=dE(),R=fE(),T=go(),$=cd(),P=yy(),z=_y(),Q=dd(),W=fd(),Ee=vy(),Ae=hE(),He=yo(),Ue=sn(),Ge=_o(),K=mE(),G=gE(),ee=yE(),J=_E(),D=vE(),U=hd(),M=wE(),I=bE(),j=EE(),te=SE(),le=OE();return Oc={parse:a,valid:o,clean:l,inc:c,diff:f,major:h,minor:m,patch:_,prerelease:y,compare:w,rcompare:b,compareLoose:E,compareBuild:S,sort:O,rsort:R,gt:T,lt:$,eq:P,neq:z,gte:Q,lte:W,cmp:Ee,coerce:Ae,Comparator:He,Range:Ue,satisfies:Ge,toComparators:K,maxSatisfying:G,minSatisfying:ee,minVersion:J,validRange:D,outside:U,gtr:M,ltr:I,intersects:j,simplifyRange:te,subset:le,SemVer:t,re:s.re,src:s.src,tokens:s.t,SEMVER_SPEC_VERSION:e.SEMVER_SPEC_VERSION,RELEASE_TYPES:e.RELEASE_TYPES,compareIdentifiers:r.compareIdentifiers,rcompareIdentifiers:r.rcompareIdentifiers},Oc}kE();function qn(s){if(!s||s.split("/").length>2||s.startsWith("/")||s.endsWith("/")||s.split(":").length>2)throw new Error(`Invalid identifier format: ${s}`);const[e,t]=s.split(":"),r=t||"latest";if(e.includes("/")){const[a,o]=e.split("/",2);if(!a||!o)throw new Error(`Invalid identifier format: ${s}`);return[a,o,r]}else{if(!e)throw new Error(`Invalid identifier format: ${s}`);return["-",e,r]}}class TE extends Error{constructor(e){super(e),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="LangSmithConflictError",this.status=409}}async function ue(s,e,t){let r;if(s.ok){t&&(r=await s.text());return}if(s.status===403)try{const l=await s.json();(l==null?void 0:l.error)==="org_scoped_key_requires_workspace"&&(r="This API key is org-scoped and requires workspace specification. Please provide 'workspaceId' parameter, or set LANGSMITH_WORKSPACE_ID environment variable.")}catch{const c=new Error(`${s.status} ${s.statusText}`);throw c.status=s==null?void 0:s.status,c}if(r===void 0)try{r=await s.text()}catch{r=""}const a=`Failed to ${e}. Received status [${s.status}]: ${s.statusText}. Message: ${r}`;if(s.status===409)throw new TE(a);const o=new Error(a);throw o.status=s.status,o}const wy="ERR_CONFLICTING_ENDPOINTS";class xE extends Error{constructor(){super("You cannot provide both LANGSMITH_ENDPOINT / LANGCHAIN_ENDPOINT and LANGSMITH_RUNS_ENDPOINTS."),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:wy}),this.name="ConflictingEndpointsError"}}function RE(s){return typeof s=="object"&&s!==null&&s.code===wy}var bg="[...]",IE={result:"[Circular]"},no=[],ei=[];const CE=new TextEncoder;function NE(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function Fa(s){return CE.encode(s)}function by(s){if(s&&typeof s=="object"&&s!==null){if(s instanceof Map)return Object.fromEntries(s);if(s instanceof Set)return Array.from(s);if(s instanceof Date)return s.toISOString();if(s instanceof RegExp)return s.toString();if(s instanceof Error)return{name:s.name,message:s.message}}else if(typeof s=="bigint")return s.toString();return s}function AE(s){return function(e,t){return by(t)}}function Pt(s,e,t,r,a){var o;try{const l=JSON.stringify(s,AE(t),r);return Fa(l)}catch(l){if(!((o=l.message)!=null&&o.includes("Converting circular structure to JSON")))return console.warn(`[WARNING]: LangSmith received unserializable value.${e?`
Context: ${e}`:""}`),Fa("[Unserializable]");xt("SUPPRESS_CIRCULAR_JSON_WARNINGS")!=="true"&&console.warn(`[WARNING]: LangSmith received circular JSON. This will decrease tracer performance. ${e?`
Context: ${e}`:""}`),typeof a>"u"&&(a=NE()),Kc(s,"",0,[],void 0,0,a);let c;try{ei.length===0?c=JSON.stringify(s,t,r):c=JSON.stringify(s,PE(t),r)}catch{return Fa("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;no.length!==0;){const f=no.pop();f.length===4?Object.defineProperty(f[0],f[1],f[3]):f[0][f[1]]=f[2]}}return Fa(c)}}function kc(s,e,t,r){var a=Object.getOwnPropertyDescriptor(r,t);a.get!==void 0?a.configurable?(Object.defineProperty(r,t,{value:s}),no.push([r,t,e,a])):ei.push([e,t,s]):(r[t]=s,no.push([r,t,e]))}function Kc(s,e,t,r,a,o,l){o+=1;var c;if(typeof s=="object"&&s!==null){for(c=0;c<r.length;c++)if(r[c]===s){kc(IE,s,e,a);return}if(typeof l.depthLimit<"u"&&o>l.depthLimit){kc(bg,s,e,a);return}if(typeof l.edgesLimit<"u"&&t+1>l.edgesLimit){kc(bg,s,e,a);return}if(r.push(s),Array.isArray(s))for(c=0;c<s.length;c++)Kc(s[c],c,c,r,s,o,l);else{s=by(s);var f=Object.keys(s);for(c=0;c<f.length;c++){var h=f[c];Kc(s[h],h,c,r,s,o,l)}}r.pop()}}function PE(s){return s=typeof s<"u"?s:function(e,t){return t},function(e,t){if(ei.length>0)for(var r=0;r<ei.length;r++){var a=ei[r];if(a[1]===e&&a[0]===t){t=a[2],ei.splice(r,1);break}}return s.call(this,e,t)}}function Eg(s,e,t){if(t)return s;const r=fy(),a=e??hy(),o=s.extra??{},l=o.metadata;return s.extra={...o,runtime:{...r,...o==null?void 0:o.runtime},metadata:{...a,...a.revision_id||"revision_id"in s&&s.revision_id?{revision_id:("revision_id"in s?s.revision_id:void 0)??a.revision_id}:{},...l}},s}const LE=s=>{const e=(s==null?void 0:s.toString())??xt("TRACING_SAMPLING_RATE");if(e===void 0)return;const t=parseFloat(e);if(t<0||t>1)throw new Error(`LANGSMITH_TRACING_SAMPLING_RATE must be between 0 and 1 if set. Got: ${t}`);return t},jE=s=>{const t=s.replace("http://","").replace("https://","").split("/")[0].split(":")[0];return t==="localhost"||t==="127.0.0.1"||t==="::1"};async function $E(s){const e=[];for await(const t of s)e.push(t);return e}function Ba(s){if(s!==void 0)return s.trim().replace(/^"(.*)"$/,"$1").replace(/^'(.*)'$/,"$1")}const DE=async s=>{if((s==null?void 0:s.status)===429){const e=parseInt(s.headers.get("retry-after")??"10",10)*1e3;if(e>0)return await new Promise(t=>setTimeout(t,e)),!0}return!1};function Sg(s){return typeof s=="number"?Number(s.toFixed(4)):s}const ME=24*1024*1024,Ey=1024*1024*1024,UE=1e4,zE=100,Og="https://api.smith.langchain.com";class FE{constructor(e){Object.defineProperty(this,"items",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"sizeBytes",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"maxSizeBytes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSizeBytes=e??Ey}peek(){return this.items[0]}push(e){let t;const r=new Promise(o=>{t=o}),a=Pt(e.item,`Serializing run with id: ${e.item.id}`).length;return this.sizeBytes+a>this.maxSizeBytes&&this.items.length>0?(console.warn(`AutoBatchQueue size limit (${this.maxSizeBytes} bytes) exceeded. Dropping run with id: ${e.item.id}. Current queue size: ${this.sizeBytes} bytes, attempted addition: ${a} bytes.`),t(),r):(this.items.push({action:e.action,payload:e.item,otelContext:e.otelContext,apiKey:e.apiKey,apiUrl:e.apiUrl,itemPromiseResolve:t,itemPromise:r,size:a}),this.sizeBytes+=a,r)}pop({upToSizeBytes:e,upToSize:t}){var o;if(e<1)throw new Error("Number of bytes to pop off may not be less than 1.");const r=[];let a=0;for(;a+(((o=this.peek())==null?void 0:o.size)??0)<e&&this.items.length>0&&r.length<t;){const l=this.items.shift();l&&(r.push(l),a+=l.size,this.sizeBytes-=l.size)}if(r.length===0&&this.items.length>0){const l=this.items.shift();r.push(l),a+=l.size,this.sizeBytes-=l.size}return[r.map(l=>({action:l.action,item:l.payload,otelContext:l.otelContext,apiKey:l.apiKey,apiUrl:l.apiUrl,size:l.size})),()=>r.forEach(l=>l.itemPromiseResolve())]}}class ys{get _fetch(){return this.fetchImplementation||_b(this.debug)}constructor(e={}){var a;Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"webUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"workspaceId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"batchIngestCaller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout_ms",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tenantId",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"hideInputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"hideOutputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"omitTracedRuntimeInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tracingSampleRate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"filteredPostUuids",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"autoBatchTracing",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"autoBatchQueue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"autoBatchTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"autoBatchAggregationDelayMs",{enumerable:!0,configurable:!0,writable:!0,value:250}),Object.defineProperty(this,"batchSizeBytesLimit",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"batchSizeLimit",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fetchOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"settings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"blockOnRootRunFinalization",{enumerable:!0,configurable:!0,writable:!0,value:hn("LANGSMITH_TRACING_BACKGROUND")==="false"}),Object.defineProperty(this,"traceBatchConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:5}),Object.defineProperty(this,"_serverInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_getServerInfoPromise",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"manualFlushMode",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"langSmithToOTELTranslator",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fetchImplementation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cachedLSEnvVarsForMetadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"multipartStreamingDisabled",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"debug",{enumerable:!0,configurable:!0,writable:!0,value:hn("LANGSMITH_DEBUG")==="true"});const t=ys.getDefaultClientConfig();if(this.tracingSampleRate=LE(e.tracingSamplingRate),this.apiUrl=Ba(e.apiUrl??t.apiUrl)??"",this.apiUrl.endsWith("/")&&(this.apiUrl=this.apiUrl.slice(0,-1)),this.apiKey=Ba(e.apiKey??t.apiKey),this.webUrl=Ba(e.webUrl??t.webUrl),(a=this.webUrl)!=null&&a.endsWith("/")&&(this.webUrl=this.webUrl.slice(0,-1)),this.workspaceId=Ba(e.workspaceId??xt("WORKSPACE_ID")),this.timeout_ms=e.timeout_ms??9e4,this.caller=new xm({...e.callerOptions??{},maxRetries:4,debug:e.debug??this.debug}),this.traceBatchConcurrency=e.traceBatchConcurrency??this.traceBatchConcurrency,this.traceBatchConcurrency<1)throw new Error("Trace batch concurrency must be positive.");this.debug=e.debug??this.debug,this.fetchImplementation=e.fetchImplementation;const r=e.maxIngestMemoryBytes??Ey;this.batchIngestCaller=new xm({maxRetries:4,maxConcurrency:this.traceBatchConcurrency,maxQueueSizeBytes:r,...e.callerOptions??{},onFailedResponseHook:DE,debug:e.debug??this.debug}),this.hideInputs=e.hideInputs??e.anonymizer??t.hideInputs,this.hideOutputs=e.hideOutputs??e.anonymizer??t.hideOutputs,this.omitTracedRuntimeInfo=e.omitTracedRuntimeInfo??!1,this.autoBatchTracing=e.autoBatchTracing??this.autoBatchTracing,this.autoBatchQueue=new FE(r),this.blockOnRootRunFinalization=e.blockOnRootRunFinalization??this.blockOnRootRunFinalization,this.batchSizeBytesLimit=e.batchSizeBytesLimit,this.batchSizeLimit=e.batchSizeLimit,this.fetchOptions=e.fetchOptions||{},this.manualFlushMode=e.manualFlushMode??this.manualFlushMode,py()&&(this.langSmithToOTELTranslator=new Db),this.cachedLSEnvVarsForMetadata=hy()}static getDefaultClientConfig(){const e=xt("API_KEY"),t=xt("ENDPOINT")??Og,r=xt("HIDE_INPUTS")==="true",a=xt("HIDE_OUTPUTS")==="true";return{apiUrl:t,apiKey:e,webUrl:void 0,hideInputs:r,hideOutputs:a}}getHostUrl(){return this.webUrl?this.webUrl:jE(this.apiUrl)?(this.webUrl="http://localhost:3000",this.webUrl):this.apiUrl.endsWith("/api/v1")?(this.webUrl=this.apiUrl.replace("/api/v1",""),this.webUrl):this.apiUrl.includes("/api")&&!this.apiUrl.split(".",1)[0].endsWith("api")?(this.webUrl=this.apiUrl.replace("/api",""),this.webUrl):this.apiUrl.split(".",1)[0].includes("dev")?(this.webUrl="https://dev.smith.langchain.com",this.webUrl):this.apiUrl.split(".",1)[0].includes("eu")?(this.webUrl="https://eu.smith.langchain.com",this.webUrl):this.apiUrl.split(".",1)[0].includes("beta")?(this.webUrl="https://beta.smith.langchain.com",this.webUrl):(this.webUrl="https://smith.langchain.com",this.webUrl)}get headers(){const e={"User-Agent":`langsmith-js/${ly}`};return this.apiKey&&(e["x-api-key"]=`${this.apiKey}`),this.workspaceId&&(e["x-tenant-id"]=this.workspaceId),e}_getPlatformEndpointPath(e){return this.apiUrl.slice(-3)!=="/v1"&&this.apiUrl.slice(-4)!=="/v1/"?`/v1/platform/${e}`:`/platform/${e}`}async processInputs(e){return this.hideInputs===!1?e:this.hideInputs===!0?{}:typeof this.hideInputs=="function"?this.hideInputs(e):e}async processOutputs(e){return this.hideOutputs===!1?e:this.hideOutputs===!0?{}:typeof this.hideOutputs=="function"?this.hideOutputs(e):e}async prepareRunCreateOrUpdateInputs(e){const t={...e};return t.inputs!==void 0&&(t.inputs=await this.processInputs(t.inputs)),t.outputs!==void 0&&(t.outputs=await this.processOutputs(t.outputs)),t}async _getResponse(e,t){const r=(t==null?void 0:t.toString())??"",a=`${this.apiUrl}${e}?${r}`;return await this.caller.call(async()=>{const l=await this._fetch(a,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ue(l,`fetch ${e}`),l})}async _get(e,t){return(await this._getResponse(e,t)).json()}async*_getPaginated(e,t=new URLSearchParams,r){let a=Number(t.get("offset"))||0;const o=Number(t.get("limit"))||100;for(;;){t.set("offset",String(a)),t.set("limit",String(o));const l=`${this.apiUrl}${e}?${t}`,c=await this.caller.call(async()=>{const h=await this._fetch(l,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ue(h,`fetch ${e}`),h}),f=r?r(await c.json()):await c.json();if(f.length===0||(yield f,f.length<o))break;a+=f.length}}async*_getCursorPaginatedList(e,t=null,r="POST",a="runs"){const o=t?{...t}:{};for(;;){const l=JSON.stringify(o),f=await(await this.caller.call(async()=>{const m=await this._fetch(`${this.apiUrl}${e}`,{method:r,headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:l});return await ue(m,`fetch ${e}`),m})).json();if(!f||!f[a])break;yield f[a];const h=f.cursors;if(!h||!h.next)break;o.cursor=h.next}}_shouldSample(){return this.tracingSampleRate===void 0?!0:Math.random()<this.tracingSampleRate}_filterForSampling(e,t=!1){if(this.tracingSampleRate===void 0)return e;if(t){const r=[];for(const a of e)this.filteredPostUuids.has(a.trace_id)?a.id===a.trace_id&&this.filteredPostUuids.delete(a.trace_id):r.push(a);return r}else{const r=[];for(const a of e){const o=a.trace_id??a.id;this.filteredPostUuids.has(o)||(a.id===o?this._shouldSample()?r.push(a):this.filteredPostUuids.add(o):r.push(a))}return r}}async _getBatchSizeLimitBytes(){var t;const e=await this._ensureServerInfo();return this.batchSizeBytesLimit??((t=e.batch_ingest_config)==null?void 0:t.size_limit_bytes)??ME}async _getBatchSizeLimit(){var t;const e=await this._ensureServerInfo();return this.batchSizeLimit??((t=e.batch_ingest_config)==null?void 0:t.size_limit)??zE}async _getDatasetExamplesMultiPartSupport(){var t;return((t=(await this._ensureServerInfo()).instance_flags)==null?void 0:t.dataset_examples_multipart_enabled)??!1}drainAutoBatchQueue({batchSizeLimitBytes:e,batchSizeLimit:t}){const r=[];for(;this.autoBatchQueue.items.length>0;){const[a,o]=this.autoBatchQueue.pop({upToSizeBytes:e,upToSize:t});if(!a.length){o();break}const l=a.reduce((h,m)=>{const _=m.apiUrl??this.apiUrl,y=m.apiKey??this.apiKey,b=m.apiKey===this.apiKey&&m.apiUrl===this.apiUrl?"default":`${_}|${y}`;return h[b]||(h[b]=[]),h[b].push(m),h},{}),c=[];for(const[h,m]of Object.entries(l)){const _=this._processBatch(m,{apiUrl:h==="default"?void 0:h.split("|")[0],apiKey:h==="default"?void 0:h.split("|")[1]});c.push(_)}const f=Promise.all(c).finally(o);r.push(f)}return Promise.all(r)}async _processBatch(e,t){var a,o;if(!e.length)return;const r=e.reduce((l,c)=>l+(c.size??0),0);try{if(this.langSmithToOTELTranslator!==void 0)this._sendBatchToOTELTranslator(e);else{const l={runCreates:e.filter(f=>f.action==="create").map(f=>f.item),runUpdates:e.filter(f=>f.action==="update").map(f=>f.item)},c=await this._ensureServerInfo();if((a=c==null?void 0:c.batch_ingest_config)!=null&&a.use_multipart_endpoint){const f=(o=c==null?void 0:c.instance_flags)==null?void 0:o.gzip_body_enabled;await this.multipartIngestRuns(l,{...t,useGzip:f,sizeBytes:r})}else await this.batchIngestRuns(l,{...t,sizeBytes:r})}}catch(l){console.error("Error exporting batch:",l)}}_sendBatchToOTELTranslator(e){if(this.langSmithToOTELTranslator!==void 0){const t=new Map,r=[];for(const a of e)a.item.id&&a.otelContext&&(t.set(a.item.id,a.otelContext),a.action==="create"?r.push({operation:"post",id:a.item.id,trace_id:a.item.trace_id??a.item.id,run:a.item}):r.push({operation:"patch",id:a.item.id,trace_id:a.item.trace_id??a.item.id,run:a.item}));this.langSmithToOTELTranslator.exportBatch(r,t)}}async processRunOperation(e){clearTimeout(this.autoBatchTimeout),this.autoBatchTimeout=void 0,e.item=Eg(e.item,this.cachedLSEnvVarsForMetadata,this.omitTracedRuntimeInfo);const t=this.autoBatchQueue.push(e);if(this.manualFlushMode)return t;const r=await this._getBatchSizeLimitBytes(),a=await this._getBatchSizeLimit();return(this.autoBatchQueue.sizeBytes>r||this.autoBatchQueue.items.length>a)&&this.drainAutoBatchQueue({batchSizeLimitBytes:r,batchSizeLimit:a}),this.autoBatchQueue.items.length>0&&(this.autoBatchTimeout=setTimeout(()=>{this.autoBatchTimeout=void 0,this.drainAutoBatchQueue({batchSizeLimitBytes:r,batchSizeLimit:a})},this.autoBatchAggregationDelayMs)),t}async _getServerInfo(){const t=await(await this.caller.call(async()=>{const r=await this._fetch(`${this.apiUrl}/info`,{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(UE),...this.fetchOptions});return await ue(r,"get server info"),r})).json();return this.debug&&console.log(`
=== LangSmith Server Configuration ===
`+JSON.stringify(t,null,2)+`
`),t}async _ensureServerInfo(){return this._getServerInfoPromise===void 0&&(this._getServerInfoPromise=(async()=>{if(this._serverInfo===void 0)try{this._serverInfo=await this._getServerInfo()}catch(e){console.warn(`[LANGSMITH]: Failed to fetch info on supported operations. Falling back to batch operations and default limits. Info: ${e.status??"Unspecified status code"} ${e.message}`)}return this._serverInfo??{}})()),this._getServerInfoPromise.then(e=>(this._serverInfo===void 0&&(this._getServerInfoPromise=void 0),e))}async _getSettings(){return this.settings||(this.settings=this._get("/settings")),await this.settings}async flush(){const e=await this._getBatchSizeLimitBytes(),t=await this._getBatchSizeLimit();await this.drainAutoBatchQueue({batchSizeLimitBytes:e,batchSizeLimit:t})}_cloneCurrentOTELContext(){const e=my(),t=Pb();if(this.langSmithToOTELTranslator!==void 0){const r=e.getActiveSpan();if(r)return e.setSpan(t.active(),r)}}async createRun(e,t){if(!this._filterForSampling([e]).length)return;const r={...this.headers,"Content-Type":"application/json"},a=e.project_name;delete e.project_name;const o=await this.prepareRunCreateOrUpdateInputs({session_name:a,...e,start_time:e.start_time??Date.now()});if(this.autoBatchTracing&&o.trace_id!==void 0&&o.dotted_order!==void 0){const f=this._cloneCurrentOTELContext();this.processRunOperation({action:"create",item:o,otelContext:f,apiKey:t==null?void 0:t.apiKey,apiUrl:t==null?void 0:t.apiUrl}).catch(console.error);return}const l=Eg(o,this.cachedLSEnvVarsForMetadata,this.omitTracedRuntimeInfo);(t==null?void 0:t.apiKey)!==void 0&&(r["x-api-key"]=t.apiKey),(t==null?void 0:t.workspaceId)!==void 0&&(r["x-tenant-id"]=t.workspaceId);const c=Pt(l,`Creating run with id: ${l.id}`);await this.caller.call(async()=>{const f=await this._fetch(`${(t==null?void 0:t.apiUrl)??this.apiUrl}/runs`,{method:"POST",headers:r,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:c});return await ue(f,"create run",!0),f})}async batchIngestRuns({runCreates:e,runUpdates:t},r){if(e===void 0&&t===void 0)return;let a=await Promise.all((e==null?void 0:e.map(f=>this.prepareRunCreateOrUpdateInputs(f)))??[]),o=await Promise.all((t==null?void 0:t.map(f=>this.prepareRunCreateOrUpdateInputs(f)))??[]);if(a.length>0&&o.length>0){const f=a.reduce((m,_)=>(_.id&&(m[_.id]=_),m),{}),h=[];for(const m of o)m.id!==void 0&&f[m.id]?f[m.id]={...f[m.id],...m}:h.push(m);a=Object.values(f),o=h}const l={post:a,patch:o};if(!l.post.length&&!l.patch.length)return;const c={post:[],patch:[]};for(const f of["post","patch"]){const h=f,m=l[h].reverse();let _=m.pop();for(;_!==void 0;)c[h].push(_),_=m.pop()}if(c.post.length>0||c.patch.length>0){const f=c.post.map(h=>h.id).concat(c.patch.map(h=>h.id)).join(",");await this._postBatchIngestRuns(Pt(c,`Ingesting runs with ids: ${f}`),r)}}async _postBatchIngestRuns(e,t){const r={...this.headers,"Content-Type":"application/json",Accept:"application/json"};(t==null?void 0:t.apiKey)!==void 0&&(r["x-api-key"]=t.apiKey),await this.batchIngestCaller.callWithOptions({sizeBytes:t==null?void 0:t.sizeBytes},async()=>{const a=await this._fetch(`${(t==null?void 0:t.apiUrl)??this.apiUrl}/runs/batch`,{method:"POST",headers:r,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:e});return await ue(a,"batch create run",!0),a})}async multipartIngestRuns({runCreates:e,runUpdates:t},r){if(e===void 0&&t===void 0)return;const a={};let o=[];for(const _ of e??[]){const y=await this.prepareRunCreateOrUpdateInputs(_);y.id!==void 0&&y.attachments!==void 0&&(a[y.id]=y.attachments),delete y.attachments,o.push(y)}let l=[];for(const _ of t??[])l.push(await this.prepareRunCreateOrUpdateInputs(_));if(o.find(_=>_.trace_id===void 0||_.dotted_order===void 0)!==void 0)throw new Error('Multipart ingest requires "trace_id" and "dotted_order" to be set when creating a run');if(l.find(_=>_.trace_id===void 0||_.dotted_order===void 0)!==void 0)throw new Error('Multipart ingest requires "trace_id" and "dotted_order" to be set when updating a run');if(o.length>0&&l.length>0){const _=o.reduce((w,b)=>(b.id&&(w[b.id]=b),w),{}),y=[];for(const w of l)w.id!==void 0&&_[w.id]?_[w.id]={..._[w.id],...w}:y.push(w);o=Object.values(_),l=y}if(o.length===0&&l.length===0)return;const h=[],m=[];for(const[_,y]of[["post",o],["patch",l]])for(const w of y){const{inputs:b,outputs:E,events:S,extra:O,error:R,serialized:T,attachments:$,...P}=w,z={inputs:b,outputs:E,events:S,extra:O,error:R,serialized:T},Q=Pt(P,`Serializing for multipart ingestion of run with id: ${P.id}`);m.push({name:`${_}.${P.id}`,payload:new Blob([Q],{type:`application/json; length=${Q.length}`})});for(const[W,Ee]of Object.entries(z)){if(Ee===void 0)continue;const Ae=Pt(Ee,`Serializing ${W} for multipart ingestion of run with id: ${P.id}`);m.push({name:`${_}.${P.id}.${W}`,payload:new Blob([Ae],{type:`application/json; length=${Ae.length}`})})}if(P.id!==void 0){const W=a[P.id];if(W){delete a[P.id];for(const[Ee,Ae]of Object.entries(W)){let He,Ue;if(Array.isArray(Ae)?[He,Ue]=Ae:(He=Ae.mimeType,Ue=Ae.data),Ee.includes(".")){console.warn(`Skipping attachment '${Ee}' for run ${P.id}: Invalid attachment name. Attachment names must not contain periods ('.'). Please rename the attachment and try again.`);continue}m.push({name:`attachment.${P.id}.${Ee}`,payload:new Blob([Ue],{type:`${He}; length=${Ue.byteLength}`})})}}}h.push(`trace=${P.trace_id},id=${P.id}`)}await this._sendMultipartRequest(m,h.join("; "),r)}async _createNodeFetchBody(e,t){const r=[];for(const l of e)r.push(new Blob([`--${t}\r
`])),r.push(new Blob([`Content-Disposition: form-data; name="${l.name}"\r
`,`Content-Type: ${l.payload.type}\r
\r
`])),r.push(l.payload),r.push(new Blob([`\r
`]));return r.push(new Blob([`--${t}--\r
`])),await new Blob(r).arrayBuffer()}async _createMultipartStream(e,t){const r=new TextEncoder;return new ReadableStream({async start(o){const l=async c=>{typeof c=="string"?o.enqueue(r.encode(c)):o.enqueue(c)};for(const c of e){await l(`--${t}\r
`),await l(`Content-Disposition: form-data; name="${c.name}"\r
`),await l(`Content-Type: ${c.payload.type}\r
\r
`);const h=c.payload.stream().getReader();try{let m;for(;!(m=await h.read()).done;)o.enqueue(m.value)}finally{h.releaseLock()}await l(`\r
`)}await l(`--${t}--\r
`),o.close()}})}async _sendMultipartRequest(e,t,r){const a="----LangSmithFormBoundary"+Math.random().toString(36).slice(2),o=yb(),l=()=>this._createNodeFetchBody(e,a),c=()=>this._createMultipartStream(e,a),f=async h=>this.batchIngestCaller.callWithOptions({sizeBytes:r==null?void 0:r.sizeBytes},async()=>{const m=await h(),_={...this.headers,"Content-Type":`multipart/form-data; boundary=${a}`};(r==null?void 0:r.apiKey)!==void 0&&(_["x-api-key"]=r.apiKey);let y=m;r!=null&&r.useGzip&&typeof m=="object"&&"pipeThrough"in m&&(y=m.pipeThrough(new CompressionStream("gzip")),_["Content-Encoding"]="gzip");const w=await this._fetch(`${(r==null?void 0:r.apiUrl)??this.apiUrl}/runs/multipart`,{method:"POST",headers:_,body:y,duplex:"half",signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ue(w,"Failed to send multipart request",!0),w});try{let h,m=!1;!o&&!this.multipartStreamingDisabled&&dy()!=="bun"?(m=!0,h=await f(c)):h=await f(l),(!this.multipartStreamingDisabled||m)&&h.status===422&&((r==null?void 0:r.apiUrl)??this.apiUrl)!==Og&&(console.warn(`Streaming multipart upload to ${(r==null?void 0:r.apiUrl)??this.apiUrl}/runs/multipart failed. This usually means the host does not support chunked uploads. Retrying with a buffered upload for operation "${t}".`),this.multipartStreamingDisabled=!0,h=await f(l))}catch(h){console.warn(`${h.message.trim()}

Context: ${t}`)}}async updateRun(e,t,r){pe(e),t.inputs&&(t.inputs=await this.processInputs(t.inputs)),t.outputs&&(t.outputs=await this.processOutputs(t.outputs));const a={...t,id:e};if(!this._filterForSampling([a],!0).length)return;if(this.autoBatchTracing&&a.trace_id!==void 0&&a.dotted_order!==void 0){const c=this._cloneCurrentOTELContext();if(t.end_time!==void 0&&a.parent_run_id===void 0&&this.blockOnRootRunFinalization&&!this.manualFlushMode){await this.processRunOperation({action:"update",item:a,otelContext:c,apiKey:r==null?void 0:r.apiKey,apiUrl:r==null?void 0:r.apiUrl}).catch(console.error);return}else this.processRunOperation({action:"update",item:a,otelContext:c,apiKey:r==null?void 0:r.apiKey,apiUrl:r==null?void 0:r.apiUrl}).catch(console.error);return}const o={...this.headers,"Content-Type":"application/json"};(r==null?void 0:r.apiKey)!==void 0&&(o["x-api-key"]=r.apiKey),(r==null?void 0:r.workspaceId)!==void 0&&(o["x-tenant-id"]=r.workspaceId);const l=Pt(t,`Serializing payload to update run with id: ${e}`);await this.caller.call(async()=>{const c=await this._fetch(`${(r==null?void 0:r.apiUrl)??this.apiUrl}/runs/${e}`,{method:"PATCH",headers:o,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:l});return await ue(c,"update run",!0),c})}async readRun(e,{loadChildRuns:t}={loadChildRuns:!1}){pe(e);let r=await this._get(`/runs/${e}`);return t&&(r=await this._loadChildRuns(r)),r}async getRunUrl({runId:e,run:t,projectOpts:r}){if(t!==void 0){let a;t.session_id?a=t.session_id:r!=null&&r.projectName?a=(await this.readProject({projectName:r==null?void 0:r.projectName})).id:r!=null&&r.projectId?a=r==null?void 0:r.projectId:a=(await this.readProject({projectName:xt("PROJECT")||"default"})).id;const o=await this._getTenantId();return`${this.getHostUrl()}/o/${o}/projects/p/${a}/r/${t.id}?poll=true`}else if(e!==void 0){const a=await this.readRun(e);if(!a.app_path)throw new Error(`Run ${e} has no app_path`);return`${this.getHostUrl()}${a.app_path}`}else throw new Error("Must provide either runId or run")}async _loadChildRuns(e){var o;const t=await $E(this.listRuns({isRoot:!1,projectId:e.session_id,traceId:e.trace_id})),r={},a={};t.sort((l,c)=>((l==null?void 0:l.dotted_order)??"").localeCompare((c==null?void 0:c.dotted_order)??""));for(const l of t){if(l.parent_run_id===null||l.parent_run_id===void 0)throw new Error(`Child run ${l.id} has no parent`);(o=l.dotted_order)!=null&&o.startsWith(e.dotted_order??"")&&l.id!==e.id&&(l.parent_run_id in r||(r[l.parent_run_id]=[]),r[l.parent_run_id].push(l),a[l.id]=l)}e.child_runs=r[e.id]||[];for(const l in r)l!==e.id&&(a[l].child_runs=r[l]);return e}async*listRuns(e){const{projectId:t,projectName:r,parentRunId:a,traceId:o,referenceExampleId:l,startTime:c,executionOrder:f,isRoot:h,runType:m,error:_,id:y,query:w,filter:b,traceFilter:E,treeFilter:S,limit:O,select:R,order:T}=e;let $=[];if(t&&($=Array.isArray(t)?t:[t]),r){const W=Array.isArray(r)?r:[r],Ee=await Promise.all(W.map(Ae=>this.readProject({projectName:Ae}).then(He=>He.id)));$.push(...Ee)}const P=["app_path","completion_cost","completion_tokens","dotted_order","end_time","error","events","extra","feedback_stats","first_token_time","id","inputs","name","outputs","parent_run_id","parent_run_ids","prompt_cost","prompt_tokens","reference_example_id","run_type","session_id","start_time","status","tags","total_cost","total_tokens","trace_id"],z={session:$.length?$:null,run_type:m,reference_example:l,query:w,filter:b,trace_filter:E,tree_filter:S,execution_order:f,parent_run:a,start_time:c?c.toISOString():null,error:_,id:y,limit:O,trace:o,select:R||P,is_root:h,order:T};z.select.includes("child_run_ids")&&Wc("Deprecated: 'child_run_ids' in the listRuns select parameter is deprecated and will be removed in a future version.");let Q=0;for await(const W of this._getCursorPaginatedList("/runs/query",z))if(O){if(Q>=O)break;if(W.length+Q>O){yield*W.slice(0,O-Q);break}Q+=W.length,yield*W}else yield*W}async*listGroupRuns(e){const{projectId:t,projectName:r,groupBy:a,filter:o,startTime:l,endTime:c,limit:f,offset:h}=e,_={session_id:t||(await this.readProject({projectName:r})).id,group_by:a,filter:o,start_time:l?l.toISOString():null,end_time:c?c.toISOString():null,limit:Number(f)||100};let y=Number(h)||0;const w="/runs/group",b=`${this.apiUrl}${w}`;for(;;){const E={..._,offset:y},S=Object.fromEntries(Object.entries(E).filter(([z,Q])=>Q!==void 0)),O=JSON.stringify(S),T=await(await this.caller.call(async()=>{const z=await this._fetch(b,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:O});return await ue(z,`Failed to fetch ${w}`),z})).json(),{groups:$,total:P}=T;if($.length===0)break;for(const z of $)yield z;if(y+=$.length,y>=P)break}}async getRunStats({id:e,trace:t,parentRun:r,runType:a,projectNames:o,projectIds:l,referenceExampleIds:c,startTime:f,endTime:h,error:m,query:_,filter:y,traceFilter:w,treeFilter:b,isRoot:E,dataSourceType:S}){let O=l||[];o&&(O=[...l||[],...await Promise.all(o.map(Q=>this.readProject({projectName:Q}).then(W=>W.id)))]);const T=Object.fromEntries(Object.entries({id:e,trace:t,parent_run:r,run_type:a,session:O,reference_example:c,start_time:f,end_time:h,error:m,query:_,filter:y,trace_filter:w,tree_filter:b,is_root:E,data_source_type:S}).filter(([Q,W])=>W!==void 0)),$=JSON.stringify(T);return await(await this.caller.call(async()=>{const Q=await this._fetch(`${this.apiUrl}/runs/stats`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:$});return await ue(Q,"get run stats"),Q})).json()}async shareRun(e,{shareId:t}={}){const r={run_id:e,share_token:t||Tt()};pe(e);const a=JSON.stringify(r),l=await(await this.caller.call(async()=>{const c=await this._fetch(`${this.apiUrl}/runs/${e}/share`,{method:"PUT",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:a});return await ue(c,"share run"),c})).json();if(l===null||!("share_token"in l))throw new Error("Invalid response from server");return`${this.getHostUrl()}/public/${l.share_token}/r`}async unshareRun(e){pe(e),await this.caller.call(async()=>{const t=await this._fetch(`${this.apiUrl}/runs/${e}/share`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ue(t,"unshare run",!0),t})}async readRunSharedLink(e){pe(e);const r=await(await this.caller.call(async()=>{const a=await this._fetch(`${this.apiUrl}/runs/${e}/share`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ue(a,"read run shared link"),a})).json();if(!(r===null||!("share_token"in r)))return`${this.getHostUrl()}/public/${r.share_token}/r`}async listSharedRuns(e,{runIds:t}={}){const r=new URLSearchParams({share_token:e});if(t!==void 0)for(const l of t)r.append("id",l);return pe(e),await(await this.caller.call(async()=>{const l=await this._fetch(`${this.apiUrl}/public/${e}/runs${r}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ue(l,"list shared runs"),l})).json()}async readDatasetSharedSchema(e,t){if(!e&&!t)throw new Error("Either datasetId or datasetName must be given");e||(e=(await this.readDataset({datasetName:t})).id),pe(e);const a=await(await this.caller.call(async()=>{const o=await this._fetch(`${this.apiUrl}/datasets/${e}/share`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ue(o,"read dataset shared schema"),o})).json();return a.url=`${this.getHostUrl()}/public/${a.share_token}/d`,a}async shareDataset(e,t){if(!e&&!t)throw new Error("Either datasetId or datasetName must be given");e||(e=(await this.readDataset({datasetName:t})).id);const r={dataset_id:e};pe(e);const a=JSON.stringify(r),l=await(await this.caller.call(async()=>{const c=await this._fetch(`${this.apiUrl}/datasets/${e}/share`,{method:"PUT",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:a});return await ue(c,"share dataset"),c})).json();return l.url=`${this.getHostUrl()}/public/${l.share_token}/d`,l}async unshareDataset(e){pe(e),await this.caller.call(async()=>{const t=await this._fetch(`${this.apiUrl}/datasets/${e}/share`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ue(t,"unshare dataset",!0),t})}async readSharedDataset(e){return pe(e),await(await this.caller.call(async()=>{const a=await this._fetch(`${this.apiUrl}/public/${e}/datasets`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ue(a,"read shared dataset"),a})).json()}async listSharedExamples(e,t){const r={};t!=null&&t.exampleIds&&(r.id=t.exampleIds);const a=new URLSearchParams;Object.entries(r).forEach(([c,f])=>{Array.isArray(f)?f.forEach(h=>a.append(c,h)):a.append(c,f)});const o=await this.caller.call(async()=>{const c=await this._fetch(`${this.apiUrl}/public/${e}/examples?${a.toString()}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ue(c,"list shared examples"),c}),l=await o.json();if(!o.ok)throw"detail"in l?new Error(`Failed to list shared examples.
Status: ${o.status}
Message: ${Array.isArray(l.detail)?l.detail.join(`
`):"Unspecified error"}`):new Error(`Failed to list shared examples: ${o.status} ${o.statusText}`);return l.map(c=>({...c,_hostUrl:this.getHostUrl()}))}async createProject({projectName:e,description:t=null,metadata:r=null,upsert:a=!1,projectExtra:o=null,referenceDatasetId:l=null}){const c=a?"?upsert=true":"",f=`${this.apiUrl}/sessions${c}`,h=o||{};r&&(h.metadata=r);const m={name:e,extra:h,description:t};l!==null&&(m.reference_dataset_id=l);const _=JSON.stringify(m);return await(await this.caller.call(async()=>{const b=await this._fetch(f,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:_});return await ue(b,"create project"),b})).json()}async updateProject(e,{name:t=null,description:r=null,metadata:a=null,projectExtra:o=null,endTime:l=null}){const c=`${this.apiUrl}/sessions/${e}`;let f=o;a&&(f={...f||{},metadata:a});const h=JSON.stringify({name:t,extra:f,description:r,end_time:l?new Date(l).toISOString():null});return await(await this.caller.call(async()=>{const y=await this._fetch(c,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:h});return await ue(y,"update project"),y})).json()}async hasProject({projectId:e,projectName:t}){let r="/sessions";const a=new URLSearchParams;if(e!==void 0&&t!==void 0)throw new Error("Must provide either projectName or projectId, not both");if(e!==void 0)pe(e),r+=`/${e}`;else if(t!==void 0)a.append("name",t);else throw new Error("Must provide projectName or projectId");const o=await this.caller.call(async()=>{const l=await this._fetch(`${this.apiUrl}${r}?${a}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ue(l,"has project"),l});try{const l=await o.json();return o.ok?Array.isArray(l)?l.length>0:!0:!1}catch{return!1}}async readProject({projectId:e,projectName:t,includeStats:r}){let a="/sessions";const o=new URLSearchParams;if(e!==void 0&&t!==void 0)throw new Error("Must provide either projectName or projectId, not both");if(e!==void 0)pe(e),a+=`/${e}`;else if(t!==void 0)o.append("name",t);else throw new Error("Must provide projectName or projectId");r!==void 0&&o.append("include_stats",r.toString());const l=await this._get(a,o);let c;if(Array.isArray(l)){if(l.length===0)throw new Error(`Project[id=${e}, name=${t}] not found`);c=l[0]}else c=l;return c}async getProjectUrl({projectId:e,projectName:t}){if(e===void 0&&t===void 0)throw new Error("Must provide either projectName or projectId");const r=await this.readProject({projectId:e,projectName:t}),a=await this._getTenantId();return`${this.getHostUrl()}/o/${a}/projects/p/${r.id}`}async getDatasetUrl({datasetId:e,datasetName:t}){if(e===void 0&&t===void 0)throw new Error("Must provide either datasetName or datasetId");const r=await this.readDataset({datasetId:e,datasetName:t}),a=await this._getTenantId();return`${this.getHostUrl()}/o/${a}/datasets/${r.id}`}async _getTenantId(){if(this._tenantId!==null)return this._tenantId;const e=new URLSearchParams({limit:"1"});for await(const t of this._getPaginated("/sessions",e))return this._tenantId=t[0].tenant_id,t[0].tenant_id;throw new Error("No projects found to resolve tenant.")}async*listProjects({projectIds:e,name:t,nameContains:r,referenceDatasetId:a,referenceDatasetName:o,includeStats:l,datasetVersion:c,referenceFree:f,metadata:h}={}){const m=new URLSearchParams;if(e!==void 0)for(const _ of e)m.append("id",_);if(t!==void 0&&m.append("name",t),r!==void 0&&m.append("name_contains",r),a!==void 0)m.append("reference_dataset",a);else if(o!==void 0){const _=await this.readDataset({datasetName:o});m.append("reference_dataset",_.id)}l!==void 0&&m.append("include_stats",l.toString()),c!==void 0&&m.append("dataset_version",c),f!==void 0&&m.append("reference_free",f.toString()),h!==void 0&&m.append("metadata",JSON.stringify(h));for await(const _ of this._getPaginated("/sessions",m))yield*_}async deleteProject({projectId:e,projectName:t}){let r;if(e===void 0&&t===void 0)throw new Error("Must provide projectName or projectId");if(e!==void 0&&t!==void 0)throw new Error("Must provide either projectName or projectId, not both");e===void 0?r=(await this.readProject({projectName:t})).id:r=e,pe(r),await this.caller.call(async()=>{const a=await this._fetch(`${this.apiUrl}/sessions/${r}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ue(a,`delete session ${r} (${t})`,!0),a})}async uploadCsv({csvFile:e,fileName:t,inputKeys:r,outputKeys:a,description:o,dataType:l,name:c}){const f=`${this.apiUrl}/datasets/upload`,h=new FormData;return h.append("file",e,t),r.forEach(y=>{h.append("input_keys",y)}),a.forEach(y=>{h.append("output_keys",y)}),o&&h.append("description",o),l&&h.append("data_type",l),c&&h.append("name",c),await(await this.caller.call(async()=>{const y=await this._fetch(f,{method:"POST",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:h});return await ue(y,"upload CSV"),y})).json()}async createDataset(e,{description:t,dataType:r,inputsSchema:a,outputsSchema:o,metadata:l}={}){const c={name:e,description:t,extra:l?{metadata:l}:void 0};r&&(c.data_type=r),a&&(c.inputs_schema_definition=a),o&&(c.outputs_schema_definition=o);const f=JSON.stringify(c);return await(await this.caller.call(async()=>{const _=await this._fetch(`${this.apiUrl}/datasets`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:f});return await ue(_,"create dataset"),_})).json()}async readDataset({datasetId:e,datasetName:t}){let r="/datasets";const a=new URLSearchParams({limit:"1"});if(e&&t)throw new Error("Must provide either datasetName or datasetId, not both");if(e)pe(e),r+=`/${e}`;else if(t)a.append("name",t);else throw new Error("Must provide datasetName or datasetId");const o=await this._get(r,a);let l;if(Array.isArray(o)){if(o.length===0)throw new Error(`Dataset[id=${e}, name=${t}] not found`);l=o[0]}else l=o;return l}async hasDataset({datasetId:e,datasetName:t}){try{return await this.readDataset({datasetId:e,datasetName:t}),!0}catch(r){if(r instanceof Error&&r.message.toLocaleLowerCase().includes("not found"))return!1;throw r}}async diffDatasetVersions({datasetId:e,datasetName:t,fromVersion:r,toVersion:a}){let o=e;if(o===void 0&&t===void 0)throw new Error("Must provide either datasetName or datasetId");if(o!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");o===void 0&&(o=(await this.readDataset({datasetName:t})).id);const l=new URLSearchParams({from_version:typeof r=="string"?r:r.toISOString(),to_version:typeof a=="string"?a:a.toISOString()});return await this._get(`/datasets/${o}/versions/diff`,l)}async readDatasetOpenaiFinetuning({datasetId:e,datasetName:t}){const r="/datasets";if(e===void 0)if(t!==void 0)e=(await this.readDataset({datasetName:t})).id;else throw new Error("Must provide either datasetName or datasetId");return(await(await this._getResponse(`${r}/${e}/openai_ft`)).text()).trim().split(`
`).map(c=>JSON.parse(c))}async*listDatasets({limit:e=100,offset:t=0,datasetIds:r,datasetName:a,datasetNameContains:o,metadata:l}={}){const c="/datasets",f=new URLSearchParams({limit:e.toString(),offset:t.toString()});if(r!==void 0)for(const h of r)f.append("id",h);a!==void 0&&f.append("name",a),o!==void 0&&f.append("name_contains",o),l!==void 0&&f.append("metadata",JSON.stringify(l));for await(const h of this._getPaginated(c,f))yield*h}async updateDataset(e){const{datasetId:t,datasetName:r,...a}=e;if(!t&&!r)throw new Error("Must provide either datasetName or datasetId");const o=t??(await this.readDataset({datasetName:r})).id;pe(o);const l=JSON.stringify(a);return await(await this.caller.call(async()=>{const f=await this._fetch(`${this.apiUrl}/datasets/${o}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:l});return await ue(f,"update dataset"),f})).json()}async updateDatasetTag(e){const{datasetId:t,datasetName:r,asOf:a,tag:o}=e;if(!t&&!r)throw new Error("Must provide either datasetName or datasetId");const l=t??(await this.readDataset({datasetName:r})).id;pe(l);const c=JSON.stringify({as_of:typeof a=="string"?a:a.toISOString(),tag:o});await this.caller.call(async()=>{const f=await this._fetch(`${this.apiUrl}/datasets/${l}/tags`,{method:"PUT",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:c});return await ue(f,"update dataset tags",!0),f})}async deleteDataset({datasetId:e,datasetName:t}){let r="/datasets",a=e;if(e!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(t!==void 0&&(a=(await this.readDataset({datasetName:t})).id),a!==void 0)pe(a),r+=`/${a}`;else throw new Error("Must provide datasetName or datasetId");await this.caller.call(async()=>{const o=await this._fetch(this.apiUrl+r,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ue(o,`delete ${r}`,!0),o})}async indexDataset({datasetId:e,datasetName:t,tag:r}){let a=e;if(!a&&!t)throw new Error("Must provide either datasetName or datasetId");if(a&&t)throw new Error("Must provide either datasetName or datasetId, not both");a||(a=(await this.readDataset({datasetName:t})).id),pe(a);const l=JSON.stringify({tag:r});await(await this.caller.call(async()=>{const f=await this._fetch(`${this.apiUrl}/datasets/${a}/index`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:l});return await ue(f,"index dataset"),f})).json()}async similarExamples(e,t,r,{filter:a}={}){const o={limit:r,inputs:e};a!==void 0&&(o.filter=a),pe(t);const l=JSON.stringify(o);return(await(await this.caller.call(async()=>{const h=await this._fetch(`${this.apiUrl}/datasets/${t}/search`,{headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,method:"POST",body:l});return await ue(h,"fetch similar examples"),h})).json()).examples}async createExample(e,t,r){var m;if(kg(e)&&(t!==void 0||r!==void 0))throw new Error("Cannot provide outputs or options when using ExampleCreate object");let a=t?r==null?void 0:r.datasetId:e.dataset_id;const o=t?r==null?void 0:r.datasetName:e.dataset_name;if(a===void 0&&o===void 0)throw new Error("Must provide either datasetName or datasetId");if(a!==void 0&&o!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");a===void 0&&(a=(await this.readDataset({datasetName:o})).id);const l=(t?r==null?void 0:r.createdAt:e.created_at)||new Date;let c;kg(e)?c=e:c={inputs:e,outputs:t,created_at:l==null?void 0:l.toISOString(),id:r==null?void 0:r.exampleId,metadata:r==null?void 0:r.metadata,split:r==null?void 0:r.split,source_run_id:r==null?void 0:r.sourceRunId,use_source_run_io:r==null?void 0:r.useSourceRunIO,use_source_run_attachments:r==null?void 0:r.useSourceRunAttachments,attachments:r==null?void 0:r.attachments};const f=await this._uploadExamplesMultipart(a,[c]);return await this.readExample(((m=f.example_ids)==null?void 0:m[0])??Tt())}async createExamples(e){if(Array.isArray(e)){if(e.length===0)return[];const R=e;let T=R[0].dataset_id;const $=R[0].dataset_name;if(T===void 0&&$===void 0)throw new Error("Must provide either datasetName or datasetId");if(T!==void 0&&$!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");T===void 0&&(T=(await this.readDataset({datasetName:$})).id);const P=await this._uploadExamplesMultipart(T,R);return await Promise.all(P.example_ids.map(Q=>this.readExample(Q)))}const{inputs:t,outputs:r,metadata:a,splits:o,sourceRunIds:l,useSourceRunIOs:c,useSourceRunAttachments:f,attachments:h,exampleIds:m,datasetId:_,datasetName:y}=e;if(t===void 0)throw new Error("Must provide inputs when using legacy parameters");let w=_;const b=y;if(w===void 0&&b===void 0)throw new Error("Must provide either datasetName or datasetId");if(w!==void 0&&b!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");w===void 0&&(w=(await this.readDataset({datasetName:b})).id);const E=t.map((R,T)=>({dataset_id:w,inputs:R,outputs:r==null?void 0:r[T],metadata:a==null?void 0:a[T],split:o==null?void 0:o[T],id:m==null?void 0:m[T],attachments:h==null?void 0:h[T],source_run_id:l==null?void 0:l[T],use_source_run_io:c==null?void 0:c[T],use_source_run_attachments:f==null?void 0:f[T]})),S=await this._uploadExamplesMultipart(w,E);return await Promise.all(S.example_ids.map(R=>this.readExample(R)))}async createLLMExample(e,t,r){return this.createExample({input:e},{output:t},r)}async createChatExample(e,t,r){const a=e.map(l=>Rm(l)?Im(l):l),o=Rm(t)?Im(t):t;return this.createExample({input:a},{output:o},r)}async readExample(e){pe(e);const t=`/examples/${e}`,r=await this._get(t),{attachment_urls:a,...o}=r,l=o;return a&&(l.attachments=Object.entries(a).reduce((c,[f,h])=>(c[f.slice(11)]={presigned_url:h.presigned_url,mime_type:h.mime_type},c),{})),l}async*listExamples({datasetId:e,datasetName:t,exampleIds:r,asOf:a,splits:o,inlineS3Urls:l,metadata:c,limit:f,offset:h,filter:m,includeAttachments:_}={}){let y;if(e!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(e!==void 0)y=e;else if(t!==void 0)y=(await this.readDataset({datasetName:t})).id;else throw new Error("Must provide a datasetName or datasetId");const w=new URLSearchParams({dataset:y}),b=a?typeof a=="string"?a:a==null?void 0:a.toISOString():void 0;b&&w.append("as_of",b);const E=l??!0;if(w.append("inline_s3_urls",E.toString()),r!==void 0)for(const O of r)w.append("id",O);if(o!==void 0)for(const O of o)w.append("splits",O);if(c!==void 0){const O=JSON.stringify(c);w.append("metadata",O)}f!==void 0&&w.append("limit",f.toString()),h!==void 0&&w.append("offset",h.toString()),m!==void 0&&w.append("filter",m),_===!0&&["attachment_urls","outputs","metadata"].forEach(O=>w.append("select",O));let S=0;for await(const O of this._getPaginated("/examples",w)){for(const R of O){const{attachment_urls:T,...$}=R,P=$;T&&(P.attachments=Object.entries(T).reduce((z,[Q,W])=>(z[Q.slice(11)]={presigned_url:W.presigned_url,mime_type:W.mime_type||void 0},z),{})),yield P,S++}if(f!==void 0&&S>=f)break}}async deleteExample(e){pe(e);const t=`/examples/${e}`;await this.caller.call(async()=>{const r=await this._fetch(this.apiUrl+t,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ue(r,`delete ${t}`,!0),r})}async deleteExamples(e,t){if(e.forEach(r=>pe(r)),t!=null&&t.hardDelete){const r=this._getPlatformEndpointPath("datasets/examples/delete");await this.caller.call(async()=>{const a=await this._fetch(`${this.apiUrl}${r}`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify({example_ids:e,hard_delete:!0}),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ue(a,"hard delete examples",!0),a})}else{const r=new URLSearchParams;e.forEach(a=>r.append("example_ids",a)),await this.caller.call(async()=>{const a=await this._fetch(`${this.apiUrl}/examples?${r.toString()}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ue(a,"delete examples",!0),a})}}async updateExample(e,t){let r;t?r=e:r=e.id,pe(r);let a;t?a={id:r,...t}:a=e;let o;return a.dataset_id!==void 0?o=a.dataset_id:o=(await this.readExample(r)).dataset_id,this._updateExamplesMultipart(o,[a])}async updateExamples(e){let t;return e[0].dataset_id===void 0?t=(await this.readExample(e[0].id)).dataset_id:t=e[0].dataset_id,this._updateExamplesMultipart(t,e)}async readDatasetVersion({datasetId:e,datasetName:t,asOf:r,tag:a}){let o;if(e?o=e:o=(await this.readDataset({datasetName:t})).id,pe(o),r&&a||!r&&!a)throw new Error("Exactly one of asOf and tag must be specified.");const l=new URLSearchParams;return r!==void 0&&l.append("as_of",typeof r=="string"?r:r.toISOString()),a!==void 0&&l.append("tag",a),await(await this.caller.call(async()=>{const f=await this._fetch(`${this.apiUrl}/datasets/${o}/version?${l.toString()}`,{method:"GET",headers:{...this.headers},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ue(f,"read dataset version"),f})).json()}async listDatasetSplits({datasetId:e,datasetName:t,asOf:r}){let a;if(e===void 0&&t===void 0)throw new Error("Must provide dataset name or ID");if(e!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");e===void 0?a=(await this.readDataset({datasetName:t})).id:a=e,pe(a);const o=new URLSearchParams,l=r?typeof r=="string"?r:r==null?void 0:r.toISOString():void 0;return l&&o.append("as_of",l),await this._get(`/datasets/${a}/splits`,o)}async updateDatasetSplits({datasetId:e,datasetName:t,splitName:r,exampleIds:a,remove:o=!1}){let l;if(e===void 0&&t===void 0)throw new Error("Must provide dataset name or ID");if(e!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");e===void 0?l=(await this.readDataset({datasetName:t})).id:l=e,pe(l);const c={split_name:r,examples:a.map(h=>(pe(h),h)),remove:o},f=JSON.stringify(c);await this.caller.call(async()=>{const h=await this._fetch(`${this.apiUrl}/datasets/${l}/splits`,{method:"PUT",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:f});return await ue(h,"update dataset splits",!0),h})}async evaluateRun(e,t,{sourceInfo:r,loadChildRuns:a,referenceExample:o}={loadChildRuns:!1}){Wc("This method is deprecated and will be removed in future LangSmith versions, use `evaluate` from `langsmith/evaluation` instead.");let l;if(typeof e=="string")l=await this.readRun(e,{loadChildRuns:a});else if(typeof e=="object"&&"id"in e)l=e;else throw new Error(`Invalid run type: ${typeof e}`);l.reference_example_id!==null&&l.reference_example_id!==void 0&&(o=await this.readExample(l.reference_example_id));const c=await t.evaluateRun(l,o),[f,h]=await this._logEvaluationFeedback(c,l,r);return h[0]}async createFeedback(e,t,{score:r,value:a,correction:o,comment:l,sourceInfo:c,feedbackSourceType:f="api",sourceRunId:h,feedbackId:m,feedbackConfig:_,projectId:y,comparativeExperimentId:w}){var R;if(!e&&!y)throw new Error("One of runId or projectId must be provided");if(e&&y)throw new Error("Only one of runId or projectId can be provided");const b={type:f??"api",metadata:c??{}};h!==void 0&&(b==null?void 0:b.metadata)!==void 0&&!b.metadata.__run&&(b.metadata.__run={run_id:h}),(b==null?void 0:b.metadata)!==void 0&&((R=b.metadata.__run)==null?void 0:R.run_id)!==void 0&&pe(b.metadata.__run.run_id);const E={id:m??Tt(),run_id:e,key:t,score:Sg(r),value:a,correction:o,comment:l,feedback_source:b,comparative_experiment_id:w,feedbackConfig:_,session_id:y},S=JSON.stringify(E),O=`${this.apiUrl}/feedback`;return await this.caller.call(async()=>{const T=await this._fetch(O,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:S});return await ue(T,"create feedback",!0),T}),E}async updateFeedback(e,{score:t,value:r,correction:a,comment:o}){const l={};t!=null&&(l.score=Sg(t)),r!=null&&(l.value=r),a!=null&&(l.correction=a),o!=null&&(l.comment=o),pe(e);const c=JSON.stringify(l);await this.caller.call(async()=>{const f=await this._fetch(`${this.apiUrl}/feedback/${e}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:c});return await ue(f,"update feedback",!0),f})}async readFeedback(e){pe(e);const t=`/feedback/${e}`;return await this._get(t)}async deleteFeedback(e){pe(e);const t=`/feedback/${e}`;await this.caller.call(async()=>{const r=await this._fetch(this.apiUrl+t,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ue(r,`delete ${t}`,!0),r})}async*listFeedback({runIds:e,feedbackKeys:t,feedbackSourceTypes:r}={}){const a=new URLSearchParams;if(e)for(const o of e)pe(o),a.append("run",o);if(t)for(const o of t)a.append("key",o);if(r)for(const o of r)a.append("source",o);for await(const o of this._getPaginated("/feedback",a))yield*o}async createPresignedFeedbackToken(e,t,{expiration:r,feedbackConfig:a}={}){const o={run_id:e,feedback_key:t,feedback_config:a};r?typeof r=="string"?o.expires_at=r:(r!=null&&r.hours||r!=null&&r.minutes||r!=null&&r.days)&&(o.expires_in=r):o.expires_in={hours:3};const l=JSON.stringify(o);return await(await this.caller.call(async()=>{const f=await this._fetch(`${this.apiUrl}/feedback/tokens`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:l});return await ue(f,"create presigned feedback token"),f})).json()}async createComparativeExperiment({name:e,experimentIds:t,referenceDatasetId:r,createdAt:a,description:o,metadata:l,id:c}){var _;if(t.length===0)throw new Error("At least one experiment is required");if(r||(r=(await this.readProject({projectId:t[0]})).reference_dataset_id),!r==null)throw new Error("A reference dataset is required");const f={id:c,name:e,experiment_ids:t,reference_dataset_id:r,description:o,created_at:(_=a??new Date)==null?void 0:_.toISOString(),extra:{}};l&&(f.extra.metadata=l);const h=JSON.stringify(f);return(await this.caller.call(async()=>{const y=await this._fetch(`${this.apiUrl}/datasets/comparative`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:h});return await ue(y,"create comparative experiment"),y})).json()}async*listPresignedFeedbackTokens(e){pe(e);const t=new URLSearchParams({run_id:e});for await(const r of this._getPaginated("/feedback/tokens",t))yield*r}_selectEvalResults(e){let t;return"results"in e?t=e.results:Array.isArray(e)?t=e:t=[e],t}async _logEvaluationFeedback(e,t,r){const a=this._selectEvalResults(e),o=[];for(const l of a){let c=r||{};l.evaluatorInfo&&(c={...l.evaluatorInfo,...c});let f=null;l.targetRunId?f=l.targetRunId:t&&(f=t.id),o.push(await this.createFeedback(f,l.key,{score:l.score,value:l.value,comment:l.comment,correction:l.correction,sourceInfo:c,sourceRunId:l.sourceRunId,feedbackConfig:l.feedbackConfig,feedbackSourceType:"model"}))}return[a,o]}async logEvaluationFeedback(e,t,r){const[a]=await this._logEvaluationFeedback(e,t,r);return a}async*listAnnotationQueues(e={}){const{queueIds:t,name:r,nameContains:a,limit:o}=e,l=new URLSearchParams;t&&t.forEach((f,h)=>{pe(f,`queueIds[${h}]`),l.append("ids",f)}),r&&l.append("name",r),a&&l.append("name_contains",a),l.append("limit",(o!==void 0?Math.min(o,100):100).toString());let c=0;for await(const f of this._getPaginated("/annotation-queues",l))if(yield*f,c++,o!==void 0&&c>=o)break}async createAnnotationQueue(e){const{name:t,description:r,queueId:a,rubricInstructions:o}=e,l={name:t,description:r,id:a||Tt(),rubric_instructions:o},c=JSON.stringify(Object.fromEntries(Object.entries(l).filter(([h,m])=>m!==void 0)));return(await this.caller.call(async()=>{const h=await this._fetch(`${this.apiUrl}/annotation-queues`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:c});return await ue(h,"create annotation queue"),h})).json()}async readAnnotationQueue(e){return(await this.caller.call(async()=>{const r=await this._fetch(`${this.apiUrl}/annotation-queues/${pe(e,"queueId")}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ue(r,"read annotation queue"),r})).json()}async updateAnnotationQueue(e,t){const{name:r,description:a,rubricInstructions:o}=t,l=JSON.stringify({name:r,description:a,rubric_instructions:o});await this.caller.call(async()=>{const c=await this._fetch(`${this.apiUrl}/annotation-queues/${pe(e,"queueId")}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:l});return await ue(c,"update annotation queue",!0),c})}async deleteAnnotationQueue(e){await this.caller.call(async()=>{const t=await this._fetch(`${this.apiUrl}/annotation-queues/${pe(e,"queueId")}`,{method:"DELETE",headers:{...this.headers,Accept:"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ue(t,"delete annotation queue",!0),t})}async addRunsToAnnotationQueue(e,t){const r=JSON.stringify(t.map((a,o)=>pe(a,`runIds[${o}]`).toString()));await this.caller.call(async()=>{const a=await this._fetch(`${this.apiUrl}/annotation-queues/${pe(e,"queueId")}/runs`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:r});return await ue(a,"add runs to annotation queue",!0),a})}async getRunFromAnnotationQueue(e,t){const r=`/annotation-queues/${pe(e,"queueId")}/run`;return(await this.caller.call(async()=>{const o=await this._fetch(`${this.apiUrl}${r}/${t}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ue(o,"get run from annotation queue"),o})).json()}async deleteRunFromAnnotationQueue(e,t){await this.caller.call(async()=>{const r=await this._fetch(`${this.apiUrl}/annotation-queues/${pe(e,"queueId")}/runs/${pe(t,"queueRunId")}`,{method:"DELETE",headers:{...this.headers,Accept:"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ue(r,"delete run from annotation queue",!0),r})}async getSizeFromAnnotationQueue(e){return(await this.caller.call(async()=>{const r=await this._fetch(`${this.apiUrl}/annotation-queues/${pe(e,"queueId")}/size`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ue(r,"get size from annotation queue"),r})).json()}async _currentTenantIsOwner(e){const t=await this._getSettings();return e=="-"||t.tenant_handle===e}async _ownerConflictError(e,t){const r=await this._getSettings();return new Error(`Cannot ${e} for another tenant.

      Current tenant: ${r.tenant_handle}

      Requested tenant: ${t}`)}async _getLatestCommitHash(e){const r=await(await this.caller.call(async()=>{const a=await this._fetch(`${this.apiUrl}/commits/${e}/?limit=1&offset=0`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ue(a,"get latest commit hash"),a})).json();if(r.commits.length!==0)return r.commits[0].commit_hash}async _likeOrUnlikePrompt(e,t){const[r,a,o]=qn(e),l=JSON.stringify({like:t});return(await this.caller.call(async()=>{const f=await this._fetch(`${this.apiUrl}/likes/${r}/${a}`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:l});return await ue(f,`${t?"like":"unlike"} prompt`),f})).json()}async _getPromptUrl(e){const[t,r,a]=qn(e);if(await this._currentTenantIsOwner(t)){const o=await this._getSettings();return a!=="latest"?`${this.getHostUrl()}/prompts/${r}/${a.substring(0,8)}?organizationId=${o.id}`:`${this.getHostUrl()}/prompts/${r}?organizationId=${o.id}`}else return a!=="latest"?`${this.getHostUrl()}/hub/${t}/${r}/${a.substring(0,8)}`:`${this.getHostUrl()}/hub/${t}/${r}`}async promptExists(e){return!!await this.getPrompt(e)}async likePrompt(e){return this._likeOrUnlikePrompt(e,!0)}async unlikePrompt(e){return this._likeOrUnlikePrompt(e,!1)}async*listCommits(e){for await(const t of this._getPaginated(`/commits/${e}/`,new URLSearchParams,r=>r.commits))yield*t}async*listPrompts(e){const t=new URLSearchParams;t.append("sort_field",(e==null?void 0:e.sortField)??"updated_at"),t.append("sort_direction","desc"),t.append("is_archived",(!!(e!=null&&e.isArchived)).toString()),(e==null?void 0:e.isPublic)!==void 0&&t.append("is_public",e.isPublic.toString()),e!=null&&e.query&&t.append("query",e.query);for await(const r of this._getPaginated("/repos",t,a=>a.repos))yield*r}async getPrompt(e){const[t,r,a]=qn(e),o=await this.caller.call(async()=>{const c=await this._fetch(`${this.apiUrl}/repos/${t}/${r}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return(c==null?void 0:c.status)===404?null:(await ue(c,"get prompt"),c)}),l=await(o==null?void 0:o.json());return l!=null&&l.repo?l.repo:null}async createPrompt(e,t){const r=await this._getSettings();if(t!=null&&t.isPublic&&!r.tenant_handle)throw new Error(`Cannot create a public prompt without first

        creating a LangChain Hub handle.
        You can add a handle by creating a public prompt at:

        https://smith.langchain.com/prompts`);const[a,o,l]=qn(e);if(!await this._currentTenantIsOwner(a))throw await this._ownerConflictError("create a prompt",a);const c={repo_handle:o,...(t==null?void 0:t.description)&&{description:t.description},...(t==null?void 0:t.readme)&&{readme:t.readme},...(t==null?void 0:t.tags)&&{tags:t.tags},is_public:!!(t!=null&&t.isPublic)},f=JSON.stringify(c),h=await this.caller.call(async()=>{const _=await this._fetch(`${this.apiUrl}/repos/`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:f});return await ue(_,"create prompt"),_}),{repo:m}=await h.json();return m}async createCommit(e,t,r){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");const[a,o,l]=qn(e),c=(r==null?void 0:r.parentCommitHash)==="latest"||!(r!=null&&r.parentCommitHash)?await this._getLatestCommitHash(`${a}/${o}`):r==null?void 0:r.parentCommitHash,f={manifest:JSON.parse(JSON.stringify(t)),parent_commit:c},h=JSON.stringify(f),_=await(await this.caller.call(async()=>{const y=await this._fetch(`${this.apiUrl}/commits/${a}/${o}`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:h});return await ue(y,"create commit"),y})).json();return this._getPromptUrl(`${a}/${o}${_.commit_hash?`:${_.commit_hash}`:""}`)}async updateExamplesMultipart(e,t=[]){return this._updateExamplesMultipart(e,t)}async _updateExamplesMultipart(e,t=[]){var l;if(!await this._getDatasetExamplesMultiPartSupport())throw new Error("Your LangSmith deployment does not allow using the multipart examples endpoint, please upgrade your deployment to the latest version.");const r=new FormData;for(const c of t){const f=c.id,h={...c.metadata&&{metadata:c.metadata},...c.split&&{split:c.split}},m=Pt(h,`Serializing body for example with id: ${f}`),_=new Blob([m],{type:"application/json"});if(r.append(f,_),c.inputs){const y=Pt(c.inputs,`Serializing inputs for example with id: ${f}`),w=new Blob([y],{type:"application/json"});r.append(`${f}.inputs`,w)}if(c.outputs){const y=Pt(c.outputs,`Serializing outputs whle updating example with id: ${f}`),w=new Blob([y],{type:"application/json"});r.append(`${f}.outputs`,w)}if(c.attachments)for(const[y,w]of Object.entries(c.attachments)){let b,E;Array.isArray(w)?[b,E]=w:(b=w.mimeType,E=w.data);const S=new Blob([E],{type:`${b}; length=${E.byteLength}`});r.append(`${f}.attachment.${y}`,S)}if(c.attachments_operations){const y=Pt(c.attachments_operations,`Serializing attachments while updating example with id: ${f}`),w=new Blob([y],{type:"application/json"});r.append(`${f}.attachments_operations`,w)}}const a=e??((l=t[0])==null?void 0:l.dataset_id);return(await this.caller.call(async()=>{const c=await this._fetch(`${this.apiUrl}${this._getPlatformEndpointPath(`datasets/${a}/examples`)}`,{method:"PATCH",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:r});return await ue(c,"update examples"),c})).json()}async uploadExamplesMultipart(e,t=[]){return this._uploadExamplesMultipart(e,t)}async _uploadExamplesMultipart(e,t=[]){if(!await this._getDatasetExamplesMultiPartSupport())throw new Error("Your LangSmith deployment does not allow using the multipart examples endpoint, please upgrade your deployment to the latest version.");const r=new FormData;for(const o of t){const l=(o.id??Tt()).toString(),c={created_at:o.created_at,...o.metadata&&{metadata:o.metadata},...o.split&&{split:o.split},...o.source_run_id&&{source_run_id:o.source_run_id},...o.use_source_run_io&&{use_source_run_io:o.use_source_run_io},...o.use_source_run_attachments&&{use_source_run_attachments:o.use_source_run_attachments}},f=Pt(c,`Serializing body for uploaded example with id: ${l}`),h=new Blob([f],{type:"application/json"});if(r.append(l,h),o.inputs){const m=Pt(o.inputs,`Serializing inputs for uploaded example with id: ${l}`),_=new Blob([m],{type:"application/json"});r.append(`${l}.inputs`,_)}if(o.outputs){const m=Pt(o.outputs,`Serializing outputs for uploaded example with id: ${l}`),_=new Blob([m],{type:"application/json"});r.append(`${l}.outputs`,_)}if(o.attachments)for(const[m,_]of Object.entries(o.attachments)){let y,w;Array.isArray(_)?[y,w]=_:(y=_.mimeType,w=_.data);const b=new Blob([w],{type:`${y}; length=${w.byteLength}`});r.append(`${l}.attachment.${m}`,b)}}return(await this.caller.call(async()=>{const o=await this._fetch(`${this.apiUrl}${this._getPlatformEndpointPath(`datasets/${e}/examples`)}`,{method:"POST",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:r});return await ue(o,"upload examples"),o})).json()}async updatePrompt(e,t){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");const[r,a]=qn(e);if(!await this._currentTenantIsOwner(r))throw await this._ownerConflictError("update a prompt",r);const o={};if((t==null?void 0:t.description)!==void 0&&(o.description=t.description),(t==null?void 0:t.readme)!==void 0&&(o.readme=t.readme),(t==null?void 0:t.tags)!==void 0&&(o.tags=t.tags),(t==null?void 0:t.isPublic)!==void 0&&(o.is_public=t.isPublic),(t==null?void 0:t.isArchived)!==void 0&&(o.is_archived=t.isArchived),Object.keys(o).length===0)throw new Error("No valid update options provided");const l=JSON.stringify(o);return(await this.caller.call(async()=>{const f=await this._fetch(`${this.apiUrl}/repos/${r}/${a}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:l});return await ue(f,"update prompt"),f})).json()}async deletePrompt(e){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");const[t,r,a]=qn(e);if(!await this._currentTenantIsOwner(t))throw await this._ownerConflictError("delete a prompt",t);return(await this.caller.call(async()=>{const l=await this._fetch(`${this.apiUrl}/repos/${t}/${r}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ue(l,"delete prompt"),l})).json()}async pullPromptCommit(e,t){const[r,a,o]=qn(e),c=await(await this.caller.call(async()=>{const f=await this._fetch(`${this.apiUrl}/commits/${r}/${a}/${o}${t!=null&&t.includeModel?"?include_model=true":""}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ue(f,"pull prompt commit"),f})).json();return{owner:r,repo:a,commit_hash:c.commit_hash,manifest:c.manifest,examples:c.examples}}async _pullPrompt(e,t){const r=await this.pullPromptCommit(e,{includeModel:t==null?void 0:t.includeModel});return JSON.stringify(r.manifest)}async pushPrompt(e,t){return await this.promptExists(e)?t&&Object.keys(t).some(a=>a!=="object")&&await this.updatePrompt(e,{description:t==null?void 0:t.description,readme:t==null?void 0:t.readme,tags:t==null?void 0:t.tags,isPublic:t==null?void 0:t.isPublic}):await this.createPrompt(e,{description:t==null?void 0:t.description,readme:t==null?void 0:t.readme,tags:t==null?void 0:t.tags,isPublic:t==null?void 0:t.isPublic}),t!=null&&t.object?await this.createCommit(e,t==null?void 0:t.object,{parentCommitHash:t==null?void 0:t.parentCommitHash}):await this._getPromptUrl(e)}async clonePublicDataset(e,t={}){const{sourceApiUrl:r=this.apiUrl,datasetName:a}=t,[o,l]=this.parseTokenOrUrl(e,r),c=new ys({apiUrl:o,apiKey:"placeholder"}),f=await c.readSharedDataset(l),h=a||f.name;try{if(await this.hasDataset({datasetId:h})){console.log(`Dataset ${h} already exists in your tenant. Skipping.`);return}}catch{}const m=await c.listSharedExamples(l),_=await this.createDataset(h,{description:f.description,dataType:f.data_type||"kv",inputsSchema:f.inputs_schema_definition??void 0,outputsSchema:f.outputs_schema_definition??void 0});try{await this.createExamples({inputs:m.map(y=>y.inputs),outputs:m.flatMap(y=>y.outputs?[y.outputs]:[]),datasetId:_.id})}catch(y){throw console.error(`An error occurred while creating dataset ${h}. You should delete it manually.`),y}}parseTokenOrUrl(e,t,r=2,a="dataset"){try{return pe(e),[t,e]}catch{}try{const l=new URL(e).pathname.split("/").filter(c=>c!=="");if(l.length>=r){const c=l[l.length-r];return[t,c]}else throw new Error(`Invalid public ${a} URL: ${e}`)}catch{throw new Error(`Invalid public ${a} URL or token: ${e}`)}}async awaitPendingTraceBatches(){var e,t;if(this.manualFlushMode)return console.warn("[WARNING]: When tracing in manual flush mode, you must call `await client.flush()` manually to submit trace batches."),Promise.resolve();await Promise.all([...this.autoBatchQueue.items.map(({itemPromise:r})=>r),this.batchIngestCaller.queue.onIdle()]),this.langSmithToOTELTranslator!==void 0&&await((t=(e=Lb())==null?void 0:e.DEFAULT_LANGSMITH_SPAN_PROCESSOR)==null?void 0:t.forceFlush())}}function kg(s){return"dataset_id"in s||"dataset_name"in s}const BE=s=>!!["TRACING_V2","TRACING"].find(t=>xt(t)==="true"),er=Symbol.for("lc:context_variables"),Tc=Symbol.for("langsmith:replica_trace_roots");function Tg(s,e){if(er in s)return s[er][e]}function HE(s,e,t){const r=er in s?s[er]:{};r[e]=t,s[er]=r}const rs="6ba7b810-9dad-11d1-80b4-00c04fd430c8";function xg(s){const t=Object.keys(s).sort().map(r=>`${r}:${s[r]??""}`).join("|");return ns(t,rs)}function GE(s){return s.replace(/[-:.]/g,"")}function Sy(s,e=1){const t=e.toFixed(0).slice(0,3).padStart(3,"0");return`${new Date(s).toISOString().slice(0,-1)}${t}Z`}function Oy(s,e,t=1){const r=Sy(s,t);return{dottedOrder:GE(r)+e,microsecondPrecisionDatestring:r}}class ro{constructor(e,t,r,a){Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"project_name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"replicas",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.metadata=e,this.tags=t,this.project_name=r,this.replicas=a}static fromHeader(e){const t=e.split(",");let r={},a=[],o,l;for(const c of t){const[f,h]=c.split("="),m=decodeURIComponent(h);f==="langsmith-metadata"?r=JSON.parse(m):f==="langsmith-tags"?a=m.split(","):f==="langsmith-project"?o=m:f==="langsmith-replicas"&&(l=JSON.parse(m))}return new ro(r,a,o,l)}toHeader(){const e=[];return this.metadata&&Object.keys(this.metadata).length>0&&e.push(`langsmith-metadata=${encodeURIComponent(JSON.stringify(this.metadata))}`),this.tags&&this.tags.length>0&&e.push(`langsmith-tags=${encodeURIComponent(this.tags.join(","))}`),this.project_name&&e.push(`langsmith-project=${encodeURIComponent(this.project_name)}`),e.join(",")}}class kt{constructor(e){var c;if(Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"run_type",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"project_name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"parent_run",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"parent_run_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"child_runs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"start_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"end_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"extra",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"error",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"serialized",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reference_example_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"trace_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dotted_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tracingEnabled",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"execution_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"child_execution_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"attachments",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"replicas",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"distributedParentId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_serialized_start_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),qE(e)){Object.assign(this,{...e});return}const t=kt.getDefaultConfig(),{metadata:r,...a}=e,o=a.client??kt.getSharedClient(),l={...r,...(c=a==null?void 0:a.extra)==null?void 0:c.metadata};if(a.extra={...a.extra,metadata:l},"id"in a&&a.id==null&&delete a.id,Object.assign(this,{...t,...a,client:o}),this.execution_order??(this.execution_order=1),this.child_execution_order??(this.child_execution_order=1),this.dotted_order||(this._serialized_start_time=Sy(this.start_time,this.execution_order)),this.id||(this.id=wb(this._serialized_start_time??this.start_time)),this.trace_id||(this.parent_run?this.trace_id=this.parent_run.trace_id??this.id:this.trace_id=this.id),this.replicas=KE(this.replicas),!this.dotted_order){const{dottedOrder:f}=Oy(this.start_time,this.id,this.execution_order);this.parent_run?this.dotted_order=this.parent_run.dotted_order+"."+f:this.dotted_order=f}}set metadata(e){var t;this.extra={...this.extra,metadata:{...(t=this.extra)==null?void 0:t.metadata,...e}}}get metadata(){var e;return(e=this.extra)==null?void 0:e.metadata}static getDefaultConfig(){const e=Date.now();return{run_type:"chain",project_name:uy(),child_runs:[],api_url:hn("LANGCHAIN_ENDPOINT")??"http://localhost:1984",api_key:hn("LANGCHAIN_API_KEY"),caller_options:{},start_time:e,serialized:{},inputs:{},extra:{}}}static getSharedClient(){return kt.sharedClient||(kt.sharedClient=new ys),kt.sharedClient}createChild(e){var m,_,y,w,b,E,S;const t=this.child_execution_order+1,r=(m=this.replicas)==null?void 0:m.map(O=>{const{reroot:R,...T}=O;return T}),a=e.replicas??r,o=new kt({...e,parent_run:this,project_name:this.project_name,replicas:a,client:this.client,tracingEnabled:this.tracingEnabled,execution_order:t,child_execution_order:t});er in this&&(o[er]=this[er]);const l=Symbol.for("lc:child_config"),c=((_=e.extra)==null?void 0:_[l])??this.extra[l];if(ZE(c)){const O={...c},R=VE(O.callbacks)?(w=(y=O.callbacks).copy)==null?void 0:w.call(y):void 0;R&&(Object.assign(R,{_parentRunId:o.id}),(S=(E=(b=R.handlers)==null?void 0:b.find(ky))==null?void 0:E.updateFromRunTree)==null||S.call(E,o),O.callbacks=R),o.extra[l]=O}const f=new Set;let h=this;for(;h!=null&&!f.has(h.id);)f.add(h.id),h.child_execution_order=Math.max(h.child_execution_order,t),h=h.parent_run;return this.child_runs.push(o),o}async end(e,t,r=Date.now(),a){this.outputs=this.outputs??e,this.error=this.error??t,this.end_time=this.end_time??r,a&&Object.keys(a).length>0&&(this.extra=this.extra?{...this.extra,metadata:{...this.extra.metadata,...a}}:{metadata:a})}_convertToCreate(e,t,r=!0){var c,f;const a=e.extra??{};if(((c=a==null?void 0:a.runtime)==null?void 0:c.library)===void 0&&(a.runtime||(a.runtime={}),t))for(const[h,m]of Object.entries(t))a.runtime[h]||(a.runtime[h]=m);let o,l;return r?(l=((f=e.parent_run)==null?void 0:f.id)??e.parent_run_id,o=[]):(o=e.child_runs.map(h=>this._convertToCreate(h,t,r)),l=void 0),{id:e.id,name:e.name,start_time:e._serialized_start_time??e.start_time,end_time:e.end_time,run_type:e.run_type,reference_example_id:e.reference_example_id,extra:a,serialized:e.serialized,error:e.error,inputs:e.inputs,outputs:e.outputs,session_name:e.project_name,child_runs:o,parent_run_id:l,trace_id:e.trace_id,dotted_order:e.dotted_order,tags:e.tags,attachments:e.attachments,events:e.events}}_sliceParentId(e,t){if(t.dotted_order){const r=t.dotted_order.split(".");let a=null;for(let o=0;o<r.length;o++)if(r[o].slice(-36)===e){a=o;break}if(a!==null){const o=r.slice(a+1);t.dotted_order=o.join("."),o.length>0?t.trace_id=o[0].slice(-36):t.trace_id=t.id}}t.parent_run_id===e&&(t.parent_run_id=void 0)}_setReplicaTraceRoot(e,t){const r=Tg(this,Tc)??{};r[e]=t,HE(this,Tc,r);for(const a of this.child_runs)a._setReplicaTraceRoot(e,t)}_remapForProject(e){const{projectName:t,runtimeEnv:r,excludeChildRuns:a=!0,reroot:o=!1,distributedParentId:l,apiUrl:c,apiKey:f,workspaceId:h}=e,m=this._convertToCreate(this,r,a);if(t===this.project_name)return{...m,session_name:t};if(o){if(l)this._sliceParentId(l,m);else if(m.parent_run_id=void 0,m.dotted_order){const R=m.dotted_order.split(".");R.length>0&&(m.dotted_order=R[R.length-1],m.trace_id=m.id)}const O=xg({projectName:t,apiUrl:c,apiKey:f,workspaceId:h});this._setReplicaTraceRoot(O,m.id)}let _;if(!o){const O=Tg(this,Tc)??{},R=xg({projectName:t,apiUrl:c,apiKey:f,workspaceId:h});if(_=O[R],_&&(m.trace_id=_,m.dotted_order)){const T=m.dotted_order.split(".");let $=null;for(let P=0;P<T.length;P++)if(T[P].slice(-36)===_){$=P;break}if($!==null){const P=T.slice($);m.dotted_order=P.join(".")}}}const y=m.id,w=ns(`${y}:${t}`,rs);let b;m.trace_id?b=ns(`${m.trace_id}:${t}`,rs):b=w;let E;m.parent_run_id&&(E=ns(`${m.parent_run_id}:${t}`,rs));let S;return m.dotted_order&&(S=m.dotted_order.split(".").map(T=>{const $=T.slice(-36),P=ns(`${$}:${t}`,rs);return T.slice(0,-36)+P}).join(".")),{...m,id:w,trace_id:b,parent_run_id:E,dotted_order:S,session_name:t}}async postRun(e=!0){try{const t=fy();if(this.replicas&&this.replicas.length>0)for(const{projectName:r,apiKey:a,apiUrl:o,workspaceId:l,reroot:c}of this.replicas){const f=this._remapForProject({projectName:r??this.project_name,runtimeEnv:t,excludeChildRuns:!0,reroot:c,distributedParentId:this.distributedParentId,apiUrl:o,apiKey:a,workspaceId:l});await this.client.createRun(f,{apiKey:a,apiUrl:o,workspaceId:l})}else{const r=this._convertToCreate(this,t,e);await this.client.createRun(r)}if(!e){Wc("Posting with excludeChildRuns=false is deprecated and will be removed in a future version.");for(const r of this.child_runs)await r.postRun(!1)}}catch(t){console.error(`Error in postRun for run ${this.id}:`,t)}}async patchRun(e){var t;if(this.replicas&&this.replicas.length>0)for(const{projectName:r,apiKey:a,apiUrl:o,workspaceId:l,updates:c,reroot:f}of this.replicas){const h=this._remapForProject({projectName:r??this.project_name,runtimeEnv:void 0,excludeChildRuns:!0,reroot:f,distributedParentId:this.distributedParentId,apiUrl:o,apiKey:a,workspaceId:l}),m={id:h.id,name:h.name,run_type:h.run_type,start_time:h.start_time,outputs:h.outputs,error:h.error,parent_run_id:h.parent_run_id,session_name:h.session_name,reference_example_id:h.reference_example_id,end_time:h.end_time,dotted_order:h.dotted_order,trace_id:h.trace_id,events:h.events,tags:h.tags,extra:h.extra,attachments:this.attachments,...c};e!=null&&e.excludeInputs||(m.inputs=h.inputs),await this.client.updateRun(h.id,m,{apiKey:a,apiUrl:o,workspaceId:l})}else try{const r={name:this.name,run_type:this.run_type,start_time:this._serialized_start_time??this.start_time,end_time:this.end_time,error:this.error,outputs:this.outputs,parent_run_id:((t=this.parent_run)==null?void 0:t.id)??this.parent_run_id,reference_example_id:this.reference_example_id,extra:this.extra,events:this.events,dotted_order:this.dotted_order,trace_id:this.trace_id,tags:this.tags,attachments:this.attachments,session_name:this.project_name};e!=null&&e.excludeInputs||(r.inputs=this.inputs),await this.client.updateRun(this.id,r)}catch(r){console.error(`Error in patchRun for run ${this.id}`,r)}}toJSON(){return this._convertToCreate(this,void 0,!1)}addEvent(e){this.events||(this.events=[]),typeof e=="string"?this.events.push({name:"event",time:new Date().toISOString(),message:e}):this.events.push({...e,time:e.time??new Date().toISOString()})}static fromRunnableConfig(e,t){var h,m,_,y;const r=e==null?void 0:e.callbacks;let a,o,l,c=BE();if(r){const w=((h=r==null?void 0:r.getParentRunId)==null?void 0:h.call(r))??"",b=(m=r==null?void 0:r.handlers)==null?void 0:m.find(E=>(E==null?void 0:E.name)=="langchain_tracer");a=(_=b==null?void 0:b.getRun)==null?void 0:_.call(b,w),o=b==null?void 0:b.projectName,l=b==null?void 0:b.client,c=c||!!b}return a?new kt({name:a.name,id:a.id,trace_id:a.trace_id,dotted_order:a.dotted_order,client:l,tracingEnabled:c,project_name:o,tags:[...new Set(((a==null?void 0:a.tags)??[]).concat((e==null?void 0:e.tags)??[]))],extra:{metadata:{...(y=a==null?void 0:a.extra)==null?void 0:y.metadata,...e==null?void 0:e.metadata}}}).createChild(t):new kt({...t,client:l,tracingEnabled:c,project_name:o})}static fromDottedOrder(e){return this.fromHeaders({"langsmith-trace":e})}static fromHeaders(e,t){var m;const r="get"in e&&typeof e.get=="function"?{"langsmith-trace":e.get("langsmith-trace"),baggage:e.get("baggage")}:e,a=r["langsmith-trace"];if(!a||typeof a!="string")return;const o=a.trim(),l=o.split(".").map(_=>{const[y,w]=_.split("Z");return{strTime:y,time:Date.parse(y+"Z"),uuid:w}}),c=l[0].uuid,f={...t,name:(t==null?void 0:t.name)??"parent",run_type:(t==null?void 0:t.run_type)??"chain",start_time:(t==null?void 0:t.start_time)??Date.now(),id:(m=l.at(-1))==null?void 0:m.uuid,trace_id:c,dotted_order:o};if(r.baggage&&typeof r.baggage=="string"){const _=ro.fromHeader(r.baggage);f.metadata=_.metadata,f.tags=_.tags,f.project_name=_.project_name,f.replicas=_.replicas}const h=new kt(f);return h.distributedParentId=h.id,h}toHeaders(e){var r;const t={"langsmith-trace":this.dotted_order,baggage:new ro((r=this.extra)==null?void 0:r.metadata,this.tags,this.project_name,this.replicas).toHeader()};if(e)for(const[a,o]of Object.entries(t))e.set(a,o);return t}}Object.defineProperty(kt,"sharedClient",{enumerable:!0,configurable:!0,writable:!0,value:null});function qE(s){return s!=null&&typeof s.createChild=="function"&&typeof s.postRun=="function"}function ky(s){return typeof s=="object"&&s!=null&&typeof s.name=="string"&&s.name==="langchain_tracer"}function Rg(s){return Array.isArray(s)&&s.some(e=>ky(e))}function VE(s){return typeof s=="object"&&s!=null&&Array.isArray(s.handlers)}function ZE(s){const e=s==null?void 0:s.callbacks;return s!=null&&typeof e=="object"&&(Rg(e==null?void 0:e.handlers)||Rg(e))}function WE(){const s=hn("LANGSMITH_RUNS_ENDPOINTS");if(!s)return[];try{const e=JSON.parse(s);if(Array.isArray(e)){const t=[];for(const r of e){if(typeof r!="object"||r===null){console.warn(`Invalid item type in LANGSMITH_RUNS_ENDPOINTS: expected object, got ${typeof r}`);continue}if(typeof r.api_url!="string"){console.warn(`Invalid api_url type in LANGSMITH_RUNS_ENDPOINTS: expected string, got ${typeof r.api_url}`);continue}if(typeof r.api_key!="string"){console.warn(`Invalid api_key type in LANGSMITH_RUNS_ENDPOINTS: expected string, got ${typeof r.api_key}`);continue}t.push({apiUrl:r.api_url.replace(/\/$/,""),apiKey:r.api_key})}return t}else if(typeof e=="object"&&e!==null){JE(e);const t=[];for(const[r,a]of Object.entries(e)){const o=r.replace(/\/$/,"");if(typeof a=="string")t.push({apiUrl:o,apiKey:a});else{console.warn(`Invalid value type in LANGSMITH_RUNS_ENDPOINTS for URL ${r}: expected string, got ${typeof a}`);continue}}return t}else return console.warn(`Invalid LANGSMITH_RUNS_ENDPOINTS  must be valid JSON array of objects with api_url and api_key properties, or object mapping url->apiKey, got ${typeof e}`),[]}catch(e){if(RE(e))throw e;return console.warn("Invalid LANGSMITH_RUNS_ENDPOINTS  must be valid JSON array of objects with api_url and api_key properties, or object mapping url->apiKey"),[]}}function KE(s){return s?s.map(e=>Array.isArray(e)?{projectName:e[0],updates:e[1]}:e):WE()}function JE(s){if(Object.keys(s).length>0&&xt("ENDPOINT"))throw new xE}var xc,Ig;function QE(){return Ig||(Ig=1,xc=function(s,e){if(typeof s!="string")throw new TypeError("Expected a string");return e=typeof e>"u"?"_":e,s.replace(/([a-z\d])([A-Z])/g,"$1"+e+"$2").replace(/([A-Z]+)([A-Z][a-z\d]+)/g,"$1"+e+"$2").toLowerCase()}),xc}var YE=QE();const XE=Or(YE);var Ha={exports:{}},Cg;function eS(){if(Cg)return Ha.exports;Cg=1;const s=/[\p{Lu}]/u,e=/[\p{Ll}]/u,t=/^[\p{Lu}](?![\p{Lu}])/gu,r=/([\p{Alpha}\p{N}_]|$)/u,a=/[_.\- ]+/,o=new RegExp("^"+a.source),l=new RegExp(a.source+r.source,"gu"),c=new RegExp("\\d+"+r.source,"gu"),f=(y,w,b)=>{let E=!1,S=!1,O=!1;for(let R=0;R<y.length;R++){const T=y[R];E&&s.test(T)?(y=y.slice(0,R)+"-"+y.slice(R),E=!1,O=S,S=!0,R++):S&&O&&e.test(T)?(y=y.slice(0,R-1)+"-"+y.slice(R-1),O=S,S=!1,E=!0):(E=w(T)===T&&b(T)!==T,O=S,S=b(T)===T&&w(T)!==T)}return y},h=(y,w)=>(t.lastIndex=0,y.replace(t,b=>w(b))),m=(y,w)=>(l.lastIndex=0,c.lastIndex=0,y.replace(l,(b,E)=>w(E)).replace(c,b=>w(b))),_=(y,w)=>{if(!(typeof y=="string"||Array.isArray(y)))throw new TypeError("Expected the input to be `string | string[]`");if(w={pascalCase:!1,preserveConsecutiveUppercase:!1,...w},Array.isArray(y)?y=y.map(O=>O.trim()).filter(O=>O.length).join("-"):y=y.trim(),y.length===0)return"";const b=w.locale===!1?O=>O.toLowerCase():O=>O.toLocaleLowerCase(w.locale),E=w.locale===!1?O=>O.toUpperCase():O=>O.toLocaleUpperCase(w.locale);return y.length===1?w.pascalCase?E(y):b(y):(y!==b(y)&&(y=f(y,b,E)),y=y.replace(o,""),w.preserveConsecutiveUppercase?y=h(y,b):y=b(y),w.pascalCase&&(y=E(y.charAt(0))+y.slice(1)),m(y,E))};return Ha.exports=_,Ha.exports.default=_,Ha.exports}eS();function tS(s,e){return(e==null?void 0:e[s])||XE(s)}function nS(s,e,t){const r={};for(const a in s)Object.hasOwn(s,a)&&(r[e(a,t)]=s[a]);return r}const Ty="__lc_escaped__";function rS(s){return"lc"in s||Object.keys(s).length===1&&Ty in s}function iS(s){return{[Ty]:s}}function sS(s){return s!==null&&typeof s=="object"&&"lc_serializable"in s&&typeof s.toJSON=="function"}function Jc(s){if(s!==null&&typeof s=="object"&&!Array.isArray(s)){if(sS(s))return s;const e=s;if(rS(e))return iS(e);const t={};for(const[r,a]of Object.entries(e))t[r]=Jc(a);return t}return Array.isArray(s)?s.map(e=>Jc(e)):s}function Ng(s){return Array.isArray(s)?[...s]:{...s}}function aS(s,e){const t=Ng(s);for(const[r,a]of Object.entries(e)){const[o,...l]=r.split(".").reverse();let c=t;for(const f of l.reverse()){if(c[f]===void 0)break;c[f]=Ng(c[f]),c=c[f]}c[o]!==void 0&&(c[o]={lc:1,type:"secret",id:[a]})}return t}function xy(s){const e=Object.getPrototypeOf(s);return typeof s.lc_name=="function"&&(typeof e.lc_name!="function"||s.lc_name()!==e.lc_name())?s.lc_name():s.name}class oi{static lc_name(){return this.name}get lc_id(){return[...this.lc_namespace,xy(this.constructor)]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}get lc_serializable_keys(){}constructor(e,...t){Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.lc_serializable_keys!==void 0?this.lc_kwargs=Object.fromEntries(Object.entries(e||{}).filter(([r])=>{var a;return(a=this.lc_serializable_keys)==null?void 0:a.includes(r)})):this.lc_kwargs=e??{}}toJSON(){if(!this.lc_serializable)return this.toJSONNotImplemented();if(this.lc_kwargs instanceof oi||typeof this.lc_kwargs!="object"||Array.isArray(this.lc_kwargs))return this.toJSONNotImplemented();const e={},t={},r=Object.keys(this.lc_kwargs).reduce((c,f)=>(c[f]=f in this?this[f]:this.lc_kwargs[f],c),{});for(let c=Object.getPrototypeOf(this);c;c=Object.getPrototypeOf(c))Object.assign(e,Reflect.get(c,"lc_aliases",this)),Object.assign(t,Reflect.get(c,"lc_secrets",this)),Object.assign(r,Reflect.get(c,"lc_attributes",this));Object.keys(t).forEach(c=>{let f=this,h=r;const[m,..._]=c.split(".").reverse();for(const y of _.reverse()){if(!(y in f)||f[y]===void 0)return;(!(y in h)||h[y]===void 0)&&(typeof f[y]=="object"&&f[y]!=null?h[y]={}:Array.isArray(f[y])&&(h[y]=[])),f=f[y],h=h[y]}m in f&&f[m]!==void 0&&(h[m]=h[m]||f[m])});const a={};for(const[c,f]of Object.entries(r))a[c]=Jc(f);const o=Object.keys(t).length?aS(a,t):a,l=nS(o,tS,e);return{lc:1,type:"constructor",id:this.lc_id,kwargs:l}}toJSONNotImplemented(){return{lc:1,type:"not_implemented",id:this.lc_id}}}var Rc={};const oS=()=>typeof window<"u"&&typeof window.document<"u",uS=()=>typeof globalThis=="object"&&globalThis.constructor&&globalThis.constructor.name==="DedicatedWorkerGlobalScope",lS=()=>typeof window<"u"&&window.name==="nodejs"||typeof navigator<"u"&&navigator.userAgent.includes("jsdom"),pd=()=>typeof Deno<"u",cS=()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"&&!pd(),dS=()=>{let s;return oS()?s="browser":cS()?s="node":uS()?s="webworker":lS()?s="jsdom":pd()?s="deno":s="other",s};let Ic;function fS(){return Ic===void 0&&(Ic={library:"langchain-js",runtime:dS()}),Ic}function ti(s){try{return typeof process<"u"?Rc==null?void 0:Rc[s]:pd()?Deno==null?void 0:Deno.env.get(s):void 0}catch{return}}class hS{}class Es extends hS{get lc_namespace(){return["langchain_core","callbacks",this.name]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}get lc_serializable_keys(){}static lc_name(){return this.name}get lc_id(){return[...this.lc_namespace,xy(this.constructor)]}constructor(e){super(),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ignoreLLM",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreChain",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreAgent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreRetriever",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreCustomEvent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"raiseError",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"awaitHandlers",{enumerable:!0,configurable:!0,writable:!0,value:ti("LANGCHAIN_CALLBACKS_BACKGROUND")==="false"}),this.lc_kwargs=e||{},e&&(this.ignoreLLM=e.ignoreLLM??this.ignoreLLM,this.ignoreChain=e.ignoreChain??this.ignoreChain,this.ignoreAgent=e.ignoreAgent??this.ignoreAgent,this.ignoreRetriever=e.ignoreRetriever??this.ignoreRetriever,this.ignoreCustomEvent=e.ignoreCustomEvent??this.ignoreCustomEvent,this.raiseError=e.raiseError??this.raiseError,this.awaitHandlers=this.raiseError||(e._awaitHandler??this.awaitHandlers))}copy(){return new this.constructor(this)}toJSON(){return oi.prototype.toJSON.call(this)}toJSONNotImplemented(){return oi.prototype.toJSONNotImplemented.call(this)}static fromMethods(e){class t extends Es{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:Tt()}),Object.assign(this,e)}}return new t}}const pS=s=>{const e=s;return e!==void 0&&typeof e.copy=="function"&&typeof e.name=="string"&&typeof e.awaitHandlers=="boolean"},mS=s=>{if(s)return s.events=s.events??[],s.child_runs=s.child_runs??[],s};function Qc(s,e){if(s)return new kt({...s,start_time:s._serialized_start_time??s.start_time,parent_run:Qc(e),child_runs:s.child_runs.map(t=>Qc(t)).filter(t=>t!==void 0),extra:{...s.extra,runtime:fS()},tracingEnabled:!1})}function Cc(s,e){return s&&!Array.isArray(s)&&typeof s=="object"?s:{[e]:s}}function Xi(s){return typeof s._addRunToRunMap=="function"}class Ss extends Es{constructor(e){super(...arguments),Object.defineProperty(this,"runMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"runTreeMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"usesRunTreeMap",{enumerable:!0,configurable:!0,writable:!0,value:!1})}copy(){return this}getRunById(e){if(e!==void 0)return this.usesRunTreeMap?mS(this.runTreeMap.get(e)):this.runMap.get(e)}stringifyError(e){return e instanceof Error?e.message+(e!=null&&e.stack?`

${e.stack}`:""):typeof e=="string"?e:`${e}`}_addChildRun(e,t){e.child_runs.push(t)}_addRunToRunMap(e){const{dottedOrder:t,microsecondPrecisionDatestring:r}=Oy(new Date(e.start_time).getTime(),e.id,e.execution_order),a={...e},o=this.getRunById(a.parent_run_id);if(a.parent_run_id!==void 0?o&&(this._addChildRun(o,a),o.child_execution_order=Math.max(o.child_execution_order,a.child_execution_order),a.trace_id=o.trace_id,o.dotted_order!==void 0&&(a.dotted_order=[o.dotted_order,t].join("."),a._serialized_start_time=r)):(a.trace_id=a.id,a.dotted_order=t,a._serialized_start_time=r),this.usesRunTreeMap){const l=Qc(a,o);l!==void 0&&this.runTreeMap.set(a.id,l)}else this.runMap.set(a.id,a);return a}async _endTrace(e){var r;const t=e.parent_run_id!==void 0&&this.getRunById(e.parent_run_id);t?t.child_execution_order=Math.max(t.child_execution_order,e.child_execution_order):await this.persistRun(e),await((r=this.onRunUpdate)==null?void 0:r.call(this,e)),this.usesRunTreeMap?this.runTreeMap.delete(e.id):this.runMap.delete(e.id)}_getExecutionOrder(e){const t=e!==void 0&&this.getRunById(e);return t?t.child_execution_order+1:1}_createRunForLLMStart(e,t,r,a,o,l,c,f){const h=this._getExecutionOrder(a),m=Date.now(),_=c?{...o,metadata:c}:o,y={id:r,name:f??e.id[e.id.length-1],parent_run_id:a,start_time:m,serialized:e,events:[{name:"start",time:new Date(m).toISOString()}],inputs:{prompts:t},execution_order:h,child_runs:[],child_execution_order:h,run_type:"llm",extra:_??{},tags:l||[]};return this._addRunToRunMap(y)}async handleLLMStart(e,t,r,a,o,l,c,f){var m,_;const h=this.getRunById(r)??this._createRunForLLMStart(e,t,r,a,o,l,c,f);return await((m=this.onRunCreate)==null?void 0:m.call(this,h)),await((_=this.onLLMStart)==null?void 0:_.call(this,h)),h}_createRunForChatModelStart(e,t,r,a,o,l,c,f){const h=this._getExecutionOrder(a),m=Date.now(),_=c?{...o,metadata:c}:o,y={id:r,name:f??e.id[e.id.length-1],parent_run_id:a,start_time:m,serialized:e,events:[{name:"start",time:new Date(m).toISOString()}],inputs:{messages:t},execution_order:h,child_runs:[],child_execution_order:h,run_type:"llm",extra:_??{},tags:l||[]};return this._addRunToRunMap(y)}async handleChatModelStart(e,t,r,a,o,l,c,f){var m,_;const h=this.getRunById(r)??this._createRunForChatModelStart(e,t,r,a,o,l,c,f);return await((m=this.onRunCreate)==null?void 0:m.call(this,h)),await((_=this.onLLMStart)==null?void 0:_.call(this,h)),h}async handleLLMEnd(e,t,r,a,o){var c;const l=this.getRunById(t);if(!l||(l==null?void 0:l.run_type)!=="llm")throw new Error("No LLM run to end.");return l.end_time=Date.now(),l.outputs=e,l.events.push({name:"end",time:new Date(l.end_time).toISOString()}),l.extra={...l.extra,...o},await((c=this.onLLMEnd)==null?void 0:c.call(this,l)),await this._endTrace(l),l}async handleLLMError(e,t,r,a,o){var c;const l=this.getRunById(t);if(!l||(l==null?void 0:l.run_type)!=="llm")throw new Error("No LLM run to end.");return l.end_time=Date.now(),l.error=this.stringifyError(e),l.events.push({name:"error",time:new Date(l.end_time).toISOString()}),l.extra={...l.extra,...o},await((c=this.onLLMError)==null?void 0:c.call(this,l)),await this._endTrace(l),l}_createRunForChainStart(e,t,r,a,o,l,c,f){const h=this._getExecutionOrder(a),m=Date.now(),_={id:r,name:f??e.id[e.id.length-1],parent_run_id:a,start_time:m,serialized:e,events:[{name:"start",time:new Date(m).toISOString()}],inputs:t,execution_order:h,child_execution_order:h,run_type:c??"chain",child_runs:[],extra:l?{metadata:l}:{},tags:o||[]};return this._addRunToRunMap(_)}async handleChainStart(e,t,r,a,o,l,c,f){var m,_;const h=this.getRunById(r)??this._createRunForChainStart(e,t,r,a,o,l,c,f);return await((m=this.onRunCreate)==null?void 0:m.call(this,h)),await((_=this.onChainStart)==null?void 0:_.call(this,h)),h}async handleChainEnd(e,t,r,a,o){var c;const l=this.getRunById(t);if(!l)throw new Error("No chain run to end.");return l.end_time=Date.now(),l.outputs=Cc(e,"output"),l.events.push({name:"end",time:new Date(l.end_time).toISOString()}),(o==null?void 0:o.inputs)!==void 0&&(l.inputs=Cc(o.inputs,"input")),await((c=this.onChainEnd)==null?void 0:c.call(this,l)),await this._endTrace(l),l}async handleChainError(e,t,r,a,o){var c;const l=this.getRunById(t);if(!l)throw new Error("No chain run to end.");return l.end_time=Date.now(),l.error=this.stringifyError(e),l.events.push({name:"error",time:new Date(l.end_time).toISOString()}),(o==null?void 0:o.inputs)!==void 0&&(l.inputs=Cc(o.inputs,"input")),await((c=this.onChainError)==null?void 0:c.call(this,l)),await this._endTrace(l),l}_createRunForToolStart(e,t,r,a,o,l,c){const f=this._getExecutionOrder(a),h=Date.now(),m={id:r,name:c??e.id[e.id.length-1],parent_run_id:a,start_time:h,serialized:e,events:[{name:"start",time:new Date(h).toISOString()}],inputs:{input:t},execution_order:f,child_execution_order:f,run_type:"tool",child_runs:[],extra:l?{metadata:l}:{},tags:o||[]};return this._addRunToRunMap(m)}async handleToolStart(e,t,r,a,o,l,c){var h,m;const f=this.getRunById(r)??this._createRunForToolStart(e,t,r,a,o,l,c);return await((h=this.onRunCreate)==null?void 0:h.call(this,f)),await((m=this.onToolStart)==null?void 0:m.call(this,f)),f}async handleToolEnd(e,t){var a;const r=this.getRunById(t);if(!r||(r==null?void 0:r.run_type)!=="tool")throw new Error("No tool run to end");return r.end_time=Date.now(),r.outputs={output:e},r.events.push({name:"end",time:new Date(r.end_time).toISOString()}),await((a=this.onToolEnd)==null?void 0:a.call(this,r)),await this._endTrace(r),r}async handleToolError(e,t){var a;const r=this.getRunById(t);if(!r||(r==null?void 0:r.run_type)!=="tool")throw new Error("No tool run to end");return r.end_time=Date.now(),r.error=this.stringifyError(e),r.events.push({name:"error",time:new Date(r.end_time).toISOString()}),await((a=this.onToolError)==null?void 0:a.call(this,r)),await this._endTrace(r),r}async handleAgentAction(e,t){var o;const r=this.getRunById(t);if(!r||(r==null?void 0:r.run_type)!=="chain")return;const a=r;a.actions=a.actions||[],a.actions.push(e),a.events.push({name:"agent_action",time:new Date().toISOString(),kwargs:{action:e}}),await((o=this.onAgentAction)==null?void 0:o.call(this,r))}async handleAgentEnd(e,t){var a;const r=this.getRunById(t);!r||(r==null?void 0:r.run_type)!=="chain"||(r.events.push({name:"agent_end",time:new Date().toISOString(),kwargs:{action:e}}),await((a=this.onAgentEnd)==null?void 0:a.call(this,r)))}_createRunForRetrieverStart(e,t,r,a,o,l,c){const f=this._getExecutionOrder(a),h=Date.now(),m={id:r,name:c??e.id[e.id.length-1],parent_run_id:a,start_time:h,serialized:e,events:[{name:"start",time:new Date(h).toISOString()}],inputs:{query:t},execution_order:f,child_execution_order:f,run_type:"retriever",child_runs:[],extra:l?{metadata:l}:{},tags:o||[]};return this._addRunToRunMap(m)}async handleRetrieverStart(e,t,r,a,o,l,c){var h,m;const f=this.getRunById(r)??this._createRunForRetrieverStart(e,t,r,a,o,l,c);return await((h=this.onRunCreate)==null?void 0:h.call(this,f)),await((m=this.onRetrieverStart)==null?void 0:m.call(this,f)),f}async handleRetrieverEnd(e,t){var a;const r=this.getRunById(t);if(!r||(r==null?void 0:r.run_type)!=="retriever")throw new Error("No retriever run to end");return r.end_time=Date.now(),r.outputs={documents:e},r.events.push({name:"end",time:new Date(r.end_time).toISOString()}),await((a=this.onRetrieverEnd)==null?void 0:a.call(this,r)),await this._endTrace(r),r}async handleRetrieverError(e,t){var a;const r=this.getRunById(t);if(!r||(r==null?void 0:r.run_type)!=="retriever")throw new Error("No retriever run to end");return r.end_time=Date.now(),r.error=this.stringifyError(e),r.events.push({name:"error",time:new Date(r.end_time).toISOString()}),await((a=this.onRetrieverError)==null?void 0:a.call(this,r)),await this._endTrace(r),r}async handleText(e,t){var a;const r=this.getRunById(t);!r||(r==null?void 0:r.run_type)!=="chain"||(r.events.push({name:"text",time:new Date().toISOString(),kwargs:{text:e}}),await((a=this.onText)==null?void 0:a.call(this,r)))}async handleLLMNewToken(e,t,r,a,o,l){var f;const c=this.getRunById(r);if(!c||(c==null?void 0:c.run_type)!=="llm")throw new Error('Invalid "runId" provided to "handleLLMNewToken" callback.');return c.events.push({name:"new_token",time:new Date().toISOString(),kwargs:{token:e,idx:t,chunk:l==null?void 0:l.chunk}}),await((f=this.onLLMNewToken)==null?void 0:f.call(this,c,e,{chunk:l==null?void 0:l.chunk})),c}}var Za={exports:{}};Za.exports;var Ag;function gS(){return Ag||(Ag=1,(function(s){const t=(o=0)=>l=>`\x1B[${38+o};5;${l}m`,r=(o=0)=>(l,c,f)=>`\x1B[${38+o};2;${l};${c};${f}m`;function a(){const o=new Map,l={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};l.color.gray=l.color.blackBright,l.bgColor.bgGray=l.bgColor.bgBlackBright,l.color.grey=l.color.blackBright,l.bgColor.bgGrey=l.bgColor.bgBlackBright;for(const[c,f]of Object.entries(l)){for(const[h,m]of Object.entries(f))l[h]={open:`\x1B[${m[0]}m`,close:`\x1B[${m[1]}m`},f[h]=l[h],o.set(m[0],m[1]);Object.defineProperty(l,c,{value:f,enumerable:!1})}return Object.defineProperty(l,"codes",{value:o,enumerable:!1}),l.color.close="\x1B[39m",l.bgColor.close="\x1B[49m",l.color.ansi256=t(),l.color.ansi16m=r(),l.bgColor.ansi256=t(10),l.bgColor.ansi16m=r(10),Object.defineProperties(l,{rgbToAnsi256:{value:(c,f,h)=>c===f&&f===h?c<8?16:c>248?231:Math.round((c-8)/247*24)+232:16+36*Math.round(c/255*5)+6*Math.round(f/255*5)+Math.round(h/255*5),enumerable:!1},hexToRgb:{value:c=>{const f=/(?<colorString>[a-f\d]{6}|[a-f\d]{3})/i.exec(c.toString(16));if(!f)return[0,0,0];let{colorString:h}=f.groups;h.length===3&&(h=h.split("").map(_=>_+_).join(""));const m=Number.parseInt(h,16);return[m>>16&255,m>>8&255,m&255]},enumerable:!1},hexToAnsi256:{value:c=>l.rgbToAnsi256(...l.hexToRgb(c)),enumerable:!1}}),l}Object.defineProperty(s,"exports",{enumerable:!0,get:a})})(Za)),Za.exports}var yS=gS();const Ry=Or(yS);function pt(s,e){return`${s.open}${e}${s.close}`}function Ht(s,e){try{return JSON.stringify(s,null,2)}catch{return e}}function Pg(s){return typeof s=="string"?s.trim():s==null?s:Ht(s,s.toString())}function Vn(s){if(!s.end_time)return"";const e=s.end_time-s.start_time;return e<1e3?`${e}ms`:`${(e/1e3).toFixed(2)}s`}const{color:Ot}=Ry;class Lg extends Ss{constructor(){super(...arguments),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"console_callback_handler"})}persistRun(e){return Promise.resolve()}getParents(e){const t=[];let r=e;for(;r.parent_run_id;){const a=this.runMap.get(r.parent_run_id);if(a)t.push(a),r=a;else break}return t}getBreadcrumbs(e){const r=[...this.getParents(e).reverse(),e].map((a,o,l)=>{const c=`${a.execution_order}:${a.run_type}:${a.name}`;return o===l.length-1?pt(Ry.bold,c):c}).join(" > ");return pt(Ot.grey,r)}onChainStart(e){const t=this.getBreadcrumbs(e);console.log(`${pt(Ot.green,"[chain/start]")} [${t}] Entering Chain run with input: ${Ht(e.inputs,"[inputs]")}`)}onChainEnd(e){const t=this.getBreadcrumbs(e);console.log(`${pt(Ot.cyan,"[chain/end]")} [${t}] [${Vn(e)}] Exiting Chain run with output: ${Ht(e.outputs,"[outputs]")}`)}onChainError(e){const t=this.getBreadcrumbs(e);console.log(`${pt(Ot.red,"[chain/error]")} [${t}] [${Vn(e)}] Chain run errored with error: ${Ht(e.error,"[error]")}`)}onLLMStart(e){const t=this.getBreadcrumbs(e),r="prompts"in e.inputs?{prompts:e.inputs.prompts.map(a=>a.trim())}:e.inputs;console.log(`${pt(Ot.green,"[llm/start]")} [${t}] Entering LLM run with input: ${Ht(r,"[inputs]")}`)}onLLMEnd(e){const t=this.getBreadcrumbs(e);console.log(`${pt(Ot.cyan,"[llm/end]")} [${t}] [${Vn(e)}] Exiting LLM run with output: ${Ht(e.outputs,"[response]")}`)}onLLMError(e){const t=this.getBreadcrumbs(e);console.log(`${pt(Ot.red,"[llm/error]")} [${t}] [${Vn(e)}] LLM run errored with error: ${Ht(e.error,"[error]")}`)}onToolStart(e){const t=this.getBreadcrumbs(e);console.log(`${pt(Ot.green,"[tool/start]")} [${t}] Entering Tool run with input: "${Pg(e.inputs.input)}"`)}onToolEnd(e){var r;const t=this.getBreadcrumbs(e);console.log(`${pt(Ot.cyan,"[tool/end]")} [${t}] [${Vn(e)}] Exiting Tool run with output: "${Pg((r=e.outputs)==null?void 0:r.output)}"`)}onToolError(e){const t=this.getBreadcrumbs(e);console.log(`${pt(Ot.red,"[tool/error]")} [${t}] [${Vn(e)}] Tool run errored with error: ${Ht(e.error,"[error]")}`)}onRetrieverStart(e){const t=this.getBreadcrumbs(e);console.log(`${pt(Ot.green,"[retriever/start]")} [${t}] Entering Retriever run with input: ${Ht(e.inputs,"[inputs]")}`)}onRetrieverEnd(e){const t=this.getBreadcrumbs(e);console.log(`${pt(Ot.cyan,"[retriever/end]")} [${t}] [${Vn(e)}] Exiting Retriever run with output: ${Ht(e.outputs,"[outputs]")}`)}onRetrieverError(e){const t=this.getBreadcrumbs(e);console.log(`${pt(Ot.red,"[retriever/error]")} [${t}] [${Vn(e)}] Retriever run errored with error: ${Ht(e.error,"[error]")}`)}onAgentAction(e){const t=e,r=this.getBreadcrumbs(e);console.log(`${pt(Ot.blue,"[agent/action]")} [${r}] Agent selected action: ${Ht(t.actions[t.actions.length-1],"[action]")}`)}}function _S(s){return!!(s&&typeof s=="object"&&"type"in s&&s.type==="tool_call")}class vS extends Error{constructor(e,t){super(e),Object.defineProperty(this,"output",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.output=t}}function wS(s){if(typeof s>"u")return null;try{return JSON.parse(s)}catch{}let e="";const t=[];let r=!1,a=!1;for(let o of s){if(r)o==='"'&&!a?r=!1:o===`
`&&!a?o="\\n":o==="\\"?a=!a:a=!1;else if(o==='"')r=!0,a=!1;else if(o==="{")t.push("}");else if(o==="[")t.push("]");else if(o==="}"||o==="]")if(t&&t[t.length-1]===o)t.pop();else return null;e+=o}r&&(e+='"');for(let o=t.length-1;o>=0;o-=1)e+=t[o];try{return JSON.parse(e)}catch{return null}}function jg(s){return typeof s=="object"&&s!==null&&"type"in s&&typeof s.type=="string"&&"source_type"in s&&(s.source_type==="url"||s.source_type==="base64"||s.source_type==="text"||s.source_type==="id")}function bS(s,e){return typeof s=="string"?s===""?e:typeof e=="string"?s+e:Array.isArray(e)&&e.some(t=>jg(t))?[{type:"text",source_type:"text",text:s},...e]:[{type:"text",text:s},...e]:Array.isArray(e)?md(s,e)??[...s,...e]:e===""?s:Array.isArray(s)&&s.some(t=>jg(t))?[...s,{type:"file",source_type:"text",text:e}]:[...s,{type:"text",text:e}]}function ES(s,e){function t(r,a){if(typeof r!="object"||r===null||r===void 0)return r;if(a>=e)return Array.isArray(r)?"[Array]":"[Object]";if(Array.isArray(r))return r.map(l=>t(l,a+1));const o={};for(const l of Object.keys(r))o[l]=t(r[l],a+1);return o}return JSON.stringify(t(s,0),null,2)}class SS extends oi{get lc_aliases(){return{additional_kwargs:"additional_kwargs",response_metadata:"response_metadata"}}get text(){return typeof this.content=="string"?this.content:Array.isArray(this.content)?this.content.map(e=>typeof e=="string"?e:e.type==="text"?e.text:"").join(""):""}getType(){return this._getType()}constructor(e,t){typeof e=="string"&&(e={content:e,additional_kwargs:t,response_metadata:{}}),e.additional_kwargs||(e.additional_kwargs={}),e.response_metadata||(e.response_metadata={}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","messages"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"content",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"additional_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"response_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e.name,this.content=e.content,this.additional_kwargs=e.additional_kwargs,this.response_metadata=e.response_metadata,this.id=e.id}toDict(){return{type:this._getType(),data:this.toJSON().kwargs}}static lc_name(){return"BaseMessage"}get _printableFields(){return{id:this.id,content:this.content,name:this.name,additional_kwargs:this.additional_kwargs,response_metadata:this.response_metadata}}_updateId(e){this.id=e,this.lc_kwargs.id=e}get[Symbol.toStringTag](){return this.constructor.lc_name()}[Symbol.for("nodejs.util.inspect.custom")](e){if(e===null)return this;const t=ES(this._printableFields,Math.max(4,e));return`${this.constructor.lc_name()} ${t}`}}function io(s,e){const t={...s};for(const[r,a]of Object.entries(e))if(t[r]==null)t[r]=a;else{if(a==null)continue;if(typeof t[r]!=typeof a||Array.isArray(t[r])!==Array.isArray(a))throw new Error(`field[${r}] already exists in the message chunk, but with a different type.`);if(typeof t[r]=="string"){if(r==="type")continue;["id","name","output_version","model_provider"].includes(r)?t[r]=a:t[r]+=a}else if(typeof t[r]=="object"&&!Array.isArray(t[r]))t[r]=io(t[r],a);else if(Array.isArray(t[r]))t[r]=md(t[r],a);else{if(t[r]===a)continue;console.warn(`field[${r}] already exists in this message chunk and value has unsupported type.`)}}return t}function md(s,e){if(!(s===void 0&&e===void 0)){if(s===void 0||e===void 0)return s||e;{const t=[...s];for(const r of e)if(typeof r=="object"&&r!==null&&"index"in r&&typeof r.index=="number"){const a=t.findIndex(o=>{const l=typeof o=="object",c="index"in o&&o.index===r.index,f="id"in o&&"id"in r&&(o==null?void 0:o.id)===(r==null?void 0:r.id),h=!("id"in o)||!(o!=null&&o.id)||!("id"in r)||!(r!=null&&r.id);return l&&c&&(f||h)});a!==-1&&typeof t[a]=="object"&&t[a]!==null?t[a]=io(t[a],r):t.push(r)}else{if(typeof r=="object"&&r!==null&&"text"in r&&r.text==="")continue;t.push(r)}return t}}}class OS extends SS{}class vo extends OS{constructor(e){var r,a;let t;if(typeof e=="string")t={content:e,tool_calls:[],invalid_tool_calls:[],tool_call_chunks:[]};else if(e.tool_call_chunks===void 0||e.tool_call_chunks.length===0)t={...e,tool_calls:e.tool_calls??[],invalid_tool_calls:[],tool_call_chunks:[],usage_metadata:e.usage_metadata!==void 0?e.usage_metadata:void 0};else{const l=(e.tool_call_chunks??[]).reduce((h,m)=>{const _=h.findIndex(([y])=>"id"in m&&m.id&&"index"in m&&m.index!==void 0?m.id===y.id&&m.index===y.index:"id"in m&&m.id?m.id===y.id:"index"in m&&m.index!==void 0?m.index===y.index:!1);return _!==-1?h[_].push(m):h.push([m]),h},[]),c=[],f=[];for(const h of l){let m={};const _=((r=h[0])==null?void 0:r.name)??"",y=h.map(E=>E.args||"").join(""),w=y.length?y:"{}",b=(a=h[0])==null?void 0:a.id;try{if(m=wS(w),!b||m===null||typeof m!="object"||Array.isArray(m))throw new Error("Malformed tool call chunk args.");c.push({name:_,args:m,id:b,type:"tool_call"})}catch{f.push({name:_,args:w,id:b,error:"Malformed args.",type:"invalid_tool_call"})}}t={...e,tool_calls:c,invalid_tool_calls:f,usage_metadata:e.usage_metadata!==void 0?e.usage_metadata:void 0}}super(t),Object.defineProperty(this,"tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"invalid_tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"tool_call_chunks",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"usage_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tool_call_chunks=t.tool_call_chunks??this.tool_call_chunks,this.tool_calls=t.tool_calls??this.tool_calls,this.invalid_tool_calls=t.invalid_tool_calls??this.invalid_tool_calls,this.usage_metadata=t.usage_metadata}get lc_aliases(){return{...super.lc_aliases,tool_calls:"tool_calls",invalid_tool_calls:"invalid_tool_calls",tool_call_chunks:"tool_call_chunks"}}static lc_name(){return"AIMessageChunk"}_getType(){return"ai"}get _printableFields(){return{...super._printableFields,tool_calls:this.tool_calls,tool_call_chunks:this.tool_call_chunks,invalid_tool_calls:this.invalid_tool_calls,usage_metadata:this.usage_metadata}}concat(e){var r,a,o,l,c,f,h,m,_,y,w,b,E,S,O,R,T,$,P,z,Q,W,Ee,Ae,He,Ue,Ge,K,G,ee,J,D,U,M,I,j,te,le,ce,ge;const t={content:bS(this.content,e.content),additional_kwargs:io(this.additional_kwargs,e.additional_kwargs),response_metadata:io(this.response_metadata,e.response_metadata),tool_call_chunks:[],id:this.id??e.id};if(this.tool_call_chunks!==void 0||e.tool_call_chunks!==void 0){const ve=md(this.tool_call_chunks,e.tool_call_chunks);ve!==void 0&&ve.length>0&&(t.tool_call_chunks=ve)}if(this.usage_metadata!==void 0||e.usage_metadata!==void 0){const ve={...(((a=(r=this.usage_metadata)==null?void 0:r.input_token_details)==null?void 0:a.audio)!==void 0||((l=(o=e.usage_metadata)==null?void 0:o.input_token_details)==null?void 0:l.audio)!==void 0)&&{audio:(((f=(c=this.usage_metadata)==null?void 0:c.input_token_details)==null?void 0:f.audio)??0)+(((m=(h=e.usage_metadata)==null?void 0:h.input_token_details)==null?void 0:m.audio)??0)},...(((y=(_=this.usage_metadata)==null?void 0:_.input_token_details)==null?void 0:y.cache_read)!==void 0||((b=(w=e.usage_metadata)==null?void 0:w.input_token_details)==null?void 0:b.cache_read)!==void 0)&&{cache_read:(((S=(E=this.usage_metadata)==null?void 0:E.input_token_details)==null?void 0:S.cache_read)??0)+(((R=(O=e.usage_metadata)==null?void 0:O.input_token_details)==null?void 0:R.cache_read)??0)},...((($=(T=this.usage_metadata)==null?void 0:T.input_token_details)==null?void 0:$.cache_creation)!==void 0||((z=(P=e.usage_metadata)==null?void 0:P.input_token_details)==null?void 0:z.cache_creation)!==void 0)&&{cache_creation:(((W=(Q=this.usage_metadata)==null?void 0:Q.input_token_details)==null?void 0:W.cache_creation)??0)+(((Ae=(Ee=e.usage_metadata)==null?void 0:Ee.input_token_details)==null?void 0:Ae.cache_creation)??0)}},Se={...(((Ue=(He=this.usage_metadata)==null?void 0:He.output_token_details)==null?void 0:Ue.audio)!==void 0||((K=(Ge=e.usage_metadata)==null?void 0:Ge.output_token_details)==null?void 0:K.audio)!==void 0)&&{audio:(((ee=(G=this.usage_metadata)==null?void 0:G.output_token_details)==null?void 0:ee.audio)??0)+(((D=(J=e.usage_metadata)==null?void 0:J.output_token_details)==null?void 0:D.audio)??0)},...(((M=(U=this.usage_metadata)==null?void 0:U.output_token_details)==null?void 0:M.reasoning)!==void 0||((j=(I=e.usage_metadata)==null?void 0:I.output_token_details)==null?void 0:j.reasoning)!==void 0)&&{reasoning:(((le=(te=this.usage_metadata)==null?void 0:te.output_token_details)==null?void 0:le.reasoning)??0)+(((ge=(ce=e.usage_metadata)==null?void 0:ce.output_token_details)==null?void 0:ge.reasoning)??0)}},Ce=this.usage_metadata??{input_tokens:0,output_tokens:0,total_tokens:0},nt=e.usage_metadata??{input_tokens:0,output_tokens:0,total_tokens:0},kr={input_tokens:Ce.input_tokens+nt.input_tokens,output_tokens:Ce.output_tokens+nt.output_tokens,total_tokens:Ce.total_tokens+nt.total_tokens,...Object.keys(ve).length>0&&{input_token_details:ve},...Object.keys(Se).length>0&&{output_token_details:Se}};t.usage_metadata=kr}return new vo(t)}}function kS(s,e="Human",t="AI"){const r=[];for(const a of s){let o;if(a._getType()==="human")o=e;else if(a._getType()==="ai")o=t;else if(a._getType()==="system")o="System";else if(a._getType()==="function")o="Function";else if(a._getType()==="tool")o="Tool";else if(a._getType()==="generic")o=a.role;else throw new Error(`Got unsupported message type: ${a._getType()}`);const l=a.name?`${a.name}, `:"",c=typeof a.content=="string"?a.content:JSON.stringify(a.content,null,2);r.push(`${o}: ${l}${c}`)}return r.join(`
`)}let Nc;const TS=()=>{if(Nc===void 0){const s=ti("LANGCHAIN_CALLBACKS_BACKGROUND")==="false"?{blockOnRootRunFinalization:!0}:{};Nc=new ys(s)}return Nc};class ls extends Ss{constructor(e={}){super(e),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"langchain_tracer"}),Object.defineProperty(this,"projectName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"exampleId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"replicas",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"usesRunTreeMap",{enumerable:!0,configurable:!0,writable:!0,value:!0});const{exampleId:t,projectName:r,client:a,replicas:o}=e;this.projectName=r??uy(),this.replicas=o,this.exampleId=t,this.client=a??TS();const l=ls.getTraceableRunTree();l&&this.updateFromRunTree(l)}async persistRun(e){}async onRunCreate(e){const t=this.getRunTreeWithTracingConfig(e.id);await(t==null?void 0:t.postRun())}async onRunUpdate(e){const t=this.getRunTreeWithTracingConfig(e.id);await(t==null?void 0:t.patchRun())}getRun(e){return this.runTreeMap.get(e)}updateFromRunTree(e){this.runTreeMap.set(e.id,e);let t=e;const r=new Set;for(;t.parent_run&&!(r.has(t.id)||(r.add(t.id),!t.parent_run));)t=t.parent_run;r.clear();const a=[t];for(;a.length>0;){const o=a.shift();!o||r.has(o.id)||(r.add(o.id),this.runTreeMap.set(o.id,o),o.child_runs&&a.push(...o.child_runs))}this.client=e.client??this.client,this.replicas=e.replicas??this.replicas,this.projectName=e.project_name??this.projectName,this.exampleId=e.reference_example_id??this.exampleId}getRunTreeWithTracingConfig(e){const t=this.runTreeMap.get(e);if(t)return new kt({...t,client:this.client,project_name:this.projectName,replicas:this.replicas,reference_example_id:this.exampleId,tracingEnabled:!0})}static getTraceableRunTree(){try{return L0(!0)}catch{return}}}const Iy=Symbol.for("ls:tracing_async_local_storage"),Wa=Symbol.for("lc:context_variables"),xS=s=>{globalThis[Iy]=s},_s=()=>globalThis[Iy];let cs;function RS(){const s="default"in En?En.default:En;return new s({autoStart:!0,concurrency:1})}function IS(){return typeof cs>"u"&&(cs=RS()),cs}async function Qe(s,e){if(e===!0){const t=_s();t!==void 0?await t.run(void 0,async()=>s()):await s()}else cs=IS(),cs.add(async()=>{const t=_s();t!==void 0?await t.run(void 0,async()=>s()):await s()})}const CS=s=>!!["LANGSMITH_TRACING_V2","LANGCHAIN_TRACING_V2","LANGSMITH_TRACING","LANGCHAIN_TRACING"].find(t=>ti(t)==="true");function Cy(s){var r;const e=_s();if(e===void 0)return;const t=e.getStore();return(r=t==null?void 0:t[Wa])==null?void 0:r[s]}const NS=Symbol("lc:configure_hooks"),AS=()=>Cy(NS)||[];class PS{setHandler(e){return this.setHandlers([e])}}class wo{constructor(e,t,r,a,o,l,c,f){Object.defineProperty(this,"runId",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:o}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:l}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:c}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:f})}get parentRunId(){return this._parentRunId}async handleText(e){await Promise.all(this.handlers.map(t=>Qe(async()=>{var r;try{await((r=t.handleText)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(a){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleText: ${a}`),t.raiseError)throw a}},t.awaitHandlers)))}async handleCustomEvent(e,t,r,a,o){await Promise.all(this.handlers.map(l=>Qe(async()=>{var c;try{await((c=l.handleCustomEvent)==null?void 0:c.call(l,e,t,this.runId,this.tags,this.metadata))}catch(f){if((l.raiseError?console.error:console.warn)(`Error in handler ${l.constructor.name}, handleCustomEvent: ${f}`),l.raiseError)throw f}},l.awaitHandlers)))}}class LS extends wo{getChild(e){const t=new tn(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}async handleRetrieverEnd(e){await Promise.all(this.handlers.map(t=>Qe(async()=>{var r;if(!t.ignoreRetriever)try{await((r=t.handleRetrieverEnd)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(a){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleRetriever`),t.raiseError)throw a}},t.awaitHandlers)))}async handleRetrieverError(e){await Promise.all(this.handlers.map(t=>Qe(async()=>{var r;if(!t.ignoreRetriever)try{await((r=t.handleRetrieverError)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(a){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleRetrieverError: ${a}`),t.raiseError)throw e}},t.awaitHandlers)))}}class $g extends wo{async handleLLMNewToken(e,t,r,a,o,l){await Promise.all(this.handlers.map(c=>Qe(async()=>{var f;if(!c.ignoreLLM)try{await((f=c.handleLLMNewToken)==null?void 0:f.call(c,e,t??{prompt:0,completion:0},this.runId,this._parentRunId,this.tags,l))}catch(h){if((c.raiseError?console.error:console.warn)(`Error in handler ${c.constructor.name}, handleLLMNewToken: ${h}`),c.raiseError)throw h}},c.awaitHandlers)))}async handleLLMError(e,t,r,a,o){await Promise.all(this.handlers.map(l=>Qe(async()=>{var c;if(!l.ignoreLLM)try{await((c=l.handleLLMError)==null?void 0:c.call(l,e,this.runId,this._parentRunId,this.tags,o))}catch(f){if((l.raiseError?console.error:console.warn)(`Error in handler ${l.constructor.name}, handleLLMError: ${f}`),l.raiseError)throw f}},l.awaitHandlers)))}async handleLLMEnd(e,t,r,a,o){await Promise.all(this.handlers.map(l=>Qe(async()=>{var c;if(!l.ignoreLLM)try{await((c=l.handleLLMEnd)==null?void 0:c.call(l,e,this.runId,this._parentRunId,this.tags,o))}catch(f){if((l.raiseError?console.error:console.warn)(`Error in handler ${l.constructor.name}, handleLLMEnd: ${f}`),l.raiseError)throw f}},l.awaitHandlers)))}}class jS extends wo{getChild(e){const t=new tn(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}async handleChainError(e,t,r,a,o){await Promise.all(this.handlers.map(l=>Qe(async()=>{var c;if(!l.ignoreChain)try{await((c=l.handleChainError)==null?void 0:c.call(l,e,this.runId,this._parentRunId,this.tags,o))}catch(f){if((l.raiseError?console.error:console.warn)(`Error in handler ${l.constructor.name}, handleChainError: ${f}`),l.raiseError)throw f}},l.awaitHandlers)))}async handleChainEnd(e,t,r,a,o){await Promise.all(this.handlers.map(l=>Qe(async()=>{var c;if(!l.ignoreChain)try{await((c=l.handleChainEnd)==null?void 0:c.call(l,e,this.runId,this._parentRunId,this.tags,o))}catch(f){if((l.raiseError?console.error:console.warn)(`Error in handler ${l.constructor.name}, handleChainEnd: ${f}`),l.raiseError)throw f}},l.awaitHandlers)))}async handleAgentAction(e){await Promise.all(this.handlers.map(t=>Qe(async()=>{var r;if(!t.ignoreAgent)try{await((r=t.handleAgentAction)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(a){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleAgentAction: ${a}`),t.raiseError)throw a}},t.awaitHandlers)))}async handleAgentEnd(e){await Promise.all(this.handlers.map(t=>Qe(async()=>{var r;if(!t.ignoreAgent)try{await((r=t.handleAgentEnd)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(a){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleAgentEnd: ${a}`),t.raiseError)throw a}},t.awaitHandlers)))}}class $S extends wo{getChild(e){const t=new tn(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}async handleToolError(e){await Promise.all(this.handlers.map(t=>Qe(async()=>{var r;if(!t.ignoreAgent)try{await((r=t.handleToolError)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(a){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleToolError: ${a}`),t.raiseError)throw a}},t.awaitHandlers)))}async handleToolEnd(e){await Promise.all(this.handlers.map(t=>Qe(async()=>{var r;if(!t.ignoreAgent)try{await((r=t.handleToolEnd)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(a){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleToolEnd: ${a}`),t.raiseError)throw a}},t.awaitHandlers)))}}class tn extends PS{constructor(e,t){super(),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"callback_manager"}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.handlers=(t==null?void 0:t.handlers)??this.handlers,this.inheritableHandlers=(t==null?void 0:t.inheritableHandlers)??this.inheritableHandlers,this.tags=(t==null?void 0:t.tags)??this.tags,this.inheritableTags=(t==null?void 0:t.inheritableTags)??this.inheritableTags,this.metadata=(t==null?void 0:t.metadata)??this.metadata,this.inheritableMetadata=(t==null?void 0:t.inheritableMetadata)??this.inheritableMetadata,this._parentRunId=e}getParentRunId(){return this._parentRunId}async handleLLMStart(e,t,r=void 0,a=void 0,o=void 0,l=void 0,c=void 0,f=void 0){return Promise.all(t.map(async(h,m)=>{const _=m===0&&r?r:Tt();return await Promise.all(this.handlers.map(y=>{if(!y.ignoreLLM)return Xi(y)&&y._createRunForLLMStart(e,[h],_,this._parentRunId,o,this.tags,this.metadata,f),Qe(async()=>{var w;try{await((w=y.handleLLMStart)==null?void 0:w.call(y,e,[h],_,this._parentRunId,o,this.tags,this.metadata,f))}catch(b){if((y.raiseError?console.error:console.warn)(`Error in handler ${y.constructor.name}, handleLLMStart: ${b}`),y.raiseError)throw b}},y.awaitHandlers)})),new $g(_,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChatModelStart(e,t,r=void 0,a=void 0,o=void 0,l=void 0,c=void 0,f=void 0){return Promise.all(t.map(async(h,m)=>{const _=m===0&&r?r:Tt();return await Promise.all(this.handlers.map(y=>{if(!y.ignoreLLM)return Xi(y)&&y._createRunForChatModelStart(e,[h],_,this._parentRunId,o,this.tags,this.metadata,f),Qe(async()=>{var w,b;try{if(y.handleChatModelStart)await((w=y.handleChatModelStart)==null?void 0:w.call(y,e,[h],_,this._parentRunId,o,this.tags,this.metadata,f));else if(y.handleLLMStart){const E=kS(h);await((b=y.handleLLMStart)==null?void 0:b.call(y,e,[E],_,this._parentRunId,o,this.tags,this.metadata,f))}}catch(E){if((y.raiseError?console.error:console.warn)(`Error in handler ${y.constructor.name}, handleLLMStart: ${E}`),y.raiseError)throw E}},y.awaitHandlers)})),new $g(_,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChainStart(e,t,r=Tt(),a=void 0,o=void 0,l=void 0,c=void 0){return await Promise.all(this.handlers.map(f=>{if(!f.ignoreChain)return Xi(f)&&f._createRunForChainStart(e,t,r,this._parentRunId,this.tags,this.metadata,a,c),Qe(async()=>{var h;try{await((h=f.handleChainStart)==null?void 0:h.call(f,e,t,r,this._parentRunId,this.tags,this.metadata,a,c))}catch(m){if((f.raiseError?console.error:console.warn)(`Error in handler ${f.constructor.name}, handleChainStart: ${m}`),f.raiseError)throw m}},f.awaitHandlers)})),new jS(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleToolStart(e,t,r=Tt(),a=void 0,o=void 0,l=void 0,c=void 0){return await Promise.all(this.handlers.map(f=>{if(!f.ignoreAgent)return Xi(f)&&f._createRunForToolStart(e,t,r,this._parentRunId,this.tags,this.metadata,c),Qe(async()=>{var h;try{await((h=f.handleToolStart)==null?void 0:h.call(f,e,t,r,this._parentRunId,this.tags,this.metadata,c))}catch(m){if((f.raiseError?console.error:console.warn)(`Error in handler ${f.constructor.name}, handleToolStart: ${m}`),f.raiseError)throw m}},f.awaitHandlers)})),new $S(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleRetrieverStart(e,t,r=Tt(),a=void 0,o=void 0,l=void 0,c=void 0){return await Promise.all(this.handlers.map(f=>{if(!f.ignoreRetriever)return Xi(f)&&f._createRunForRetrieverStart(e,t,r,this._parentRunId,this.tags,this.metadata,c),Qe(async()=>{var h;try{await((h=f.handleRetrieverStart)==null?void 0:h.call(f,e,t,r,this._parentRunId,this.tags,this.metadata,c))}catch(m){if((f.raiseError?console.error:console.warn)(`Error in handler ${f.constructor.name}, handleRetrieverStart: ${m}`),f.raiseError)throw m}},f.awaitHandlers)})),new LS(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleCustomEvent(e,t,r,a,o){await Promise.all(this.handlers.map(l=>Qe(async()=>{var c;if(!l.ignoreCustomEvent)try{await((c=l.handleCustomEvent)==null?void 0:c.call(l,e,t,r,this.tags,this.metadata))}catch(f){if((l.raiseError?console.error:console.warn)(`Error in handler ${l.constructor.name}, handleCustomEvent: ${f}`),l.raiseError)throw f}},l.awaitHandlers)))}addHandler(e,t=!0){this.handlers.push(e),t&&this.inheritableHandlers.push(e)}removeHandler(e){this.handlers=this.handlers.filter(t=>t!==e),this.inheritableHandlers=this.inheritableHandlers.filter(t=>t!==e)}setHandlers(e,t=!0){this.handlers=[],this.inheritableHandlers=[];for(const r of e)this.addHandler(r,t)}addTags(e,t=!0){this.removeTags(e),this.tags.push(...e),t&&this.inheritableTags.push(...e)}removeTags(e){this.tags=this.tags.filter(t=>!e.includes(t)),this.inheritableTags=this.inheritableTags.filter(t=>!e.includes(t))}addMetadata(e,t=!0){this.metadata={...this.metadata,...e},t&&(this.inheritableMetadata={...this.inheritableMetadata,...e})}removeMetadata(e){for(const t of Object.keys(e))delete this.metadata[t],delete this.inheritableMetadata[t]}copy(e=[],t=!0){const r=new tn(this._parentRunId);for(const a of this.handlers){const o=this.inheritableHandlers.includes(a);r.addHandler(a,o)}for(const a of this.tags){const o=this.inheritableTags.includes(a);r.addTags([a],o)}for(const a of Object.keys(this.metadata)){const o=Object.keys(this.inheritableMetadata).includes(a);r.addMetadata({[a]:this.metadata[a]},o)}for(const a of e)r.handlers.filter(o=>o.name==="console_callback_handler").some(o=>o.name===a.name)||r.addHandler(a,t);return r}static fromHandlers(e){class t extends Es{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:Tt()}),Object.assign(this,e)}}const r=new this;return r.addHandler(new t),r}static configure(e,t,r,a,o,l,c){return this._configureSync(e,t,r,a,o,l,c)}static _configureSync(e,t,r,a,o,l,c){var y;let f;(e||t)&&(Array.isArray(e)||!e?(f=new tn,f.setHandlers((e==null?void 0:e.map(so))??[],!0)):f=e,f=f.copy(Array.isArray(t)?t.map(so):t==null?void 0:t.handlers,!1));const h=ti("LANGCHAIN_VERBOSE")==="true"||(c==null?void 0:c.verbose),m=((y=ls.getTraceableRunTree())==null?void 0:y.tracingEnabled)||CS(),_=m||(ti("LANGCHAIN_TRACING")??!1);if(h||_){if(f||(f=new tn),h&&!f.handlers.some(w=>w.name===Lg.prototype.name)){const w=new Lg;f.addHandler(w,!0)}if(_&&!f.handlers.some(w=>w.name==="langchain_tracer")&&m){const w=new ls;f.addHandler(w,!0)}if(m){const w=ls.getTraceableRunTree();if(w&&f._parentRunId===void 0){f._parentRunId=w.id;const b=f.handlers.find(E=>E.name==="langchain_tracer");b==null||b.updateFromRunTree(w)}}}for(const{contextVar:w,inheritable:b=!0,handlerClass:E,envVar:S}of AS()){const O=S&&ti(S)==="true"&&E;let R;const T=w!==void 0?Cy(w):void 0;T&&pS(T)?R=T:O&&(R=new E({})),R!==void 0&&(f||(f=new tn),f.handlers.some($=>$.name===R.name)||f.addHandler(R,b))}return(r||a)&&f&&(f.addTags(r??[]),f.addTags(a??[],!1)),(o||l)&&f&&(f.addMetadata(o??{}),f.addMetadata(l??{},!1)),f}}function so(s){return"name"in s?s:Es.fromMethods(s)}class DS{getStore(){}run(e,t){return t()}enterWith(e){}}const MS=new DS,Dg=Symbol.for("lc:child_config");class US{getInstance(){return _s()??MS}getRunnableConfig(){var t,r;return(r=(t=this.getInstance().getStore())==null?void 0:t.extra)==null?void 0:r[Dg]}runWithConfig(e,t,r){var m;const a=tn._configureSync(e==null?void 0:e.callbacks,void 0,e==null?void 0:e.tags,void 0,e==null?void 0:e.metadata),o=this.getInstance(),l=o.getStore(),c=a==null?void 0:a.getParentRunId(),f=(m=a==null?void 0:a.handlers)==null?void 0:m.find(_=>(_==null?void 0:_.name)==="langchain_tracer");let h;return f&&c?h=f.getRunTreeWithTracingConfig(c):r||(h=new kt({name:"<runnable_lambda>",tracingEnabled:!1})),h&&(h.extra={...h.extra,[Dg]:e}),l!==void 0&&l[Wa]!==void 0&&(h===void 0&&(h={}),h[Wa]=l[Wa]),o.run(h,t)}initializeGlobalInstance(e){_s()===void 0&&xS(e)}}const rr=new US,Ac=25;async function nn(s){return tn._configureSync(s==null?void 0:s.callbacks,void 0,s==null?void 0:s.tags,void 0,s==null?void 0:s.metadata)}function Mg(...s){const e={};for(const t of s.filter(r=>!!r))for(const r of Object.keys(t))if(r==="metadata")e[r]={...e[r],...t[r]};else if(r==="tags"){const a=e[r]??[];e[r]=[...new Set(a.concat(t[r]??[]))]}else if(r==="configurable")e[r]={...e[r],...t[r]};else if(r==="timeout")e.timeout===void 0?e.timeout=t.timeout:t.timeout!==void 0&&(e.timeout=Math.min(e.timeout,t.timeout));else if(r==="signal")e.signal===void 0?e.signal=t.signal:t.signal!==void 0&&("any"in AbortSignal?e.signal=AbortSignal.any([e.signal,t.signal]):e.signal=t.signal);else if(r==="callbacks"){const a=e.callbacks,o=t.callbacks;if(Array.isArray(o))if(!a)e.callbacks=o;else if(Array.isArray(a))e.callbacks=a.concat(o);else{const l=a.copy();for(const c of o)l.addHandler(so(c),!0);e.callbacks=l}else if(o)if(!a)e.callbacks=o;else if(Array.isArray(a)){const l=o.copy();for(const c of a)l.addHandler(so(c),!0);e.callbacks=l}else e.callbacks=new tn(o._parentRunId,{handlers:a.handlers.concat(o.handlers),inheritableHandlers:a.inheritableHandlers.concat(o.inheritableHandlers),tags:Array.from(new Set(a.tags.concat(o.tags))),inheritableTags:Array.from(new Set(a.inheritableTags.concat(o.inheritableTags))),metadata:{...a.metadata,...o.metadata}})}else{const a=r;e[a]=t[a]??e[a]}return e}const zS=new Set(["string","number","boolean"]);function Ne(s){var r;const e=rr.getRunnableConfig();let t={tags:[],metadata:{},recursionLimit:25,runId:void 0};if(e){const{runId:a,runName:o,...l}=e;t=Object.entries(l).reduce((c,[f,h])=>(h!==void 0&&(c[f]=h),c),t)}if(s&&(t=Object.entries(s).reduce((a,[o,l])=>(l!==void 0&&(a[o]=l),a),t)),t!=null&&t.configurable)for(const a of Object.keys(t.configurable))zS.has(typeof t.configurable[a])&&!((r=t.metadata)!=null&&r[a])&&(t.metadata||(t.metadata={}),t.metadata[a]=t.configurable[a]);if(t.timeout!==void 0){if(t.timeout<=0)throw new Error("Timeout must be a positive number");const a=AbortSignal.timeout(t.timeout);t.signal!==void 0?"any"in AbortSignal&&(t.signal=AbortSignal.any([t.signal,a])):t.signal=a,delete t.timeout}return t}function dt(s={},{callbacks:e,maxConcurrency:t,recursionLimit:r,runName:a,configurable:o,runId:l}={}){const c=Ne(s);return e!==void 0&&(delete c.runName,c.callbacks=e),r!==void 0&&(c.recursionLimit=r),t!==void 0&&(c.maxConcurrency=t),a!==void 0&&(c.runName=a),o!==void 0&&(c.configurable={...c.configurable,...o}),l!==void 0&&delete c.runId,c}function ui(s){return s?{configurable:s.configurable,recursionLimit:s.recursionLimit,callbacks:s.callbacks,tags:s.tags,metadata:s.metadata,maxConcurrency:s.maxConcurrency,timeout:s.timeout,signal:s.signal}:void 0}async function ir(s,e){if(e===void 0)return s;let t;return Promise.race([s.catch(r=>{if(!(e!=null&&e.aborted))throw r}),new Promise((r,a)=>{t=()=>{a(new Error("Aborted"))},e.addEventListener("abort",t),e.aborted&&a(new Error("Aborted"))})]).finally(()=>e.removeEventListener("abort",t))}class jt extends ReadableStream{constructor(){super(...arguments),Object.defineProperty(this,"reader",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}ensureReader(){this.reader||(this.reader=this.getReader())}async next(){this.ensureReader();try{const e=await this.reader.read();return e.done?(this.reader.releaseLock(),{done:!0,value:void 0}):{done:!1,value:e.value}}catch(e){throw this.reader.releaseLock(),e}}async return(){if(this.ensureReader(),this.locked){const e=this.reader.cancel();this.reader.releaseLock(),await e}return{done:!0,value:void 0}}async throw(e){if(this.ensureReader(),this.locked){const t=this.reader.cancel();this.reader.releaseLock(),await t}throw e}[Symbol.asyncIterator](){return this}async[Symbol.asyncDispose](){await this.return()}static fromReadableStream(e){const t=e.getReader();return new jt({start(r){return a();function a(){return t.read().then(({done:o,value:l})=>{if(o){r.close();return}return r.enqueue(l),a()})}},cancel(){t.releaseLock()}})}static fromAsyncGenerator(e){return new jt({async pull(t){const{value:r,done:a}=await e.next();a&&t.close(),t.enqueue(r)},async cancel(t){await e.return(t)}})}}function Ny(s,e=2){const t=Array.from({length:e},()=>[]);return t.map(async function*(a){for(;;)if(a.length===0){const o=await s.next();for(const l of t)l.push(o)}else{if(a[0].done)return;yield a.shift().value}})}function Ay(s,e){if(Array.isArray(s)&&Array.isArray(e))return s.concat(e);if(typeof s=="string"&&typeof e=="string")return s+e;if(typeof s=="number"&&typeof e=="number")return s+e;if("concat"in s&&typeof s.concat=="function")return s.concat(e);if(typeof s=="object"&&typeof e=="object"){const t={...s};for(const[r,a]of Object.entries(e))r in t&&!Array.isArray(t[r])?t[r]=Ay(t[r],a):t[r]=a;return t}else throw new Error(`Cannot concat ${typeof s} and ${typeof e}`)}class ci{constructor(e){var t;Object.defineProperty(this,"generator",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"setup",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"signal",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"firstResult",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"firstResultUsed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.generator=e.generator,this.config=e.config,this.signal=e.signal??((t=this.config)==null?void 0:t.signal),this.setup=new Promise((r,a)=>{rr.runWithConfig(ui(e.config),async()=>{this.firstResult=e.generator.next(),e.startSetup?this.firstResult.then(e.startSetup).then(r,a):this.firstResult.then(o=>r(void 0),a)},!0)})}async next(...e){var t;return(t=this.signal)==null||t.throwIfAborted(),this.firstResultUsed?rr.runWithConfig(ui(this.config),this.signal?async()=>ir(this.generator.next(...e),this.signal):async()=>this.generator.next(...e),!0):(this.firstResultUsed=!0,this.firstResult)}async return(e){return this.generator.return(e)}async throw(e){return this.generator.throw(e)}[Symbol.asyncIterator](){return this}async[Symbol.asyncDispose](){await this.return()}}async function FS(s,e,t,r,...a){const o=new ci({generator:e,startSetup:t,signal:r}),l=await o.setup;return{output:s(o,l,...a),setup:l}}class Kn{constructor(e){Object.defineProperty(this,"ops",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.ops=e.ops??[]}concat(e){const t=this.ops.concat(e.ops),r=eo({},t);return new vs({ops:t,state:r[r.length-1].newDocument})}}class vs extends Kn{constructor(e){super(e),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.state=e.state}concat(e){const t=this.ops.concat(e.ops),r=eo(this.state,e.ops);return new vs({ops:t,state:r[r.length-1].newDocument})}static fromRunLogPatch(e){const t=eo({},e.ops);return new vs({ops:e.ops,state:t[t.length-1].newDocument})}}const BS=s=>s.name==="log_stream_tracer";async function Ug(s,e){if(e==="original")throw new Error("Do not assign inputs with original schema drop the key for now. When inputs are added to streamLog they should be added with standardized schema for streaming events.");const{inputs:t}=s;if(["retriever","llm","prompt"].includes(s.run_type))return t;if(!(Object.keys(t).length===1&&(t==null?void 0:t.input)===""))return t.input}async function zg(s,e){const{outputs:t}=s;return e==="original"||["retriever","llm","prompt"].includes(s.run_type)?t:t!==void 0&&Object.keys(t).length===1&&(t==null?void 0:t.output)!==void 0?t.output:t}function HS(s){return s!==void 0&&s.message!==void 0}class Fg extends Ss{constructor(e){super({_awaitHandler:!0,...e}),Object.defineProperty(this,"autoClose",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_schemaFormat",{enumerable:!0,configurable:!0,writable:!0,value:"original"}),Object.defineProperty(this,"rootId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"keyMapByRunId",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"counterMapByRunName",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"transformStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"writer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"receiveStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"log_stream_tracer"}),Object.defineProperty(this,"lc_prefer_streaming",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.autoClose=(e==null?void 0:e.autoClose)??!0,this.includeNames=e==null?void 0:e.includeNames,this.includeTypes=e==null?void 0:e.includeTypes,this.includeTags=e==null?void 0:e.includeTags,this.excludeNames=e==null?void 0:e.excludeNames,this.excludeTypes=e==null?void 0:e.excludeTypes,this.excludeTags=e==null?void 0:e.excludeTags,this._schemaFormat=(e==null?void 0:e._schemaFormat)??this._schemaFormat,this.transformStream=new TransformStream,this.writer=this.transformStream.writable.getWriter(),this.receiveStream=jt.fromReadableStream(this.transformStream.readable)}[Symbol.asyncIterator](){return this.receiveStream}async persistRun(e){}_includeRun(e){if(e.id===this.rootId)return!1;const t=e.tags??[];let r=this.includeNames===void 0&&this.includeTags===void 0&&this.includeTypes===void 0;return this.includeNames!==void 0&&(r=r||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(r=r||this.includeTypes.includes(e.run_type)),this.includeTags!==void 0&&(r=r||t.find(a=>{var o;return(o=this.includeTags)==null?void 0:o.includes(a)})!==void 0),this.excludeNames!==void 0&&(r=r&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(r=r&&!this.excludeTypes.includes(e.run_type)),this.excludeTags!==void 0&&(r=r&&t.every(a=>{var o;return!((o=this.excludeTags)!=null&&o.includes(a))})),r}async*tapOutputIterable(e,t){for await(const r of t){if(e!==this.rootId){const a=this.keyMapByRunId[e];a&&await this.writer.write(new Kn({ops:[{op:"add",path:`/logs/${a}/streamed_output/-`,value:r}]}))}yield r}}async onRunCreate(e){var a;if(this.rootId===void 0&&(this.rootId=e.id,await this.writer.write(new Kn({ops:[{op:"replace",path:"",value:{id:e.id,name:e.name,type:e.run_type,streamed_output:[],final_output:void 0,logs:{}}}]}))),!this._includeRun(e))return;this.counterMapByRunName[e.name]===void 0&&(this.counterMapByRunName[e.name]=0),this.counterMapByRunName[e.name]+=1;const t=this.counterMapByRunName[e.name];this.keyMapByRunId[e.id]=t===1?e.name:`${e.name}:${t}`;const r={id:e.id,name:e.name,type:e.run_type,tags:e.tags??[],metadata:((a=e.extra)==null?void 0:a.metadata)??{},start_time:new Date(e.start_time).toISOString(),streamed_output:[],streamed_output_str:[],final_output:void 0,end_time:void 0};this._schemaFormat==="streaming_events"&&(r.inputs=await Ug(e,this._schemaFormat)),await this.writer.write(new Kn({ops:[{op:"add",path:`/logs/${this.keyMapByRunId[e.id]}`,value:r}]}))}async onRunUpdate(e){try{const t=this.keyMapByRunId[e.id];if(t===void 0)return;const r=[];this._schemaFormat==="streaming_events"&&r.push({op:"replace",path:`/logs/${t}/inputs`,value:await Ug(e,this._schemaFormat)}),r.push({op:"add",path:`/logs/${t}/final_output`,value:await zg(e,this._schemaFormat)}),e.end_time!==void 0&&r.push({op:"add",path:`/logs/${t}/end_time`,value:new Date(e.end_time).toISOString()});const a=new Kn({ops:r});await this.writer.write(a)}finally{if(e.id===this.rootId){const t=new Kn({ops:[{op:"replace",path:"/final_output",value:await zg(e,this._schemaFormat)}]});await this.writer.write(t),this.autoClose&&await this.writer.close()}}}async onLLMNewToken(e,t,r){const a=this.keyMapByRunId[e.id];if(a===void 0)return;const o=e.inputs.messages!==void 0;let l;o?HS(r==null?void 0:r.chunk)?l=r==null?void 0:r.chunk:l=new vo({id:`run-${e.id}`,content:t}):l=t;const c=new Kn({ops:[{op:"add",path:`/logs/${a}/streamed_output_str/-`,value:t},{op:"add",path:`/logs/${a}/streamed_output/-`,value:l}]});await this.writer.write(c)}}class ao{constructor(e){Object.defineProperty(this,"text",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"generationInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.text=e.text,this.generationInfo=e.generationInfo}concat(e){return new ao({text:this.text+e.text,generationInfo:{...this.generationInfo,...e.generationInfo}})}}function Ga({name:s,serialized:e}){return s!==void 0?s:(e==null?void 0:e.name)!==void 0?e.name:(e==null?void 0:e.id)!==void 0&&Array.isArray(e==null?void 0:e.id)?e.id[e.id.length-1]:"Unnamed"}const GS=s=>s.name==="event_stream_tracer";class qS extends Ss{constructor(e){super({_awaitHandler:!0,...e}),Object.defineProperty(this,"autoClose",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"runInfoMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"tappedPromises",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"transformStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"writer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"receiveStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"event_stream_tracer"}),Object.defineProperty(this,"lc_prefer_streaming",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.autoClose=(e==null?void 0:e.autoClose)??!0,this.includeNames=e==null?void 0:e.includeNames,this.includeTypes=e==null?void 0:e.includeTypes,this.includeTags=e==null?void 0:e.includeTags,this.excludeNames=e==null?void 0:e.excludeNames,this.excludeTypes=e==null?void 0:e.excludeTypes,this.excludeTags=e==null?void 0:e.excludeTags,this.transformStream=new TransformStream,this.writer=this.transformStream.writable.getWriter(),this.receiveStream=jt.fromReadableStream(this.transformStream.readable)}[Symbol.asyncIterator](){return this.receiveStream}async persistRun(e){}_includeRun(e){const t=e.tags??[];let r=this.includeNames===void 0&&this.includeTags===void 0&&this.includeTypes===void 0;return this.includeNames!==void 0&&(r=r||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(r=r||this.includeTypes.includes(e.runType)),this.includeTags!==void 0&&(r=r||t.find(a=>{var o;return(o=this.includeTags)==null?void 0:o.includes(a)})!==void 0),this.excludeNames!==void 0&&(r=r&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(r=r&&!this.excludeTypes.includes(e.runType)),this.excludeTags!==void 0&&(r=r&&t.every(a=>{var o;return!((o=this.excludeTags)!=null&&o.includes(a))})),r}async*tapOutputIterable(e,t){const r=await t.next();if(r.done)return;const a=this.runInfoMap.get(e);if(a===void 0){yield r.value;return}function o(c,f){return c==="llm"&&typeof f=="string"?new ao({text:f}):f}let l=this.tappedPromises.get(e);if(l===void 0){let c;l=new Promise(f=>{c=f}),this.tappedPromises.set(e,l);try{const f={event:`on_${a.runType}_stream`,run_id:e,name:a.name,tags:a.tags,metadata:a.metadata,data:{}};await this.send({...f,data:{chunk:o(a.runType,r.value)}},a),yield r.value;for await(const h of t)a.runType!=="tool"&&a.runType!=="retriever"&&await this.send({...f,data:{chunk:o(a.runType,h)}},a),yield h}finally{c()}}else{yield r.value;for await(const c of t)yield c}}async send(e,t){this._includeRun(t)&&await this.writer.write(e)}async sendEndEvent(e,t){const r=this.tappedPromises.get(e.run_id);r!==void 0?r.then(()=>{this.send(e,t)}):await this.send(e,t)}async onLLMStart(e){var l,c;const t=Ga(e),r=e.inputs.messages!==void 0?"chat_model":"llm",a={tags:e.tags??[],metadata:((l=e.extra)==null?void 0:l.metadata)??{},name:t,runType:r,inputs:e.inputs};this.runInfoMap.set(e.id,a);const o=`on_${r}_start`;await this.send({event:o,data:{input:e.inputs},name:t,tags:e.tags??[],run_id:e.id,metadata:((c=e.extra)==null?void 0:c.metadata)??{}},a)}async onLLMNewToken(e,t,r){const a=this.runInfoMap.get(e.id);let o,l;if(a===void 0)throw new Error(`onLLMNewToken: Run ID ${e.id} not found in run map.`);if(this.runInfoMap.size!==1){if(a.runType==="chat_model")l="on_chat_model_stream",(r==null?void 0:r.chunk)===void 0?o=new vo({content:t,id:`run-${e.id}`}):o=r.chunk.message;else if(a.runType==="llm")l="on_llm_stream",(r==null?void 0:r.chunk)===void 0?o=new ao({text:t}):o=r.chunk;else throw new Error(`Unexpected run type ${a.runType}`);await this.send({event:l,data:{chunk:o},run_id:e.id,name:a.name,tags:a.tags,metadata:a.metadata},a)}}async onLLMEnd(e){var l,c,f;const t=this.runInfoMap.get(e.id);this.runInfoMap.delete(e.id);let r;if(t===void 0)throw new Error(`onLLMEnd: Run ID ${e.id} not found in run map.`);const a=(l=e.outputs)==null?void 0:l.generations;let o;if(t.runType==="chat_model"){for(const h of a??[]){if(o!==void 0)break;o=(c=h[0])==null?void 0:c.message}r="on_chat_model_end"}else if(t.runType==="llm")o={generations:a==null?void 0:a.map(h=>h.map(m=>({text:m.text,generationInfo:m.generationInfo}))),llmOutput:((f=e.outputs)==null?void 0:f.llmOutput)??{}},r="on_llm_end";else throw new Error(`onLLMEnd: Unexpected run type: ${t.runType}`);await this.sendEndEvent({event:r,data:{output:o,input:t.inputs},run_id:e.id,name:t.name,tags:t.tags,metadata:t.metadata},t)}async onChainStart(e){var l,c;const t=Ga(e),r=e.run_type??"chain",a={tags:e.tags??[],metadata:((l=e.extra)==null?void 0:l.metadata)??{},name:t,runType:e.run_type};let o={};e.inputs.input===""&&Object.keys(e.inputs).length===1?(o={},a.inputs={}):e.inputs.input!==void 0?(o.input=e.inputs.input,a.inputs=e.inputs.input):(o.input=e.inputs,a.inputs=e.inputs),this.runInfoMap.set(e.id,a),await this.send({event:`on_${r}_start`,data:o,name:t,tags:e.tags??[],run_id:e.id,metadata:((c=e.extra)==null?void 0:c.metadata)??{}},a)}async onChainEnd(e){var c;const t=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),t===void 0)throw new Error(`onChainEnd: Run ID ${e.id} not found in run map.`);const r=`on_${e.run_type}_end`,a=e.inputs??t.inputs??{},l={output:((c=e.outputs)==null?void 0:c.output)??e.outputs,input:a};a.input&&Object.keys(a).length===1&&(l.input=a.input,t.inputs=a.input),await this.sendEndEvent({event:r,data:l,run_id:e.id,name:t.name,tags:t.tags,metadata:t.metadata??{}},t)}async onToolStart(e){var a,o;const t=Ga(e),r={tags:e.tags??[],metadata:((a=e.extra)==null?void 0:a.metadata)??{},name:t,runType:"tool",inputs:e.inputs??{}};this.runInfoMap.set(e.id,r),await this.send({event:"on_tool_start",data:{input:e.inputs??{}},name:t,run_id:e.id,tags:e.tags??[],metadata:((o=e.extra)==null?void 0:o.metadata)??{}},r)}async onToolEnd(e){var a;const t=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),t===void 0)throw new Error(`onToolEnd: Run ID ${e.id} not found in run map.`);if(t.inputs===void 0)throw new Error(`onToolEnd: Run ID ${e.id} is a tool call, and is expected to have traced inputs.`);const r=((a=e.outputs)==null?void 0:a.output)===void 0?e.outputs:e.outputs.output;await this.sendEndEvent({event:"on_tool_end",data:{output:r,input:t.inputs},run_id:e.id,name:t.name,tags:t.tags,metadata:t.metadata},t)}async onRetrieverStart(e){var o,l;const t=Ga(e),a={tags:e.tags??[],metadata:((o=e.extra)==null?void 0:o.metadata)??{},name:t,runType:"retriever",inputs:{query:e.inputs.query}};this.runInfoMap.set(e.id,a),await this.send({event:"on_retriever_start",data:{input:{query:e.inputs.query}},name:t,tags:e.tags??[],run_id:e.id,metadata:((l=e.extra)==null?void 0:l.metadata)??{}},a)}async onRetrieverEnd(e){var r;const t=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),t===void 0)throw new Error(`onRetrieverEnd: Run ID ${e.id} not found in run map.`);await this.sendEndEvent({event:"on_retriever_end",data:{output:((r=e.outputs)==null?void 0:r.documents)??e.outputs,input:t.inputs},run_id:e.id,name:t.name,tags:t.tags,metadata:t.metadata},t)}async handleCustomEvent(e,t,r){const a=this.runInfoMap.get(r);if(a===void 0)throw new Error(`handleCustomEvent: Run ID ${r} not found in run map.`);await this.send({event:"on_custom_event",run_id:r,name:e,tags:a.tags,metadata:a.metadata,data:t},a)}async finish(){const e=[...this.tappedPromises.values()];Promise.all(e).finally(()=>{this.writer.close()})}}const VS=[400,401,402,403,404,405,406,407,409],ZS=s=>{var t,r;if(s.message.startsWith("Cancel")||s.message.startsWith("AbortError")||s.name==="AbortError"||(s==null?void 0:s.code)==="ECONNABORTED")throw s;const e=((t=s==null?void 0:s.response)==null?void 0:t.status)??(s==null?void 0:s.status);if(e&&VS.includes(+e))throw s;if(((r=s==null?void 0:s.error)==null?void 0:r.code)==="insufficient_quota"){const a=new Error(s==null?void 0:s.message);throw a.name="InsufficientQuotaError",a}};class WS{constructor(e){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onFailedAttempt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=e.maxConcurrency??1/0,this.maxRetries=e.maxRetries??6,this.onFailedAttempt=e.onFailedAttempt??ZS;const t="default"in En?En.default:En;this.queue=new t({concurrency:this.maxConcurrency})}call(e,...t){return this.queue.add(()=>Hc(()=>e(...t).catch(r=>{throw r instanceof Error?r:new Error(r)}),{onFailedAttempt:this.onFailedAttempt,retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0})}callWithOptions(e,t,...r){return e.signal?Promise.race([this.call(t,...r),new Promise((a,o)=>{var l;(l=e.signal)==null||l.addEventListener("abort",()=>{o(new Error("AbortError"))})})]):this.call(t,...r)}fetch(...e){return this.call(()=>fetch(...e).then(t=>t.ok?t:Promise.reject(t)))}}class Py extends Ss{constructor({config:e,onStart:t,onEnd:r,onError:a}){super({_awaitHandler:!0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RootListenersTracer"}),Object.defineProperty(this,"rootId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnStart",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnEnd",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnError",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.config=e,this.argOnStart=t,this.argOnEnd=r,this.argOnError=a}persistRun(e){return Promise.resolve()}async onRunCreate(e){this.rootId||(this.rootId=e.id,this.argOnStart&&await this.argOnStart(e,this.config))}async onRunUpdate(e){e.id===this.rootId&&(e.error?this.argOnError&&await this.argOnError(e,this.config):this.argOnEnd&&await this.argOnEnd(e,this.config))}}function gd(s){return s?s.lc_runnable:!1}class KS{constructor(e){Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.includeNames=e.includeNames,this.includeTypes=e.includeTypes,this.includeTags=e.includeTags,this.excludeNames=e.excludeNames,this.excludeTypes=e.excludeTypes,this.excludeTags=e.excludeTags}includeEvent(e,t){let r=this.includeNames===void 0&&this.includeTypes===void 0&&this.includeTags===void 0;const a=e.tags??[];return this.includeNames!==void 0&&(r=r||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(r=r||this.includeTypes.includes(t)),this.includeTags!==void 0&&(r=r||a.some(o=>{var l;return(l=this.includeTags)==null?void 0:l.includes(o)})),this.excludeNames!==void 0&&(r=r&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(r=r&&!this.excludeTypes.includes(t)),this.excludeTags!==void 0&&(r=r&&a.every(o=>{var l;return!((l=this.excludeTags)!=null&&l.includes(o))})),r}}function Pc(s){return s.replace(/[^a-zA-Z-_0-9]/g,"_")}const JS=["*","_","`"];function QS(s){let e="";for(const[t,r]of Object.entries(s))e+=`	classDef ${t} ${r};
`;return e}function YS(s,e,t){const{firstNode:r,lastNode:a,nodeColors:o,withStyles:l=!0,curveStyle:c="linear",wrapLabelNWords:f=9}=t??{};let h=l?`%%{init: {'flowchart': {'curve': '${c}'}}}%%
graph TD;
`:`graph TD;
`;if(l){const w="default",b={[w]:"{0}({1})"};r!==void 0&&(b[r]="{0}([{1}]):::first"),a!==void 0&&(b[a]="{0}([{1}]):::last");for(const[E,S]of Object.entries(s)){const O=S.name.split(":").pop()??"";let T=JS.some(P=>O.startsWith(P)&&O.endsWith(P))?`<p>${O}</p>`:O;Object.keys(S.metadata??{}).length&&(T+=`<hr/><small><em>${Object.entries(S.metadata??{}).map(([P,z])=>`${P} = ${z}`).join(`
`)}</em></small>`);const $=(b[E]??b[w]).replace("{0}",Pc(E)).replace("{1}",T);h+=`	${$}
`}}const m={};for(const w of e){const b=w.source.split(":"),E=w.target.split(":"),S=b.filter((O,R)=>O===E[R]).join(":");m[S]||(m[S]=[]),m[S].push(w)}const _=new Set;function y(w,b){const E=w.length===1&&w[0].source===w[0].target;if(b&&!E){const S=b.split(":").pop();if(_.has(S))throw new Error(`Found duplicate subgraph '${S}' -- this likely means that you're reusing a subgraph node with the same name. Please adjust your graph to have subgraph nodes with unique names.`);_.add(S),h+=`	subgraph ${S}
`}for(const S of w){const{source:O,target:R,data:T,conditional:$}=S;let P="";if(T!==void 0){let z=T;const Q=z.split(" ");Q.length>f&&(z=Array.from({length:Math.ceil(Q.length/f)},(W,Ee)=>Q.slice(Ee*f,(Ee+1)*f).join(" ")).join("&nbsp;<br>&nbsp;")),P=$?` -. &nbsp;${z}&nbsp; .-> `:` -- &nbsp;${z}&nbsp; --> `}else P=$?" -.-> ":" --> ";h+=`	${Pc(O)}${P}${Pc(R)};
`}for(const S in m)S.startsWith(`${b}:`)&&S!==b&&y(m[S],S);b&&!E&&(h+=`	end
`)}y(m[""]??[],"");for(const w in m)!w.includes(":")&&w!==""&&y(m[w],w);return l&&(h+=QS(o??{})),h}async function XS(s,e){return e1(s,{...e,imageType:"png"})}async function e1(s,e){let t=(e==null?void 0:e.backgroundColor)??"white";const r=e==null?void 0:e.imageType,a=btoa(s);t!==void 0&&(/^#(?:[0-9a-fA-F]{3}){1,2}$/.test(t)||(t=`!${t}`));const o=`https://mermaid.ink/img/${a}?bgColor=${t}&type=${r}`,l=await fetch(o);if(!l.ok)throw new Error(["Failed to render the graph using the Mermaid.INK API.",`Status code: ${l.status}`,`Status text: ${l.statusText}`].join(`
`));return await l.blob()}function bo(s,e,t){function r(c,f){var h;Object.defineProperty(c,"_zod",{value:c._zod??{},enumerable:!1}),(h=c._zod).traits??(h.traits=new Set),c._zod.traits.add(s),e(c,f);for(const m in l.prototype)m in c||Object.defineProperty(c,m,{value:l.prototype[m].bind(c)});c._zod.constr=l,c._zod.def=f}const a=(t==null?void 0:t.Parent)??Object;class o extends a{}Object.defineProperty(o,"name",{value:s});function l(c){var f;const h=t!=null&&t.Parent?new o:this;r(h,c),(f=h._zod).deferred??(f.deferred=[]);for(const m of h._zod.deferred)m();return h}return Object.defineProperty(l,"init",{value:r}),Object.defineProperty(l,Symbol.hasInstance,{value:c=>{var f,h;return t!=null&&t.Parent&&c instanceof t.Parent?!0:(h=(f=c==null?void 0:c._zod)==null?void 0:f.traits)==null?void 0:h.has(s)}}),Object.defineProperty(l,"name",{value:s}),l}class oo extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}const t1={};function yd(s){return t1}function n1(s){const e=Object.values(s).filter(r=>typeof r=="number");return Object.entries(s).filter(([r,a])=>e.indexOf(+r)===-1).map(([r,a])=>a)}function r1(s,e){return typeof e=="bigint"?e.toString():e}const i1=Error.captureStackTrace?Error.captureStackTrace:(...s)=>{};function uo(s,e,t){const r=new s._zod.constr(e??s._zod.def);return(!e||t!=null&&t.parent)&&(r._zod.parent=s),r}function s1(s){return{}}function Lc(s,e=0){var t;for(let r=e;r<s.issues.length;r++)if(((t=s.issues[r])==null?void 0:t.continue)!==!0)return!0;return!1}function qa(s){return typeof s=="string"?s:s==null?void 0:s.message}function _d(s,e,t){var a,o,l,c,f,h;const r={...s,path:s.path??[]};if(!s.message){const m=qa((l=(o=(a=s.inst)==null?void 0:a._zod.def)==null?void 0:o.error)==null?void 0:l.call(o,s))??qa((c=e==null?void 0:e.error)==null?void 0:c.call(e,s))??qa((f=t.customError)==null?void 0:f.call(t,s))??qa((h=t.localeError)==null?void 0:h.call(t,s))??"Invalid input";r.message=m}return delete r.inst,delete r.continue,e!=null&&e.reportInput||delete r.input,r}const Ly=(s,e)=>{s.name="$ZodError",Object.defineProperty(s,"_zod",{value:s._zod,enumerable:!1}),Object.defineProperty(s,"issues",{value:e,enumerable:!1}),Object.defineProperty(s,"message",{get(){return JSON.stringify(e,r1,2)},enumerable:!0}),Object.defineProperty(s,"toString",{value:()=>s.message,enumerable:!1})},a1=bo("$ZodError",Ly),vd=bo("$ZodError",Ly,{Parent:Error}),o1=s=>(e,t,r,a)=>{const o=r?Object.assign(r,{async:!1}):{async:!1},l=e._zod.run({value:t,issues:[]},o);if(l instanceof Promise)throw new oo;if(l.issues.length){const c=new((a==null?void 0:a.Err)??s)(l.issues.map(f=>_d(f,o,yd())));throw i1(c,a==null?void 0:a.callee),c}return l.value},u1=o1(vd),l1=s=>(e,t,r)=>{const a=r?{...r,async:!1}:{async:!1},o=e._zod.run({value:t,issues:[]},a);if(o instanceof Promise)throw new oo;return o.issues.length?{success:!1,error:new(s??a1)(o.issues.map(l=>_d(l,a,yd())))}:{success:!0,data:o.value}},c1=l1(vd),d1=s=>async(e,t,r)=>{const a=r?Object.assign(r,{async:!0}):{async:!0};let o=e._zod.run({value:t,issues:[]},a);return o instanceof Promise&&(o=await o),o.issues.length?{success:!1,error:new s(o.issues.map(l=>_d(l,a,yd())))}:{success:!0,data:o.value}},f1=d1(vd),h1={major:4,minor:0,patch:0},p1=bo("$ZodType",(s,e)=>{var a;var t;s??(s={}),s._zod.def=e,s._zod.bag=s._zod.bag||{},s._zod.version=h1;const r=[...s._zod.def.checks??[]];s._zod.traits.has("$ZodCheck")&&r.unshift(s);for(const o of r)for(const l of o._zod.onattach)l(s);if(r.length===0)(t=s._zod).deferred??(t.deferred=[]),(a=s._zod.deferred)==null||a.push(()=>{s._zod.run=s._zod.parse});else{const o=(l,c,f)=>{let h=Lc(l),m;for(const _ of c){if(_._zod.def.when){if(!_._zod.def.when(l))continue}else if(h)continue;const y=l.issues.length,w=_._zod.check(l);if(w instanceof Promise&&(f==null?void 0:f.async)===!1)throw new oo;if(m||w instanceof Promise)m=(m??Promise.resolve()).then(async()=>{await w,l.issues.length!==y&&(h||(h=Lc(l,y)))});else{if(l.issues.length===y)continue;h||(h=Lc(l,y))}}return m?m.then(()=>l):l};s._zod.run=(l,c)=>{const f=s._zod.parse(l,c);if(f instanceof Promise){if(c.async===!1)throw new oo;return f.then(h=>o(h,r,c))}return o(f,r,c)}}s["~standard"]={validate:o=>{var l;try{const c=c1(s,o);return c.success?{value:c.data}:{issues:(l=c.error)==null?void 0:l.issues}}catch{return f1(s,o).then(f=>{var h;return f.success?{value:f.data}:{issues:(h=f.error)==null?void 0:h.issues}})}},vendor:"zod",version:1}}),m1=bo("$ZodNever",(s,e)=>{p1.init(s,e),s._zod.parse=(t,r)=>(t.issues.push({expected:"never",code:"invalid_type",input:t.value,inst:s}),t)});class jy{constructor(){this._map=new Map,this._idmap=new Map}add(e,...t){const r=t[0];if(this._map.set(e,r),r&&typeof r=="object"&&"id"in r){if(this._idmap.has(r.id))throw new Error(`ID ${r.id} already exists in the registry`);this._idmap.set(r.id,e)}return this}clear(){return this._map=new Map,this._idmap=new Map,this}remove(e){const t=this._map.get(e);return t&&typeof t=="object"&&"id"in t&&this._idmap.delete(t.id),this._map.delete(e),this}get(e){const t=e._zod.parent;if(t){const r={...this.get(t)??{}};return delete r.id,{...r,...this._map.get(e)}}return this._map.get(e)}has(e){return this._map.has(e)}}function g1(){return new jy}const Qn=g1();function y1(s,e){return new s({type:"never",...s1()})}class Bg{constructor(e){this.counter=0,this.metadataRegistry=(e==null?void 0:e.metadata)??Qn,this.target=(e==null?void 0:e.target)??"draft-2020-12",this.unrepresentable=(e==null?void 0:e.unrepresentable)??"throw",this.override=(e==null?void 0:e.override)??(()=>{}),this.io=(e==null?void 0:e.io)??"output",this.seen=new Map}process(e,t={path:[],schemaPath:[]}){var _,y,w;var r;const a=e._zod.def,o={guid:"uuid",url:"uri",datetime:"date-time",json_string:"json-string",regex:""},l=this.seen.get(e);if(l)return l.count++,t.schemaPath.includes(e)&&(l.cycle=t.path),l.schema;const c={schema:{},count:1,cycle:void 0,path:t.path};this.seen.set(e,c);const f=(y=(_=e._zod).toJSONSchema)==null?void 0:y.call(_);if(f)c.schema=f;else{const b={...t,schemaPath:[...t.schemaPath,e],path:t.path},E=e._zod.parent;if(E)c.ref=E,this.process(E,b),this.seen.get(E).isParent=!0;else{const S=c.schema;switch(a.type){case"string":{const O=S;O.type="string";const{minimum:R,maximum:T,format:$,patterns:P,contentEncoding:z}=e._zod.bag;if(typeof R=="number"&&(O.minLength=R),typeof T=="number"&&(O.maxLength=T),$&&(O.format=o[$]??$,O.format===""&&delete O.format),z&&(O.contentEncoding=z),P&&P.size>0){const Q=[...P];Q.length===1?O.pattern=Q[0].source:Q.length>1&&(c.schema.allOf=[...Q.map(W=>({...this.target==="draft-7"?{type:"string"}:{},pattern:W.source}))])}break}case"number":{const O=S,{minimum:R,maximum:T,format:$,multipleOf:P,exclusiveMaximum:z,exclusiveMinimum:Q}=e._zod.bag;typeof $=="string"&&$.includes("int")?O.type="integer":O.type="number",typeof Q=="number"&&(O.exclusiveMinimum=Q),typeof R=="number"&&(O.minimum=R,typeof Q=="number"&&(Q>=R?delete O.minimum:delete O.exclusiveMinimum)),typeof z=="number"&&(O.exclusiveMaximum=z),typeof T=="number"&&(O.maximum=T,typeof z=="number"&&(z<=T?delete O.maximum:delete O.exclusiveMaximum)),typeof P=="number"&&(O.multipleOf=P);break}case"boolean":{const O=S;O.type="boolean";break}case"bigint":{if(this.unrepresentable==="throw")throw new Error("BigInt cannot be represented in JSON Schema");break}case"symbol":{if(this.unrepresentable==="throw")throw new Error("Symbols cannot be represented in JSON Schema");break}case"null":{S.type="null";break}case"any":break;case"unknown":break;case"undefined":{if(this.unrepresentable==="throw")throw new Error("Undefined cannot be represented in JSON Schema");break}case"void":{if(this.unrepresentable==="throw")throw new Error("Void cannot be represented in JSON Schema");break}case"never":{S.not={};break}case"date":{if(this.unrepresentable==="throw")throw new Error("Date cannot be represented in JSON Schema");break}case"array":{const O=S,{minimum:R,maximum:T}=e._zod.bag;typeof R=="number"&&(O.minItems=R),typeof T=="number"&&(O.maxItems=T),O.type="array",O.items=this.process(a.element,{...b,path:[...b.path,"items"]});break}case"object":{const O=S;O.type="object",O.properties={};const R=a.shape;for(const P in R)O.properties[P]=this.process(R[P],{...b,path:[...b.path,"properties",P]});const T=new Set(Object.keys(R)),$=new Set([...T].filter(P=>{const z=a.shape[P]._zod;return this.io==="input"?z.optin===void 0:z.optout===void 0}));$.size>0&&(O.required=Array.from($)),((w=a.catchall)==null?void 0:w._zod.def.type)==="never"?O.additionalProperties=!1:a.catchall?a.catchall&&(O.additionalProperties=this.process(a.catchall,{...b,path:[...b.path,"additionalProperties"]})):this.io==="output"&&(O.additionalProperties=!1);break}case"union":{const O=S;O.anyOf=a.options.map((R,T)=>this.process(R,{...b,path:[...b.path,"anyOf",T]}));break}case"intersection":{const O=S,R=this.process(a.left,{...b,path:[...b.path,"allOf",0]}),T=this.process(a.right,{...b,path:[...b.path,"allOf",1]}),$=z=>"allOf"in z&&Object.keys(z).length===1,P=[...$(R)?R.allOf:[R],...$(T)?T.allOf:[T]];O.allOf=P;break}case"tuple":{const O=S;O.type="array";const R=a.items.map((P,z)=>this.process(P,{...b,path:[...b.path,"prefixItems",z]}));if(this.target==="draft-2020-12"?O.prefixItems=R:O.items=R,a.rest){const P=this.process(a.rest,{...b,path:[...b.path,"items"]});this.target==="draft-2020-12"?O.items=P:O.additionalItems=P}a.rest&&(O.items=this.process(a.rest,{...b,path:[...b.path,"items"]}));const{minimum:T,maximum:$}=e._zod.bag;typeof T=="number"&&(O.minItems=T),typeof $=="number"&&(O.maxItems=$);break}case"record":{const O=S;O.type="object",O.propertyNames=this.process(a.keyType,{...b,path:[...b.path,"propertyNames"]}),O.additionalProperties=this.process(a.valueType,{...b,path:[...b.path,"additionalProperties"]});break}case"map":{if(this.unrepresentable==="throw")throw new Error("Map cannot be represented in JSON Schema");break}case"set":{if(this.unrepresentable==="throw")throw new Error("Set cannot be represented in JSON Schema");break}case"enum":{const O=S,R=n1(a.entries);R.every(T=>typeof T=="number")&&(O.type="number"),R.every(T=>typeof T=="string")&&(O.type="string"),O.enum=R;break}case"literal":{const O=S,R=[];for(const T of a.values)if(T===void 0){if(this.unrepresentable==="throw")throw new Error("Literal `undefined` cannot be represented in JSON Schema")}else if(typeof T=="bigint"){if(this.unrepresentable==="throw")throw new Error("BigInt literals cannot be represented in JSON Schema");R.push(Number(T))}else R.push(T);if(R.length!==0)if(R.length===1){const T=R[0];O.type=T===null?"null":typeof T,O.const=T}else R.every(T=>typeof T=="number")&&(O.type="number"),R.every(T=>typeof T=="string")&&(O.type="string"),R.every(T=>typeof T=="boolean")&&(O.type="string"),R.every(T=>T===null)&&(O.type="null"),O.enum=R;break}case"file":{const O=S,R={type:"string",format:"binary",contentEncoding:"binary"},{minimum:T,maximum:$,mime:P}=e._zod.bag;T!==void 0&&(R.minLength=T),$!==void 0&&(R.maxLength=$),P?P.length===1?(R.contentMediaType=P[0],Object.assign(O,R)):O.anyOf=P.map(z=>({...R,contentMediaType:z})):Object.assign(O,R);break}case"transform":{if(this.unrepresentable==="throw")throw new Error("Transforms cannot be represented in JSON Schema");break}case"nullable":{const O=this.process(a.innerType,b);S.anyOf=[O,{type:"null"}];break}case"nonoptional":{this.process(a.innerType,b),c.ref=a.innerType;break}case"success":{const O=S;O.type="boolean";break}case"default":{this.process(a.innerType,b),c.ref=a.innerType,S.default=JSON.parse(JSON.stringify(a.defaultValue));break}case"prefault":{this.process(a.innerType,b),c.ref=a.innerType,this.io==="input"&&(S._prefault=JSON.parse(JSON.stringify(a.defaultValue)));break}case"catch":{this.process(a.innerType,b),c.ref=a.innerType;let O;try{O=a.catchValue(void 0)}catch{throw new Error("Dynamic catch values are not supported in JSON Schema")}S.default=O;break}case"nan":{if(this.unrepresentable==="throw")throw new Error("NaN cannot be represented in JSON Schema");break}case"template_literal":{const O=S,R=e._zod.pattern;if(!R)throw new Error("Pattern not found in template literal");O.type="string",O.pattern=R.source;break}case"pipe":{const O=this.io==="input"?a.in._zod.def.type==="transform"?a.out:a.in:a.out;this.process(O,b),c.ref=O;break}case"readonly":{this.process(a.innerType,b),c.ref=a.innerType,S.readOnly=!0;break}case"promise":{this.process(a.innerType,b),c.ref=a.innerType;break}case"optional":{this.process(a.innerType,b),c.ref=a.innerType;break}case"lazy":{const O=e._zod.innerType;this.process(O,b),c.ref=O;break}case"custom":{if(this.unrepresentable==="throw")throw new Error("Custom types cannot be represented in JSON Schema");break}}}}const h=this.metadataRegistry.get(e);return h&&Object.assign(c.schema,h),this.io==="input"&&Je(e)&&(delete c.schema.examples,delete c.schema.default),this.io==="input"&&c.schema._prefault&&((r=c.schema).default??(r.default=c.schema._prefault)),delete c.schema._prefault,this.seen.get(e).schema}emit(e,t){var m,_,y,w,b,E;const r={cycles:(t==null?void 0:t.cycles)??"ref",reused:(t==null?void 0:t.reused)??"inline",external:(t==null?void 0:t.external)??void 0},a=this.seen.get(e);if(!a)throw new Error("Unprocessed schema. This is a bug in Zod.");const o=S=>{var P;const O=this.target==="draft-2020-12"?"$defs":"definitions";if(r.external){const z=(P=r.external.registry.get(S[0]))==null?void 0:P.id,Q=r.external.uri??(Ee=>Ee);if(z)return{ref:Q(z)};const W=S[1].defId??S[1].schema.id??`schema${this.counter++}`;return S[1].defId=W,{defId:W,ref:`${Q("__shared")}#/${O}/${W}`}}if(S[1]===a)return{ref:"#"};const T=`#/${O}/`,$=S[1].schema.id??`__schema${this.counter++}`;return{defId:$,ref:T+$}},l=S=>{if(S[1].schema.$ref)return;const O=S[1],{ref:R,defId:T}=o(S);O.def={...O.schema},T&&(O.defId=T);const $=O.schema;for(const P in $)delete $[P];$.$ref=R};if(r.cycles==="throw")for(const S of this.seen.entries()){const O=S[1];if(O.cycle)throw new Error(`Cycle detected: #/${(m=O.cycle)==null?void 0:m.join("/")}/<root>

Set the \`cycles\` parameter to \`"ref"\` to resolve cyclical schemas with defs.`)}for(const S of this.seen.entries()){const O=S[1];if(e===S[0]){l(S);continue}if(r.external){const T=(_=r.external.registry.get(S[0]))==null?void 0:_.id;if(e!==S[0]&&T){l(S);continue}}if((y=this.metadataRegistry.get(S[0]))==null?void 0:y.id){l(S);continue}if(O.cycle){l(S);continue}if(O.count>1&&r.reused==="ref"){l(S);continue}}const c=(S,O)=>{const R=this.seen.get(S),T=R.def??R.schema,$={...T};if(R.ref===null)return;const P=R.ref;if(R.ref=null,P){c(P,O);const z=this.seen.get(P).schema;z.$ref&&O.target==="draft-7"?(T.allOf=T.allOf??[],T.allOf.push(z)):(Object.assign(T,z),Object.assign(T,$))}R.isParent||this.override({zodSchema:S,jsonSchema:T,path:R.path??[]})};for(const S of[...this.seen.entries()].reverse())c(S[0],{target:this.target});const f={};if(this.target==="draft-2020-12"?f.$schema="https://json-schema.org/draft/2020-12/schema":this.target==="draft-7"?f.$schema="http://json-schema.org/draft-07/schema#":console.warn(`Invalid target: ${this.target}`),(w=r.external)!=null&&w.uri){const S=(b=r.external.registry.get(e))==null?void 0:b.id;if(!S)throw new Error("Schema is missing an `id` property");f.$id=r.external.uri(S)}Object.assign(f,a.def);const h=((E=r.external)==null?void 0:E.defs)??{};for(const S of this.seen.entries()){const O=S[1];O.def&&O.defId&&(h[O.defId]=O.def)}r.external||Object.keys(h).length>0&&(this.target==="draft-2020-12"?f.$defs=h:f.definitions=h);try{return JSON.parse(JSON.stringify(f))}catch{throw new Error("Error converting schema to JSON.")}}}function Hg(s,e){if(s instanceof jy){const r=new Bg(e),a={};for(const c of s._idmap.entries()){const[f,h]=c;r.process(h)}const o={},l={registry:s,uri:e==null?void 0:e.uri,defs:a};for(const c of s._idmap.entries()){const[f,h]=c;o[f]=r.emit(h,{...e,external:l})}if(Object.keys(a).length>0){const c=r.target==="draft-2020-12"?"$defs":"definitions";o.__shared={[c]:a}}return{schemas:o}}const t=new Bg(e);return t.process(s),t.emit(s,e)}function Je(s,e){const t=e??{seen:new Set};if(t.seen.has(s))return!1;t.seen.add(s);const a=s._zod.def;switch(a.type){case"string":case"number":case"bigint":case"boolean":case"date":case"symbol":case"undefined":case"null":case"any":case"unknown":case"never":case"void":case"literal":case"enum":case"nan":case"file":case"template_literal":return!1;case"array":return Je(a.element,t);case"object":{for(const o in a.shape)if(Je(a.shape[o],t))return!0;return!1}case"union":{for(const o of a.options)if(Je(o,t))return!0;return!1}case"intersection":return Je(a.left,t)||Je(a.right,t);case"tuple":{for(const o of a.items)if(Je(o,t))return!0;return!!(a.rest&&Je(a.rest,t))}case"record":return Je(a.keyType,t)||Je(a.valueType,t);case"map":return Je(a.keyType,t)||Je(a.valueType,t);case"set":return Je(a.valueType,t);case"promise":case"optional":case"nonoptional":case"nullable":case"readonly":return Je(a.innerType,t);case"lazy":return Je(a.getter(),t);case"default":return Je(a.innerType,t);case"prefault":return Je(a.innerType,t);case"custom":return!1;case"transform":return!0;case"pipe":return Je(a.in,t)||Je(a.out,t);case"success":return!1;case"catch":return!1}throw new Error(`Unknown schema type: ${a.type}`)}const _1=Symbol("Let zodToJsonSchema decide on which parser to use"),v1={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref",openAiAnyTypeName:"OpenAiAnyType"},w1=s=>({...v1,...s}),b1=s=>{const e=w1(s),t=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,flags:{hasReferencedOpenAiAnyType:!1},currentPath:t,propertyPath:void 0,seen:new Map(Object.entries(e.definitions).map(([r,a])=>[a._def,{def:a._def,path:[...e.basePath,e.definitionPath,r],jsonSchema:void 0}]))}};function $y(s,e,t,r){r!=null&&r.errorMessages&&t&&(s.errorMessage={...s.errorMessage,[e]:t})}function Ie(s,e,t,r,a){s[e]=t,$y(s,e,r,a)}const Dy=(s,e)=>{let t=0;for(;t<s.length&&t<e.length&&s[t]===e[t];t++);return[(s.length-t).toString(),...e.slice(t)].join("/")};function $t(s){if(s.target!=="openAi")return{};const e=[...s.basePath,s.definitionPath,s.openAiAnyTypeName];return s.flags.hasReferencedOpenAiAnyType=!0,{$ref:s.$refStrategy==="relative"?Dy(e,s.currentPath):e.join("/")}}function E1(s,e){var r,a,o;const t={type:"array"};return(r=s.type)!=null&&r._def&&((o=(a=s.type)==null?void 0:a._def)==null?void 0:o.typeName)!==Z.ZodAny&&(t.items=xe(s.type._def,{...e,currentPath:[...e.currentPath,"items"]})),s.minLength&&Ie(t,"minItems",s.minLength.value,s.minLength.message,e),s.maxLength&&Ie(t,"maxItems",s.maxLength.value,s.maxLength.message,e),s.exactLength&&(Ie(t,"minItems",s.exactLength.value,s.exactLength.message,e),Ie(t,"maxItems",s.exactLength.value,s.exactLength.message,e)),t}function S1(s,e){const t={type:"integer",format:"int64"};if(!s.checks)return t;for(const r of s.checks)switch(r.kind){case"min":e.target==="jsonSchema7"?r.inclusive?Ie(t,"minimum",r.value,r.message,e):Ie(t,"exclusiveMinimum",r.value,r.message,e):(r.inclusive||(t.exclusiveMinimum=!0),Ie(t,"minimum",r.value,r.message,e));break;case"max":e.target==="jsonSchema7"?r.inclusive?Ie(t,"maximum",r.value,r.message,e):Ie(t,"exclusiveMaximum",r.value,r.message,e):(r.inclusive||(t.exclusiveMaximum=!0),Ie(t,"maximum",r.value,r.message,e));break;case"multipleOf":Ie(t,"multipleOf",r.value,r.message,e);break}return t}function O1(){return{type:"boolean"}}function My(s,e){return xe(s.type._def,e)}const k1=(s,e)=>xe(s.innerType._def,e);function Uy(s,e,t){const r=t??e.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((a,o)=>Uy(s,e,a))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return T1(s,e)}}const T1=(s,e)=>{const t={type:"integer",format:"unix-time"};if(e.target==="openApi3")return t;for(const r of s.checks)switch(r.kind){case"min":Ie(t,"minimum",r.value,r.message,e);break;case"max":Ie(t,"maximum",r.value,r.message,e);break}return t};function x1(s,e){return{...xe(s.innerType._def,e),default:s.defaultValue()}}function R1(s,e){return e.effectStrategy==="input"?xe(s.schema._def,e):$t(e)}function I1(s){return{type:"string",enum:Array.from(s.values)}}const C1=s=>"type"in s&&s.type==="string"?!1:"allOf"in s;function N1(s,e){const t=[xe(s.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),xe(s.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(o=>!!o);let r=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const a=[];return t.forEach(o=>{if(C1(o))a.push(...o.allOf),o.unevaluatedProperties===void 0&&(r=void 0);else{let l=o;if("additionalProperties"in o&&o.additionalProperties===!1){const{additionalProperties:c,...f}=o;l=f}else r=void 0;a.push(l)}}),a.length?{allOf:a,...r}:void 0}function A1(s,e){const t=typeof s.value;return t!=="bigint"&&t!=="number"&&t!=="boolean"&&t!=="string"?{type:Array.isArray(s.value)?"array":"object"}:e.target==="openApi3"?{type:t==="bigint"?"integer":t,enum:[s.value]}:{type:t==="bigint"?"integer":t,const:s.value}}let jc;const Xt={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(jc===void 0&&(jc=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),jc),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function zy(s,e){const t={type:"string"};if(s.checks)for(const r of s.checks)switch(r.kind){case"min":Ie(t,"minLength",typeof t.minLength=="number"?Math.max(t.minLength,r.value):r.value,r.message,e);break;case"max":Ie(t,"maxLength",typeof t.maxLength=="number"?Math.min(t.maxLength,r.value):r.value,r.message,e);break;case"email":switch(e.emailStrategy){case"format:email":en(t,"email",r.message,e);break;case"format:idn-email":en(t,"idn-email",r.message,e);break;case"pattern:zod":mt(t,Xt.email,r.message,e);break}break;case"url":en(t,"uri",r.message,e);break;case"uuid":en(t,"uuid",r.message,e);break;case"regex":mt(t,r.regex,r.message,e);break;case"cuid":mt(t,Xt.cuid,r.message,e);break;case"cuid2":mt(t,Xt.cuid2,r.message,e);break;case"startsWith":mt(t,RegExp(`^${$c(r.value,e)}`),r.message,e);break;case"endsWith":mt(t,RegExp(`${$c(r.value,e)}$`),r.message,e);break;case"datetime":en(t,"date-time",r.message,e);break;case"date":en(t,"date",r.message,e);break;case"time":en(t,"time",r.message,e);break;case"duration":en(t,"duration",r.message,e);break;case"length":Ie(t,"minLength",typeof t.minLength=="number"?Math.max(t.minLength,r.value):r.value,r.message,e),Ie(t,"maxLength",typeof t.maxLength=="number"?Math.min(t.maxLength,r.value):r.value,r.message,e);break;case"includes":{mt(t,RegExp($c(r.value,e)),r.message,e);break}case"ip":{r.version!=="v6"&&en(t,"ipv4",r.message,e),r.version!=="v4"&&en(t,"ipv6",r.message,e);break}case"base64url":mt(t,Xt.base64url,r.message,e);break;case"jwt":mt(t,Xt.jwt,r.message,e);break;case"cidr":{r.version!=="v6"&&mt(t,Xt.ipv4Cidr,r.message,e),r.version!=="v4"&&mt(t,Xt.ipv6Cidr,r.message,e);break}case"emoji":mt(t,Xt.emoji(),r.message,e);break;case"ulid":{mt(t,Xt.ulid,r.message,e);break}case"base64":{switch(e.base64Strategy){case"format:binary":{en(t,"binary",r.message,e);break}case"contentEncoding:base64":{Ie(t,"contentEncoding","base64",r.message,e);break}case"pattern:zod":{mt(t,Xt.base64,r.message,e);break}}break}case"nanoid":mt(t,Xt.nanoid,r.message,e)}return t}function $c(s,e){return e.patternStrategy==="escape"?L1(s):s}const P1=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function L1(s){let e="";for(let t=0;t<s.length;t++)P1.has(s[t])||(e+="\\"),e+=s[t];return e}function en(s,e,t,r){var a;s.format||(a=s.anyOf)!=null&&a.some(o=>o.format)?(s.anyOf||(s.anyOf=[]),s.format&&(s.anyOf.push({format:s.format,...s.errorMessage&&r.errorMessages&&{errorMessage:{format:s.errorMessage.format}}}),delete s.format,s.errorMessage&&(delete s.errorMessage.format,Object.keys(s.errorMessage).length===0&&delete s.errorMessage)),s.anyOf.push({format:e,...t&&r.errorMessages&&{errorMessage:{format:t}}})):Ie(s,"format",e,t,r)}function mt(s,e,t,r){var a;s.pattern||(a=s.allOf)!=null&&a.some(o=>o.pattern)?(s.allOf||(s.allOf=[]),s.pattern&&(s.allOf.push({pattern:s.pattern,...s.errorMessage&&r.errorMessages&&{errorMessage:{pattern:s.errorMessage.pattern}}}),delete s.pattern,s.errorMessage&&(delete s.errorMessage.pattern,Object.keys(s.errorMessage).length===0&&delete s.errorMessage)),s.allOf.push({pattern:Gg(e,r),...t&&r.errorMessages&&{errorMessage:{pattern:t}}})):Ie(s,"pattern",Gg(e,r),t,r)}function Gg(s,e){var f;if(!e.applyRegexFlags||!s.flags)return s.source;const t={i:s.flags.includes("i"),m:s.flags.includes("m"),s:s.flags.includes("s")},r=t.i?s.source.toLowerCase():s.source;let a="",o=!1,l=!1,c=!1;for(let h=0;h<r.length;h++){if(o){a+=r[h],o=!1;continue}if(t.i){if(l){if(r[h].match(/[a-z]/)){c?(a+=r[h],a+=`${r[h-2]}-${r[h]}`.toUpperCase(),c=!1):r[h+1]==="-"&&((f=r[h+2])!=null&&f.match(/[a-z]/))?(a+=r[h],c=!0):a+=`${r[h]}${r[h].toUpperCase()}`;continue}}else if(r[h].match(/[a-z]/)){a+=`[${r[h]}${r[h].toUpperCase()}]`;continue}}if(t.m){if(r[h]==="^"){a+=`(^|(?<=[\r
]))`;continue}else if(r[h]==="$"){a+=`($|(?=[\r
]))`;continue}}if(t.s&&r[h]==="."){a+=l?`${r[h]}\r
`:`[${r[h]}\r
]`;continue}a+=r[h],r[h]==="\\"?o=!0:l&&r[h]==="]"?l=!1:!l&&r[h]==="["&&(l=!0)}try{new RegExp(a)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),s.source}return a}function Fy(s,e){var r,a,o,l,c,f;if(e.target==="openAi"&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),e.target==="openApi3"&&((r=s.keyType)==null?void 0:r._def.typeName)===Z.ZodEnum)return{type:"object",required:s.keyType._def.values,properties:s.keyType._def.values.reduce((h,m)=>({...h,[m]:xe(s.valueType._def,{...e,currentPath:[...e.currentPath,"properties",m]})??$t(e)}),{}),additionalProperties:e.rejectedAdditionalProperties};const t={type:"object",additionalProperties:xe(s.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??e.allowedAdditionalProperties};if(e.target==="openApi3")return t;if(((a=s.keyType)==null?void 0:a._def.typeName)===Z.ZodString&&((o=s.keyType._def.checks)!=null&&o.length)){const{type:h,...m}=zy(s.keyType._def,e);return{...t,propertyNames:m}}else{if(((l=s.keyType)==null?void 0:l._def.typeName)===Z.ZodEnum)return{...t,propertyNames:{enum:s.keyType._def.values}};if(((c=s.keyType)==null?void 0:c._def.typeName)===Z.ZodBranded&&s.keyType._def.type._def.typeName===Z.ZodString&&((f=s.keyType._def.type._def.checks)!=null&&f.length)){const{type:h,...m}=My(s.keyType._def,e);return{...t,propertyNames:m}}}return t}function j1(s,e){if(e.mapStrategy==="record")return Fy(s,e);const t=xe(s.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||$t(e),r=xe(s.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||$t(e);return{type:"array",maxItems:125,items:{type:"array",items:[t,r],minItems:2,maxItems:2}}}function $1(s){const e=s.values,r=Object.keys(s.values).filter(o=>typeof e[e[o]]!="number").map(o=>e[o]),a=Array.from(new Set(r.map(o=>typeof o)));return{type:a.length===1?a[0]==="string"?"string":"number":["string","number"],enum:r}}function D1(s){return s.target==="openAi"?void 0:{not:$t({...s,currentPath:[...s.currentPath,"not"]})}}function M1(s){return s.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const lo={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function U1(s,e){if(e.target==="openApi3")return qg(s,e);const t=s.options instanceof Map?Array.from(s.options.values()):s.options;if(t.every(r=>r._def.typeName in lo&&(!r._def.checks||!r._def.checks.length))){const r=t.reduce((a,o)=>{const l=lo[o._def.typeName];return l&&!a.includes(l)?[...a,l]:a},[]);return{type:r.length>1?r:r[0]}}else if(t.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=t.reduce((a,o)=>{const l=typeof o._def.value;switch(l){case"string":case"number":case"boolean":return[...a,l];case"bigint":return[...a,"integer"];case"object":if(o._def.value===null)return[...a,"null"];case"symbol":case"undefined":case"function":default:return a}},[]);if(r.length===t.length){const a=r.filter((o,l,c)=>c.indexOf(o)===l);return{type:a.length>1?a:a[0],enum:t.reduce((o,l)=>o.includes(l._def.value)?o:[...o,l._def.value],[])}}}else if(t.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:t.reduce((r,a)=>[...r,...a._def.values.filter(o=>!r.includes(o))],[])};return qg(s,e)}const qg=(s,e)=>{const t=(s.options instanceof Map?Array.from(s.options.values()):s.options).map((r,a)=>xe(r._def,{...e,currentPath:[...e.currentPath,"anyOf",`${a}`]})).filter(r=>!!r&&(!e.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return t.length?{anyOf:t}:void 0};function z1(s,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(s.innerType._def.typeName)&&(!s.innerType._def.checks||!s.innerType._def.checks.length))return e.target==="openApi3"?{type:lo[s.innerType._def.typeName],nullable:!0}:{type:[lo[s.innerType._def.typeName],"null"]};if(e.target==="openApi3"){const r=xe(s.innerType._def,{...e,currentPath:[...e.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const t=xe(s.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return t&&{anyOf:[t,{type:"null"}]}}function F1(s,e){const t={type:"number"};if(!s.checks)return t;for(const r of s.checks)switch(r.kind){case"int":t.type="integer",$y(t,"type",r.message,e);break;case"min":e.target==="jsonSchema7"?r.inclusive?Ie(t,"minimum",r.value,r.message,e):Ie(t,"exclusiveMinimum",r.value,r.message,e):(r.inclusive||(t.exclusiveMinimum=!0),Ie(t,"minimum",r.value,r.message,e));break;case"max":e.target==="jsonSchema7"?r.inclusive?Ie(t,"maximum",r.value,r.message,e):Ie(t,"exclusiveMaximum",r.value,r.message,e):(r.inclusive||(t.exclusiveMaximum=!0),Ie(t,"maximum",r.value,r.message,e));break;case"multipleOf":Ie(t,"multipleOf",r.value,r.message,e);break}return t}function B1(s,e){const t=e.target==="openAi",r={type:"object",properties:{}},a=[],o=s.shape();for(const c in o){let f=o[c];if(f===void 0||f._def===void 0)continue;let h=G1(f);h&&t&&(f._def.typeName==="ZodOptional"&&(f=f._def.innerType),f.isNullable()||(f=f.nullable()),h=!1);const m=xe(f._def,{...e,currentPath:[...e.currentPath,"properties",c],propertyPath:[...e.currentPath,"properties",c]});m!==void 0&&(r.properties[c]=m,h||a.push(c))}a.length&&(r.required=a);const l=H1(s,e);return l!==void 0&&(r.additionalProperties=l),r}function H1(s,e){if(s.catchall._def.typeName!=="ZodNever")return xe(s.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]});switch(s.unknownKeys){case"passthrough":return e.allowedAdditionalProperties;case"strict":return e.rejectedAdditionalProperties;case"strip":return e.removeAdditionalStrategy==="strict"?e.allowedAdditionalProperties:e.rejectedAdditionalProperties}}function G1(s){try{return s.isOptional()}catch{return!0}}const q1=(s,e)=>{var r;if(e.currentPath.toString()===((r=e.propertyPath)==null?void 0:r.toString()))return xe(s.innerType._def,e);const t=xe(s.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return t?{anyOf:[{not:$t(e)},t]}:$t(e)},V1=(s,e)=>{if(e.pipeStrategy==="input")return xe(s.in._def,e);if(e.pipeStrategy==="output")return xe(s.out._def,e);const t=xe(s.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),r=xe(s.out._def,{...e,currentPath:[...e.currentPath,"allOf",t?"1":"0"]});return{allOf:[t,r].filter(a=>a!==void 0)}};function Z1(s,e){return xe(s.type._def,e)}function W1(s,e){const r={type:"array",uniqueItems:!0,items:xe(s.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return s.minSize&&Ie(r,"minItems",s.minSize.value,s.minSize.message,e),s.maxSize&&Ie(r,"maxItems",s.maxSize.value,s.maxSize.message,e),r}function K1(s,e){return s.rest?{type:"array",minItems:s.items.length,items:s.items.map((t,r)=>xe(t._def,{...e,currentPath:[...e.currentPath,"items",`${r}`]})).reduce((t,r)=>r===void 0?t:[...t,r],[]),additionalItems:xe(s.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:s.items.length,maxItems:s.items.length,items:s.items.map((t,r)=>xe(t._def,{...e,currentPath:[...e.currentPath,"items",`${r}`]})).reduce((t,r)=>r===void 0?t:[...t,r],[])}}function J1(s){return{not:$t(s)}}function Q1(s){return $t(s)}const Y1=(s,e)=>xe(s.innerType._def,e),X1=(s,e,t)=>{switch(e){case Z.ZodString:return zy(s,t);case Z.ZodNumber:return F1(s,t);case Z.ZodObject:return B1(s,t);case Z.ZodBigInt:return S1(s,t);case Z.ZodBoolean:return O1();case Z.ZodDate:return Uy(s,t);case Z.ZodUndefined:return J1(t);case Z.ZodNull:return M1(t);case Z.ZodArray:return E1(s,t);case Z.ZodUnion:case Z.ZodDiscriminatedUnion:return U1(s,t);case Z.ZodIntersection:return N1(s,t);case Z.ZodTuple:return K1(s,t);case Z.ZodRecord:return Fy(s,t);case Z.ZodLiteral:return A1(s,t);case Z.ZodEnum:return I1(s);case Z.ZodNativeEnum:return $1(s);case Z.ZodNullable:return z1(s,t);case Z.ZodOptional:return q1(s,t);case Z.ZodMap:return j1(s,t);case Z.ZodSet:return W1(s,t);case Z.ZodLazy:return()=>s.getter()._def;case Z.ZodPromise:return Z1(s,t);case Z.ZodNaN:case Z.ZodNever:return D1(t);case Z.ZodEffects:return R1(s,t);case Z.ZodAny:return $t(t);case Z.ZodUnknown:return Q1(t);case Z.ZodDefault:return x1(s,t);case Z.ZodBranded:return My(s,t);case Z.ZodReadonly:return Y1(s,t);case Z.ZodCatch:return k1(s,t);case Z.ZodPipeline:return V1(s,t);case Z.ZodFunction:case Z.ZodVoid:case Z.ZodSymbol:return;default:return(r=>{})()}};function xe(s,e,t=!1){var c;const r=e.seen.get(s);if(e.override){const f=(c=e.override)==null?void 0:c.call(e,s,e,r,t);if(f!==_1)return f}if(r&&!t){const f=eO(r,e);if(f!==void 0)return f}const a={def:s,path:e.currentPath,jsonSchema:void 0};e.seen.set(s,a);const o=X1(s,s.typeName,e),l=typeof o=="function"?xe(o(),e):o;if(l&&tO(s,e,l),e.postProcess){const f=e.postProcess(l,s,e);return a.jsonSchema=l,f}return a.jsonSchema=l,l}const eO=(s,e)=>{switch(e.$refStrategy){case"root":return{$ref:s.path.join("/")};case"relative":return{$ref:Dy(e.currentPath,s.path)};case"none":case"seen":return s.path.length<e.currentPath.length&&s.path.every((t,r)=>e.currentPath[r]===t)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),$t(e)):e.$refStrategy==="seen"?$t(e):void 0}},tO=(s,e,t)=>(s.description&&(t.description=s.description,e.markdownDescription&&(t.markdownDescription=s.description)),t),nO=(s,e)=>{const t=b1(e);let r;const a=e==null?void 0:e.name,o=xe(s._def,t,!1)??$t(t);t.flags.hasReferencedOpenAiAnyType&&(r||(r={}),r[t.openAiAnyTypeName]||(r[t.openAiAnyTypeName]={type:["string","number","integer","boolean","array","null"],items:{$ref:t.$refStrategy==="relative"?"1":[...t.basePath,t.definitionPath,t.openAiAnyTypeName].join("/")}}));const l=a===void 0?r?{...o,[t.definitionPath]:r}:o:{$ref:[...t.$refStrategy==="relative"?[]:t.basePath,t.definitionPath,a].join("/"),[t.definitionPath]:{...r,[a]:o}};return t.target==="jsonSchema7"?l.$schema="http://json-schema.org/draft-07/schema#":(t.target==="jsonSchema2019-09"||t.target==="openAi")&&(l.$schema="https://json-schema.org/draft/2019-09/schema#"),t.target==="openAi"&&("anyOf"in l||"oneOf"in l||"allOf"in l||"type"in l&&Array.isArray(l.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),l};function On(s){if(typeof s!="object"||s===null)return!1;const e=s;if(!("_zod"in e))return!1;const t=e._zod;return typeof t=="object"&&t!==null&&"def"in t}function sr(s){if(typeof s!="object"||s===null)return!1;const e=s;if(!("_def"in e)||"_zod"in e)return!1;const t=e._def;return typeof t=="object"&&t!=null&&"typeName"in t}function rO(s){return!s||typeof s!="object"||Array.isArray(s)?!1:!!(On(s)||sr(s))}async function iO(s,e){if(On(s))return u1(s,e);if(sr(s))return s.parse(e);throw new Error("Schema must be an instance of z3.ZodType or z4.$ZodType")}function sO(s){var e;if(On(s))return(e=Qn.get(s))==null?void 0:e.description;if(sr(s)||"description"in s&&typeof s.description=="string")return s.description}function aO(s){return rO(s)?sr(s)?s._def.typeName==="ZodString":On(s)?s._zod.def.type==="string":!1:!1}function ds(s){return On(s)?typeof s=="object"&&s!==null&&"_zod"in s&&typeof s._zod=="object"&&s._zod!==null&&"def"in s._zod&&typeof s._zod.def=="object"&&s._zod.def!==null&&"type"in s._zod.def&&s._zod.def.type==="object":!1}function By(s){return On(s)?typeof s=="object"&&s!==null&&"_zod"in s&&typeof s._zod=="object"&&s._zod!==null&&"def"in s._zod&&typeof s._zod.def=="object"&&s._zod.def!==null&&"type"in s._zod.def&&s._zod.def.type==="array":!1}function Yc(s,e=!1){if(sr(s))return s.strict();if(ds(s)){const t=s._zod.def.shape;if(e)for(const[o,l]of Object.entries(s._zod.def.shape)){if(ds(l)){const f=Yc(l,e);t[o]=f}else if(By(l)){let f=l._zod.def.element;ds(f)&&(f=Yc(f,e)),t[o]=uo(l,{...l._zod.def,element:f})}else t[o]=l;const c=Qn.get(l);c&&Qn.add(t[o],c)}const r=uo(s,{...s._zod.def,shape:t,catchall:y1(m1)}),a=Qn.get(s);return a&&Qn.add(r,a),r}throw new Error("Schema must be an instance of z3.ZodObject or z4.$ZodObject")}function oO(s){return sr(s)&&"typeName"in s._def&&s._def.typeName==="ZodEffects"}function uO(s){return On(s)&&s._zod.def.type==="pipe"}function is(s,e=!1){if(sr(s))return oO(s)?is(s._def.schema,e):s;if(On(s)){let t=s;if(uO(s)&&(t=is(s._zod.def.in,e)),e){if(ds(t)){const a=t._zod.def.shape;for(const[o,l]of Object.entries(t._zod.def.shape))a[o]=is(l,e);t=uo(t,{...t._zod.def,shape:a})}else if(By(t)){const a=is(t._zod.def.element,e);t=uo(t,{...t._zod.def,element:a})}}const r=Qn.get(s);return r&&Qn.add(t,r),t}throw new Error("Schema must be an instance of z3.ZodType or z4.$ZodType")}function lO(s){if(On(s)){const e=is(s,!0);if(ds(e)){const t=Yc(e,!0);return Hg(t)}else return Hg(s)}return sr(s)?nO(s):s}function cO(s,e){if(s!==void 0&&!as(s))return s;if(gd(e))try{let t=e.getName();return t=t.startsWith("Runnable")?t.slice(8):t,t}catch{return e.getName()}else return e.name??"UnknownSchema"}function dO(s){return gd(s.data)?{type:"runnable",data:{id:s.data.lc_id,name:s.data.getName()}}:{type:"schema",data:{...lO(s.data.schema),title:s.data.name}}}class Eo{constructor(e){Object.defineProperty(this,"nodes",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"edges",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.nodes=(e==null?void 0:e.nodes)??this.nodes,this.edges=(e==null?void 0:e.edges)??this.edges}toJSON(){const e={};return Object.values(this.nodes).forEach((t,r)=>{e[t.id]=as(t.id)?r:t.id}),{nodes:Object.values(this.nodes).map(t=>({id:e[t.id],...dO(t)})),edges:this.edges.map(t=>{const r={source:e[t.source],target:e[t.target]};return typeof t.data<"u"&&(r.data=t.data),typeof t.conditional<"u"&&(r.conditional=t.conditional),r})}}addNode(e,t,r){if(t!==void 0&&this.nodes[t]!==void 0)throw new Error(`Node with id ${t} already exists`);const a=t??Tt(),o={id:a,data:e,name:cO(t,e),metadata:r};return this.nodes[a]=o,o}removeNode(e){delete this.nodes[e.id],this.edges=this.edges.filter(t=>t.source!==e.id&&t.target!==e.id)}addEdge(e,t,r,a){if(this.nodes[e.id]===void 0)throw new Error(`Source node ${e.id} not in graph`);if(this.nodes[t.id]===void 0)throw new Error(`Target node ${t.id} not in graph`);const o={source:e.id,target:t.id,data:r,conditional:a};return this.edges.push(o),o}firstNode(){return Vg(this)}lastNode(){return Zg(this)}extend(e,t=""){let r=t;Object.values(e.nodes).map(h=>h.id).every(as)&&(r="");const o=h=>r?`${r}:${h}`:h;Object.entries(e.nodes).forEach(([h,m])=>{this.nodes[o(h)]={...m,id:o(h)}});const l=e.edges.map(h=>({...h,source:o(h.source),target:o(h.target)}));this.edges=[...this.edges,...l];const c=e.firstNode(),f=e.lastNode();return[c?{id:o(c.id),data:c.data}:void 0,f?{id:o(f.id),data:f.data}:void 0]}trimFirstNode(){const e=this.firstNode();e&&Vg(this,[e.id])&&this.removeNode(e)}trimLastNode(){const e=this.lastNode();e&&Zg(this,[e.id])&&this.removeNode(e)}reid(){const e=Object.fromEntries(Object.values(this.nodes).map(a=>[a.id,a.name])),t=new Map;Object.values(e).forEach(a=>{t.set(a,(t.get(a)||0)+1)});const r=a=>{const o=e[a];return as(a)&&t.get(o)===1?o:a};return new Eo({nodes:Object.fromEntries(Object.entries(this.nodes).map(([a,o])=>[r(a),{...o,id:r(a)}])),edges:this.edges.map(a=>({...a,source:r(a.source),target:r(a.target)}))})}drawMermaid(e){const{withStyles:t,curveStyle:r,nodeColors:a={default:"fill:#f2f0ff,line-height:1.2",first:"fill-opacity:0",last:"fill:#bfb6fc"},wrapLabelNWords:o}=e??{},l=this.reid(),c=l.firstNode(),f=l.lastNode();return YS(l.nodes,l.edges,{firstNode:c==null?void 0:c.id,lastNode:f==null?void 0:f.id,withStyles:t,curveStyle:r,nodeColors:a,wrapLabelNWords:o})}async drawMermaidPng(e){const t=this.drawMermaid(e);return XS(t,{backgroundColor:e==null?void 0:e.backgroundColor})}}function Vg(s,e=[]){const t=new Set(s.edges.filter(a=>!e.includes(a.source)).map(a=>a.target)),r=[];for(const a of Object.values(s.nodes))!e.includes(a.id)&&!t.has(a.id)&&r.push(a);return r.length===1?r[0]:void 0}function Zg(s,e=[]){const t=new Set(s.edges.filter(a=>!e.includes(a.target)).map(a=>a.source)),r=[];for(const a of Object.values(s.nodes))!e.includes(a.id)&&!t.has(a.id)&&r.push(a);return r.length===1?r[0]:void 0}function fO(s){const e=new TextEncoder,t=new ReadableStream({async start(r){for await(const a of s)r.enqueue(e.encode(`event: data
data: ${JSON.stringify(a)}

`));r.enqueue(e.encode(`event: end

`)),r.close()}});return jt.fromReadableStream(t)}function Wg(s){return typeof s=="object"&&s!==null&&typeof s[Symbol.iterator]=="function"&&typeof s.next=="function"}const hO=s=>s!=null&&typeof s=="object"&&"next"in s&&typeof s.next=="function";function Xc(s){return typeof s=="object"&&s!==null&&typeof s[Symbol.asyncIterator]=="function"}function*Kg(s,e){for(;;){const{value:t,done:r}=rr.runWithConfig(ui(s),e.next.bind(e),!0);if(r)break;yield t}}async function*ed(s,e){const t=e[Symbol.asyncIterator]();for(;;){const{value:r,done:a}=await rr.runWithConfig(ui(s),t.next.bind(e),!0);if(a)break;yield r}}function tt(s,e){return s&&!Array.isArray(s)&&!(s instanceof Date)&&typeof s=="object"?s:{[e]:s}}class gt extends oi{constructor(){super(...arguments),Object.defineProperty(this,"lc_runnable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}getName(e){const t=this.name??this.constructor.lc_name()??this.constructor.name;return e?`${t}${e}`:t}bind(e){return new br({bound:this,kwargs:e,config:{}})}map(){return new co({bound:this})}withRetry(e){return new Hy({bound:this,kwargs:{},config:{},maxAttemptNumber:e==null?void 0:e.stopAfterAttempt,...e})}withConfig(e){return new br({bound:this,config:e,kwargs:{}})}withFallbacks(e){const t=Array.isArray(e)?e:e.fallbacks;return new mO({runnable:this,fallbacks:t})}_getOptionsList(e,t=0){if(Array.isArray(e)&&e.length!==t)throw new Error(`Passed "options" must be an array with the same length as the inputs, but got ${e.length} options for ${t} inputs`);if(Array.isArray(e))return e.map(Ne);if(t>1&&!Array.isArray(e)&&e.runId){console.warn("Provided runId will be used only for the first element of the batch.");const r=Object.fromEntries(Object.entries(e).filter(([a])=>a!=="runId"));return Array.from({length:t},(a,o)=>Ne(o===0?e:r))}return Array.from({length:t},()=>Ne(e))}async batch(e,t,r){var f;const a=this._getOptionsList(t??{},e.length),o=((f=a[0])==null?void 0:f.maxConcurrency)??(r==null?void 0:r.maxConcurrency),l=new WS({maxConcurrency:o,onFailedAttempt:h=>{throw h}}),c=e.map((h,m)=>l.call(async()=>{try{return await this.invoke(h,a[m])}catch(_){if(r!=null&&r.returnExceptions)return _;throw _}}));return Promise.all(c)}async*_streamIterator(e,t){yield this.invoke(e,t)}async stream(e,t){const r=Ne(t),a=new ci({generator:this._streamIterator(e,r),config:r});return await a.setup,jt.fromAsyncGenerator(a)}_separateRunnableConfigFromCallOptions(e){let t;e===void 0?t=Ne(e):t=Ne({callbacks:e.callbacks,tags:e.tags,metadata:e.metadata,runName:e.runName,configurable:e.configurable,recursionLimit:e.recursionLimit,maxConcurrency:e.maxConcurrency,runId:e.runId,timeout:e.timeout,signal:e.signal});const r={...e};return delete r.callbacks,delete r.tags,delete r.metadata,delete r.runName,delete r.configurable,delete r.recursionLimit,delete r.maxConcurrency,delete r.runId,delete r.timeout,delete r.signal,[t,r]}async _callWithConfig(e,t,r){const a=Ne(r),o=await nn(a),l=await(o==null?void 0:o.handleChainStart(this.toJSON(),tt(t,"input"),a.runId,a==null?void 0:a.runType,void 0,void 0,(a==null?void 0:a.runName)??this.getName()));delete a.runId;let c;try{const f=e.call(this,t,a,l);c=await ir(f,r==null?void 0:r.signal)}catch(f){throw await(l==null?void 0:l.handleChainError(f)),f}return await(l==null?void 0:l.handleChainEnd(tt(c,"output"))),c}async _batchWithConfig(e,t,r,a){var h;const o=this._getOptionsList(r??{},t.length),l=await Promise.all(o.map(nn)),c=await Promise.all(l.map(async(m,_)=>{const y=await(m==null?void 0:m.handleChainStart(this.toJSON(),tt(t[_],"input"),o[_].runId,o[_].runType,void 0,void 0,o[_].runName??this.getName()));return delete o[_].runId,y}));let f;try{const m=e.call(this,t,o,c,a);f=await ir(m,(h=o==null?void 0:o[0])==null?void 0:h.signal)}catch(m){throw await Promise.all(c.map(_=>_==null?void 0:_.handleChainError(m))),m}return await Promise.all(c.map(m=>m==null?void 0:m.handleChainEnd(tt(f,"output")))),f}_concatOutputChunks(e,t){return Ay(e,t)}async*_transformStreamWithConfig(e,t,r){let a,o=!0,l,c=!0;const f=Ne(r),h=await nn(f),m=this;async function*_(){for await(const w of e){if(o)if(a===void 0)a=w;else try{a=m._concatOutputChunks(a,w)}catch{a=void 0,o=!1}yield w}}let y;try{const w=await FS(t.bind(this),_(),async()=>h==null?void 0:h.handleChainStart(this.toJSON(),{input:""},f.runId,f.runType,void 0,void 0,f.runName??this.getName()),r==null?void 0:r.signal,f);delete f.runId,y=w.setup;const b=y==null?void 0:y.handlers.find(GS);let E=w.output;b!==void 0&&y!==void 0&&(E=b.tapOutputIterable(y.runId,E));const S=y==null?void 0:y.handlers.find(BS);S!==void 0&&y!==void 0&&(E=S.tapOutputIterable(y.runId,E));for await(const O of E)if(yield O,c)if(l===void 0)l=O;else try{l=this._concatOutputChunks(l,O)}catch{l=void 0,c=!1}}catch(w){throw await(y==null?void 0:y.handleChainError(w,void 0,void 0,void 0,{inputs:tt(a,"input")})),w}await(y==null?void 0:y.handleChainEnd(l??{},void 0,void 0,void 0,{inputs:tt(a,"input")}))}getGraph(e){const t=new Eo,r=t.addNode({name:`${this.getName()}Input`,schema:im()}),a=t.addNode(this),o=t.addNode({name:`${this.getName()}Output`,schema:im()});return t.addEdge(r,a),t.addEdge(a,o),t}pipe(e){return new vr({first:this,last:wr(e)})}pick(e){return this.pipe(new yO(e))}assign(e){return this.pipe(new gO(new Os({steps:e})))}async*transform(e,t){let r;for await(const a of e)r===void 0?r=a:r=this._concatOutputChunks(r,a);yield*this._streamIterator(r,Ne(t))}async*streamLog(e,t,r){const a=new Fg({...r,autoClose:!1,_schemaFormat:"original"}),o=Ne(t);yield*this._streamLog(e,a,o)}async*_streamLog(e,t,r){const{callbacks:a}=r;if(a===void 0)r.callbacks=[t];else if(Array.isArray(a))r.callbacks=a.concat([t]);else{const f=a.copy();f.addHandler(t,!0),r.callbacks=f}const o=this.stream(e,r);async function l(){try{const f=await o;for await(const h of f){const m=new Kn({ops:[{op:"add",path:"/streamed_output/-",value:h}]});await t.writer.write(m)}}finally{await t.writer.close()}}const c=l();try{for await(const f of t)yield f}finally{await c}}streamEvents(e,t,r){let a;if(t.version==="v1")a=this._streamEventsV1(e,t,r);else if(t.version==="v2")a=this._streamEventsV2(e,t,r);else throw new Error('Only versions "v1" and "v2" of the schema are currently supported.');return t.encoding==="text/event-stream"?fO(a):jt.fromAsyncGenerator(a)}async*_streamEventsV2(e,t,r){var b;const a=new qS({...r,autoClose:!1}),o=Ne(t),l=o.runId??Tt();o.runId=l;const c=o.callbacks;if(c===void 0)o.callbacks=[a];else if(Array.isArray(c))o.callbacks=c.concat(a);else{const E=c.copy();E.addHandler(a,!0),o.callbacks=E}const f=new AbortController,h=this;async function m(){let E,S=null;try{t!=null&&t.signal?"any"in AbortSignal?E=AbortSignal.any([f.signal,t.signal]):(E=t.signal,S=()=>{f.abort()},t.signal.addEventListener("abort",S,{once:!0})):E=f.signal;const O=await h.stream(e,{...o,signal:E}),R=a.tapOutputIterable(l,O);for await(const T of R)if(f.signal.aborted)break}finally{await a.finish(),E&&S&&E.removeEventListener("abort",S)}}const _=m();let y=!1,w;try{for await(const E of a){if(!y){E.data.input=e,y=!0,w=E.run_id,yield E;continue}E.run_id===w&&E.event.endsWith("_end")&&(b=E.data)!=null&&b.input&&delete E.data.input,yield E}}finally{f.abort(),await _}}async*_streamEventsV1(e,t,r){let a,o=!1;const l=Ne(t),c=l.tags??[],f=l.metadata??{},h=l.runName??this.getName(),m=new Fg({...r,autoClose:!1,_schemaFormat:"streaming_events"}),_=new KS({...r}),y=this._streamLog(e,m,l);for await(const b of y){if(a?a=a.concat(b):a=vs.fromRunLogPatch(b),a.state===void 0)throw new Error('Internal error: "streamEvents" state is missing. Please open a bug report.');if(!o){o=!0;const R={...a.state},T={run_id:R.id,event:`on_${R.type}_start`,name:h,tags:c,metadata:f,data:{input:e}};_.includeEvent(T,R.type)&&(yield T)}const E=b.ops.filter(R=>R.path.startsWith("/logs/")).map(R=>R.path.split("/")[2]),S=[...new Set(E)];for(const R of S){let T,$={};const P=a.state.logs[R];if(P.end_time===void 0?P.streamed_output.length>0?T="stream":T="start":T="end",T==="start")P.inputs!==void 0&&($.input=P.inputs);else if(T==="end")P.inputs!==void 0&&($.input=P.inputs),$.output=P.final_output;else if(T==="stream"){const z=P.streamed_output.length;if(z!==1)throw new Error(`Expected exactly one chunk of streamed output, got ${z} instead. Encountered in: "${P.name}"`);$={chunk:P.streamed_output[0]},P.streamed_output=[]}yield{event:`on_${P.type}_${T}`,name:P.name,run_id:P.id,tags:P.tags,metadata:P.metadata,data:$}}const{state:O}=a;if(O.streamed_output.length>0){const R=O.streamed_output.length;if(R!==1)throw new Error(`Expected exactly one chunk of streamed output, got ${R} instead. Encountered in: "${O.name}"`);const T={chunk:O.streamed_output[0]};O.streamed_output=[];const $={event:`on_${O.type}_stream`,run_id:O.id,tags:c,metadata:f,name:h,data:T};_.includeEvent($,O.type)&&(yield $)}}const w=a==null?void 0:a.state;if(w!==void 0){const b={event:`on_${w.type}_end`,name:h,run_id:w.id,tags:c,metadata:f,data:{output:w.final_output}};_.includeEvent(b,w.type)&&(yield b)}}static isRunnable(e){return gd(e)}withListeners({onStart:e,onEnd:t,onError:r}){return new br({bound:this,config:{},configFactories:[a=>({callbacks:[new Py({config:a,onStart:e,onEnd:t,onError:r})]})]})}asTool(e){return _O(this,e)}}class br extends gt{static lc_name(){return"RunnableBinding"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"bound",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"configFactories",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.bound=e.bound,this.kwargs=e.kwargs,this.config=e.config,this.configFactories=e.configFactories}getName(e){return this.bound.getName(e)}async _mergeConfig(...e){const t=Mg(this.config,...e);return Mg(t,...this.configFactories?await Promise.all(this.configFactories.map(async r=>await r(t))):[])}bind(e){return new this.constructor({bound:this.bound,kwargs:{...this.kwargs,...e},config:this.config})}withConfig(e){return new this.constructor({bound:this.bound,kwargs:this.kwargs,config:{...this.config,...e}})}withRetry(e){return new Hy({bound:this.bound,kwargs:this.kwargs,config:this.config,maxAttemptNumber:e==null?void 0:e.stopAfterAttempt,...e})}async invoke(e,t){return this.bound.invoke(e,await this._mergeConfig(Ne(t),this.kwargs))}async batch(e,t,r){const a=Array.isArray(t)?await Promise.all(t.map(async o=>this._mergeConfig(Ne(o),this.kwargs))):await this._mergeConfig(Ne(t),this.kwargs);return this.bound.batch(e,a,r)}_concatOutputChunks(e,t){return this.bound._concatOutputChunks(e,t)}async*_streamIterator(e,t){yield*this.bound._streamIterator(e,await this._mergeConfig(Ne(t),this.kwargs))}async stream(e,t){return this.bound.stream(e,await this._mergeConfig(Ne(t),this.kwargs))}async*transform(e,t){yield*this.bound.transform(e,await this._mergeConfig(Ne(t),this.kwargs))}streamEvents(e,t,r){const a=this,o=async function*(){yield*a.bound.streamEvents(e,{...await a._mergeConfig(Ne(t),a.kwargs),version:t.version},r)};return jt.fromAsyncGenerator(o())}static isRunnableBinding(e){return e.bound&&gt.isRunnable(e.bound)}withListeners({onStart:e,onEnd:t,onError:r}){return new br({bound:this.bound,kwargs:this.kwargs,config:this.config,configFactories:[a=>({callbacks:[new Py({config:a,onStart:e,onEnd:t,onError:r})]})]})}}class co extends gt{static lc_name(){return"RunnableEach"}constructor(e){super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"bound",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.bound=e.bound}bind(e){return new co({bound:this.bound.bind(e)})}async invoke(e,t){return this._callWithConfig(this._invoke.bind(this),e,t)}async _invoke(e,t,r){return this.bound.batch(e,dt(t,{callbacks:r==null?void 0:r.getChild()}))}withListeners({onStart:e,onEnd:t,onError:r}){return new co({bound:this.bound.withListeners({onStart:e,onEnd:t,onError:r})})}}class Hy extends br{static lc_name(){return"RunnableRetry"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"maxAttemptNumber",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(this,"onFailedAttempt",{enumerable:!0,configurable:!0,writable:!0,value:()=>{}}),this.maxAttemptNumber=e.maxAttemptNumber??this.maxAttemptNumber,this.onFailedAttempt=e.onFailedAttempt??this.onFailedAttempt}_patchConfigForRetry(e,t,r){const a=e>1?`retry:attempt:${e}`:void 0;return dt(t,{callbacks:r==null?void 0:r.getChild(a)})}async _invoke(e,t,r){return Hc(a=>super.invoke(e,this._patchConfigForRetry(a,t,r)),{onFailedAttempt:a=>this.onFailedAttempt(a,e),retries:Math.max(this.maxAttemptNumber-1,0),randomize:!0})}async invoke(e,t){return this._callWithConfig(this._invoke.bind(this),e,t)}async _batch(e,t,r,a){const o={};try{await Hc(async l=>{const c=e.map((y,w)=>w).filter(y=>o[y.toString()]===void 0||o[y.toString()]instanceof Error),f=c.map(y=>e[y]),h=c.map(y=>this._patchConfigForRetry(l,t==null?void 0:t[y],r==null?void 0:r[y])),m=await super.batch(f,h,{...a,returnExceptions:!0});let _;for(let y=0;y<m.length;y+=1){const w=m[y],b=c[y];w instanceof Error&&_===void 0&&(_=w,_.input=f[y]),o[b.toString()]=w}if(_)throw _;return m},{onFailedAttempt:l=>this.onFailedAttempt(l,l.input),retries:Math.max(this.maxAttemptNumber-1,0),randomize:!0})}catch(l){if((a==null?void 0:a.returnExceptions)!==!0)throw l}return Object.keys(o).sort((l,c)=>parseInt(l,10)-parseInt(c,10)).map(l=>o[parseInt(l,10)])}async batch(e,t,r){return this._batchWithConfig(this._batch.bind(this),e,t,r)}}class vr extends gt{static lc_name(){return"RunnableSequence"}constructor(e){super(e),Object.defineProperty(this,"first",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"middle",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"last",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"omitSequenceTags",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),this.first=e.first,this.middle=e.middle??this.middle,this.last=e.last,this.name=e.name,this.omitSequenceTags=e.omitSequenceTags??this.omitSequenceTags}get steps(){return[this.first,...this.middle,this.last]}async invoke(e,t){var f;const r=Ne(t),a=await nn(r),o=await(a==null?void 0:a.handleChainStart(this.toJSON(),tt(e,"input"),r.runId,void 0,void 0,void 0,r==null?void 0:r.runName));delete r.runId;let l=e,c;try{const h=[this.first,...this.middle];for(let m=0;m<h.length;m+=1){const y=h[m].invoke(l,dt(r,{callbacks:o==null?void 0:o.getChild(this.omitSequenceTags?void 0:`seq:step:${m+1}`)}));l=await ir(y,t==null?void 0:t.signal)}if((f=t==null?void 0:t.signal)!=null&&f.aborted)throw new Error("Aborted");c=await this.last.invoke(l,dt(r,{callbacks:o==null?void 0:o.getChild(this.omitSequenceTags?void 0:`seq:step:${this.steps.length}`)}))}catch(h){throw await(o==null?void 0:o.handleChainError(h)),h}return await(o==null?void 0:o.handleChainEnd(tt(c,"output"))),c}async batch(e,t,r){var f;const a=this._getOptionsList(t??{},e.length),o=await Promise.all(a.map(nn)),l=await Promise.all(o.map(async(h,m)=>{const _=await(h==null?void 0:h.handleChainStart(this.toJSON(),tt(e[m],"input"),a[m].runId,void 0,void 0,void 0,a[m].runName));return delete a[m].runId,_}));let c=e;try{for(let h=0;h<this.steps.length;h+=1){const _=this.steps[h].batch(c,l.map((y,w)=>{const b=y==null?void 0:y.getChild(this.omitSequenceTags?void 0:`seq:step:${h+1}`);return dt(a[w],{callbacks:b})}),r);c=await ir(_,(f=a[0])==null?void 0:f.signal)}}catch(h){throw await Promise.all(l.map(m=>m==null?void 0:m.handleChainError(h))),h}return await Promise.all(l.map(h=>h==null?void 0:h.handleChainEnd(tt(c,"output")))),c}_concatOutputChunks(e,t){return this.last._concatOutputChunks(e,t)}async*_streamIterator(e,t){var _;const r=await nn(t),{runId:a,...o}=t??{},l=await(r==null?void 0:r.handleChainStart(this.toJSON(),tt(e,"input"),a,void 0,void 0,void 0,o==null?void 0:o.runName)),c=[this.first,...this.middle,this.last];let f=!0,h;async function*m(){yield e}try{let y=c[0].transform(m(),dt(o,{callbacks:l==null?void 0:l.getChild(this.omitSequenceTags?void 0:"seq:step:1")}));for(let w=1;w<c.length;w+=1)y=await c[w].transform(y,dt(o,{callbacks:l==null?void 0:l.getChild(this.omitSequenceTags?void 0:`seq:step:${w+1}`)}));for await(const w of y)if((_=t==null?void 0:t.signal)==null||_.throwIfAborted(),yield w,f)if(h===void 0)h=w;else try{h=this._concatOutputChunks(h,w)}catch{h=void 0,f=!1}}catch(y){throw await(l==null?void 0:l.handleChainError(y)),y}await(l==null?void 0:l.handleChainEnd(tt(h,"output")))}getGraph(e){const t=new Eo;let r=null;return this.steps.forEach((a,o)=>{const l=a.getGraph(e);o!==0&&l.trimFirstNode(),o!==this.steps.length-1&&l.trimLastNode(),t.extend(l);const c=l.firstNode();if(!c)throw new Error(`Runnable ${a} has no first node`);r&&t.addEdge(r,c),r=l.lastNode()}),t}pipe(e){return vr.isRunnableSequence(e)?new vr({first:this.first,middle:this.middle.concat([this.last,e.first,...e.middle]),last:e.last,name:this.name??e.name}):new vr({first:this.first,middle:[...this.middle,this.last],last:wr(e),name:this.name})}static isRunnableSequence(e){return Array.isArray(e.middle)&&gt.isRunnable(e)}static from([e,...t],r){let a={};return typeof r=="string"?a.name=r:r!==void 0&&(a=r),new vr({...a,first:wr(e),middle:t.slice(0,-1).map(wr),last:wr(t[t.length-1])})}}class Os extends gt{static lc_name(){return"RunnableMap"}getStepsKeys(){return Object.keys(this.steps)}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"steps",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.steps={};for(const[t,r]of Object.entries(e.steps))this.steps[t]=wr(r)}static from(e){return new Os({steps:e})}async invoke(e,t){const r=Ne(t),a=await nn(r),o=await(a==null?void 0:a.handleChainStart(this.toJSON(),{input:e},r.runId,void 0,void 0,void 0,r==null?void 0:r.runName));delete r.runId;const l={};try{const c=Object.entries(this.steps).map(async([f,h])=>{l[f]=await h.invoke(e,dt(r,{callbacks:o==null?void 0:o.getChild(`map:key:${f}`)}))});await ir(Promise.all(c),t==null?void 0:t.signal)}catch(c){throw await(o==null?void 0:o.handleChainError(c)),c}return await(o==null?void 0:o.handleChainEnd(l)),l}async*_transform(e,t,r){const a={...this.steps},o=Ny(e,Object.keys(a).length),l=new Map(Object.entries(a).map(([c,f],h)=>{const m=f.transform(o[h],dt(r,{callbacks:t==null?void 0:t.getChild(`map:key:${c}`)}));return[c,m.next().then(_=>({key:c,gen:m,result:_}))]}));for(;l.size;){const c=Promise.race(l.values()),{key:f,result:h,gen:m}=await ir(c,r==null?void 0:r.signal);l.delete(f),h.done||(yield{[f]:h.value},l.set(f,m.next().then(_=>({key:f,gen:m,result:_}))))}}transform(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}async stream(e,t){async function*r(){yield e}const a=Ne(t),o=new ci({generator:this.transform(r(),a),config:a});return await o.setup,jt.fromAsyncGenerator(o)}}class wd extends gt{constructor(e){if(super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),!ad(e.func))throw new Error("RunnableTraceable requires a function that is wrapped in traceable higher-order function");this.func=e.func}async invoke(e,t){const[r]=this._getOptionsList(t??{},1),a=await nn(r),o=this.func(dt(r,{callbacks:a}),e);return ir(o,r==null?void 0:r.signal)}async*_streamIterator(e,t){var o,l;const[r]=this._getOptionsList(t??{},1),a=await this.invoke(e,t);if(Xc(a)){for await(const c of a)(o=r==null?void 0:r.signal)==null||o.throwIfAborted(),yield c;return}if(hO(a)){for(;;){(l=r==null?void 0:r.signal)==null||l.throwIfAborted();const c=a.next();if(c.done)break;yield c.value}return}yield a}static from(e){return new wd({func:e})}}function pO(s){if(ad(s))throw new Error("RunnableLambda requires a function that is not wrapped in traceable higher-order function. This shouldn't happen.")}class So extends gt{static lc_name(){return"RunnableLambda"}constructor(e){if(ad(e.func))return wd.from(e.func);super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),pO(e.func),this.func=e.func}static from(e){return new So({func:e})}async _invoke(e,t,r){return new Promise((a,o)=>{const l=dt(t,{callbacks:r==null?void 0:r.getChild(),recursionLimit:((t==null?void 0:t.recursionLimit)??Ac)-1});rr.runWithConfig(ui(l),async()=>{var c,f;try{let h=await this.func(e,{...l});if(h&&gt.isRunnable(h)){if((t==null?void 0:t.recursionLimit)===0)throw new Error("Recursion limit reached.");h=await h.invoke(e,{...l,recursionLimit:(l.recursionLimit??Ac)-1})}else if(Xc(h)){let m;for await(const _ of ed(l,h))if((c=t==null?void 0:t.signal)==null||c.throwIfAborted(),m===void 0)m=_;else try{m=this._concatOutputChunks(m,_)}catch{m=_}h=m}else if(Wg(h)){let m;for(const _ of Kg(l,h))if((f=t==null?void 0:t.signal)==null||f.throwIfAborted(),m===void 0)m=_;else try{m=this._concatOutputChunks(m,_)}catch{m=_}h=m}a(h)}catch(h){o(h)}})})}async invoke(e,t){return this._callWithConfig(this._invoke.bind(this),e,t)}async*_transform(e,t,r){var c,f;let a;for await(const h of e)if(a===void 0)a=h;else try{a=this._concatOutputChunks(a,h)}catch{a=h}const o=dt(r,{callbacks:t==null?void 0:t.getChild(),recursionLimit:((r==null?void 0:r.recursionLimit)??Ac)-1}),l=await new Promise((h,m)=>{rr.runWithConfig(ui(o),async()=>{try{const _=await this.func(a,{...o,config:o});h(_)}catch(_){m(_)}})});if(l&&gt.isRunnable(l)){if((r==null?void 0:r.recursionLimit)===0)throw new Error("Recursion limit reached.");const h=await l.stream(a,o);for await(const m of h)yield m}else if(Xc(l))for await(const h of ed(o,l))(c=r==null?void 0:r.signal)==null||c.throwIfAborted(),yield h;else if(Wg(l))for(const h of Kg(o,l))(f=r==null?void 0:r.signal)==null||f.throwIfAborted(),yield h;else yield l}transform(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}async stream(e,t){async function*r(){yield e}const a=Ne(t),o=new ci({generator:this.transform(r(),a),config:a});return await o.setup,jt.fromAsyncGenerator(o)}}class mO extends gt{static lc_name(){return"RunnableWithFallbacks"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"runnable",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fallbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.runnable=e.runnable,this.fallbacks=e.fallbacks}*runnables(){yield this.runnable;for(const e of this.fallbacks)yield e}async invoke(e,t){const r=Ne(t),a=await nn(r),{runId:o,...l}=r,c=await(a==null?void 0:a.handleChainStart(this.toJSON(),tt(e,"input"),o,void 0,void 0,void 0,l==null?void 0:l.runName)),f=dt(l,{callbacks:c==null?void 0:c.getChild()});return await rr.runWithConfig(f,async()=>{var _;let m;for(const y of this.runnables()){(_=r==null?void 0:r.signal)==null||_.throwIfAborted();try{const w=await y.invoke(e,f);return await(c==null?void 0:c.handleChainEnd(tt(w,"output"))),w}catch(w){m===void 0&&(m=w)}}throw m===void 0?new Error("No error stored at end of fallback."):(await(c==null?void 0:c.handleChainError(m)),m)})}async*_streamIterator(e,t){var _;const r=Ne(t),a=await nn(r),{runId:o,...l}=r,c=await(a==null?void 0:a.handleChainStart(this.toJSON(),tt(e,"input"),o,void 0,void 0,void 0,l==null?void 0:l.runName));let f,h;for(const y of this.runnables()){(_=r==null?void 0:r.signal)==null||_.throwIfAborted();const w=dt(l,{callbacks:c==null?void 0:c.getChild()});try{const b=await y.stream(e,w);h=ed(w,b);break}catch(b){f===void 0&&(f=b)}}if(h===void 0){const y=f??new Error("No error stored at end of fallback.");throw await(c==null?void 0:c.handleChainError(y)),y}let m;try{for await(const y of h){yield y;try{m=m===void 0?m:this._concatOutputChunks(m,y)}catch{m=void 0}}}catch(y){throw await(c==null?void 0:c.handleChainError(y)),y}await(c==null?void 0:c.handleChainEnd(tt(m,"output")))}async batch(e,t,r){var f;if(r!=null&&r.returnExceptions)throw new Error("Not implemented.");const a=this._getOptionsList(t??{},e.length),o=await Promise.all(a.map(h=>nn(h))),l=await Promise.all(o.map(async(h,m)=>{const _=await(h==null?void 0:h.handleChainStart(this.toJSON(),tt(e[m],"input"),a[m].runId,void 0,void 0,void 0,a[m].runName));return delete a[m].runId,_}));let c;for(const h of this.runnables()){(f=a[0].signal)==null||f.throwIfAborted();try{const m=await h.batch(e,l.map((_,y)=>dt(a[y],{callbacks:_==null?void 0:_.getChild()})),r);return await Promise.all(l.map((_,y)=>_==null?void 0:_.handleChainEnd(tt(m[y],"output")))),m}catch(m){c===void 0&&(c=m)}}throw c?(await Promise.all(l.map(h=>h==null?void 0:h.handleChainError(c))),c):new Error("No error stored at end of fallbacks.")}}function wr(s){if(typeof s=="function")return new So({func:s});if(gt.isRunnable(s))return s;if(!Array.isArray(s)&&typeof s=="object"){const e={};for(const[t,r]of Object.entries(s))e[t]=wr(r);return new Os({steps:e})}else throw new Error(`Expected a Runnable, function or object.
Instead got an unsupported type.`)}class gO extends gt{static lc_name(){return"RunnableAssign"}constructor(e){e instanceof Os&&(e={mapper:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"mapper",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.mapper=e.mapper}async invoke(e,t){const r=await this.mapper.invoke(e,t);return{...e,...r}}async*_transform(e,t,r){const a=this.mapper.getStepsKeys(),[o,l]=Ny(e),c=this.mapper.transform(l,dt(r,{callbacks:t==null?void 0:t.getChild()})),f=c.next();for await(const h of o){if(typeof h!="object"||Array.isArray(h))throw new Error(`RunnableAssign can only be used with objects as input, got ${typeof h}`);const m=Object.fromEntries(Object.entries(h).filter(([_])=>!a.includes(_)));Object.keys(m).length>0&&(yield m)}yield(await f).value;for await(const h of c)yield h}transform(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}async stream(e,t){async function*r(){yield e}const a=Ne(t),o=new ci({generator:this.transform(r(),a),config:a});return await o.setup,jt.fromAsyncGenerator(o)}}class yO extends gt{static lc_name(){return"RunnablePick"}constructor(e){(typeof e=="string"||Array.isArray(e))&&(e={keys:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"keys",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keys=e.keys}async _pick(e){if(typeof this.keys=="string")return e[this.keys];{const t=this.keys.map(r=>[r,e[r]]).filter(r=>r[1]!==void 0);return t.length===0?void 0:Object.fromEntries(t)}}async invoke(e,t){return this._callWithConfig(this._pick.bind(this),e,t)}async*_transform(e){for await(const t of e){const r=await this._pick(t);r!==void 0&&(yield r)}}transform(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}async stream(e,t){async function*r(){yield e}const a=Ne(t),o=new ci({generator:this.transform(r(),a),config:a});return await o.setup,jt.fromAsyncGenerator(o)}}class Jg extends br{constructor(e){const t=vr.from([So.from(async r=>{let a;if(_S(r))try{a=await iO(this.schema,r.args)}catch{throw new vS("Received tool input did not match expected schema",JSON.stringify(r.args))}else a=r;return a}).withConfig({runName:`${e.name}:parse_input`}),e.bound]).withConfig({runName:e.name});super({bound:t,config:e.config??{}}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"description",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e.name,this.description=e.description,this.schema=e.schema}static lc_name(){return"RunnableToolLike"}}function _O(s,e){const t=e.name??s.getName(),r=e.description??sO(e.schema);return aO(e.schema)?new Jg({name:t,description:r,schema:h0({input:f0()}).transform(a=>a.input),bound:s}):new Jg({name:t,description:r,schema:e.schema,bound:s})}class vO extends gt{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","documents","transformers"]})}invoke(e,t){return this.transformDocuments(e)}}var es={},Qg;function wO(){if(Qg)return es;Qg=1,es.byteLength=c,es.toByteArray=h,es.fromByteArray=y;for(var s=[],e=[],t=typeof Uint8Array<"u"?Uint8Array:Array,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,o=r.length;a<o;++a)s[a]=r[a],e[r.charCodeAt(a)]=a;e[45]=62,e[95]=63;function l(w){var b=w.length;if(b%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var E=w.indexOf("=");E===-1&&(E=b);var S=E===b?0:4-E%4;return[E,S]}function c(w){var b=l(w),E=b[0],S=b[1];return(E+S)*3/4-S}function f(w,b,E){return(b+E)*3/4-E}function h(w){var b,E=l(w),S=E[0],O=E[1],R=new t(f(w,S,O)),T=0,$=O>0?S-4:S,P;for(P=0;P<$;P+=4)b=e[w.charCodeAt(P)]<<18|e[w.charCodeAt(P+1)]<<12|e[w.charCodeAt(P+2)]<<6|e[w.charCodeAt(P+3)],R[T++]=b>>16&255,R[T++]=b>>8&255,R[T++]=b&255;return O===2&&(b=e[w.charCodeAt(P)]<<2|e[w.charCodeAt(P+1)]>>4,R[T++]=b&255),O===1&&(b=e[w.charCodeAt(P)]<<10|e[w.charCodeAt(P+1)]<<4|e[w.charCodeAt(P+2)]>>2,R[T++]=b>>8&255,R[T++]=b&255),R}function m(w){return s[w>>18&63]+s[w>>12&63]+s[w>>6&63]+s[w&63]}function _(w,b,E){for(var S,O=[],R=b;R<E;R+=3)S=(w[R]<<16&16711680)+(w[R+1]<<8&65280)+(w[R+2]&255),O.push(m(S));return O.join("")}function y(w){for(var b,E=w.length,S=E%3,O=[],R=16383,T=0,$=E-S;T<$;T+=R)O.push(_(w,T,T+R>$?$:T+R));return S===1?(b=w[E-1],O.push(s[b>>2]+s[b<<4&63]+"==")):S===2&&(b=(w[E-2]<<8)+w[E-1],O.push(s[b>>10]+s[b>>4&63]+s[b<<2&63]+"=")),O.join("")}return es}var bO=wO();const EO=Or(bO);var SO=Object.defineProperty,OO=(s,e,t)=>e in s?SO(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,kO=(s,e,t)=>(OO(s,e+"",t),t);function TO(s,e){let t=Array.from({length:s.length},(r,a)=>({start:a,end:a+1}));for(;t.length>1;){let r=null;for(let a=0;a<t.length-1;a++){const o=s.slice(t[a].start,t[a+1].end),l=e.get(o.join(","));l!=null&&(r==null||l<r[0])&&(r=[l,a])}if(r!=null){const a=r[1];t[a]={start:t[a].start,end:t[a+1].end},t.splice(a+1,1)}else break}return t}function xO(s,e){return s.length===1?[e.get(s.join(","))]:TO(s,e).map(t=>e.get(s.slice(t.start,t.end).join(","))).filter(t=>t!=null)}function RO(s){return s.replace(/[\\^$*+?.()|[\]{}]/g,"\\$&")}var td=class{constructor(s,e){Gn(this,"specialTokens");Gn(this,"inverseSpecialTokens");Gn(this,"patStr");Gn(this,"textEncoder",new TextEncoder);Gn(this,"textDecoder",new TextDecoder("utf-8"));Gn(this,"rankMap",new Map);Gn(this,"textMap",new Map);this.patStr=s.pat_str;const t=s.bpe_ranks.split(`
`).filter(Boolean).reduce((r,a)=>{const[o,l,...c]=a.split(" "),f=Number.parseInt(l,10);return c.forEach((h,m)=>r[h]=f+m),r},{});for(const[r,a]of Object.entries(t)){const o=EO.toByteArray(r);this.rankMap.set(o.join(","),a),this.textMap.set(a,o)}this.specialTokens={...s.special_tokens,...e},this.inverseSpecialTokens=Object.entries(this.specialTokens).reduce((r,[a,o])=>(r[o]=this.textEncoder.encode(a),r),{})}encode(s,e=[],t="all"){const r=new RegExp(this.patStr,"ug"),a=td.specialTokenRegex(Object.keys(this.specialTokens)),o=[],l=new Set(e==="all"?Object.keys(this.specialTokens):e),c=new Set(t==="all"?Object.keys(this.specialTokens).filter(h=>!l.has(h)):t);if(c.size>0){const h=td.specialTokenRegex([...c]),m=s.match(h);if(m!=null)throw new Error(`The text contains a special token that is not allowed: ${m[0]}`)}let f=0;for(;;){let h=null,m=f;for(;a.lastIndex=m,h=a.exec(s),!(h==null||l.has(h[0]));)m=h.index+1;const _=(h==null?void 0:h.index)??s.length;for(const w of s.substring(f,_).matchAll(r)){const b=this.textEncoder.encode(w[0]),E=this.rankMap.get(b.join(","));if(E!=null){o.push(E);continue}o.push(...xO(b,this.rankMap))}if(h==null)break;let y=this.specialTokens[h[0]];o.push(y),f=h.index+h[0].length}return o}decode(s){const e=[];let t=0;for(let o=0;o<s.length;++o){const l=s[o],c=this.textMap.get(l)??this.inverseSpecialTokens[l];c!=null&&(e.push(c),t+=c.length)}const r=new Uint8Array(t);let a=0;for(const o of e)r.set(o,a),a+=o.length;return this.textDecoder.decode(r)}},IO=td;kO(IO,"specialTokenRegex",s=>new RegExp(s.map(e=>RO(e)).join("|"),"g"));class CO extends vO{constructor(e){if(super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","document_transformers","text_splitters"]}),Object.defineProperty(this,"chunkSize",{enumerable:!0,configurable:!0,writable:!0,value:1e3}),Object.defineProperty(this,"chunkOverlap",{enumerable:!0,configurable:!0,writable:!0,value:200}),Object.defineProperty(this,"keepSeparator",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lengthFunction",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.chunkSize=(e==null?void 0:e.chunkSize)??this.chunkSize,this.chunkOverlap=(e==null?void 0:e.chunkOverlap)??this.chunkOverlap,this.keepSeparator=(e==null?void 0:e.keepSeparator)??this.keepSeparator,this.lengthFunction=(e==null?void 0:e.lengthFunction)??(t=>t.length),this.chunkOverlap>=this.chunkSize)throw new Error("Cannot have chunkOverlap >= chunkSize")}async transformDocuments(e,t={}){return this.splitDocuments(e,t)}splitOnSeparator(e,t){let r;if(t)if(this.keepSeparator){const a=t.replace(/[/\-\\^$*+?.()|[\]{}]/g,"\\$&");r=e.split(new RegExp(`(?=${a})`))}else r=e.split(t);else r=e.split("");return r.filter(a=>a!=="")}async createDocuments(e,t=[],r={}){const a=t.length>0?t:[...Array(e.length)].map(()=>({})),{chunkHeader:o="",chunkOverlapHeader:l="(cont'd) ",appendChunkOverlapHeader:c=!1}=r,f=new Array;for(let h=0;h<e.length;h+=1){const m=e[h];let _=1,y=null,w=-1;for(const b of await this.splitText(m)){let E=o;const S=m.indexOf(b,w+1);if(y===null){const $=this.numberOfNewLines(m,0,S);_+=$}else{const $=w+await this.lengthFunction(y);if($<S){const P=this.numberOfNewLines(m,$,S);_+=P}else if($>S){const P=this.numberOfNewLines(m,S,$);_-=P}c&&(E+=l)}const O=this.numberOfNewLines(b),R=a[h].loc&&typeof a[h].loc=="object"?{...a[h].loc}:{};R.lines={from:_,to:_+O};const T={...a[h],loc:R};E+=b,f.push(new Uw({pageContent:E,metadata:T})),_+=O,y=b,w=S}}return f}numberOfNewLines(e,t,r){return(e.slice(t,r).match(/\n/g)||[]).length}async splitDocuments(e,t={}){const r=e.filter(l=>l.pageContent!==void 0),a=r.map(l=>l.pageContent),o=r.map(l=>l.metadata);return this.createDocuments(a,o,t)}joinDocs(e,t){const r=e.join(t).trim();return r===""?null:r}async mergeSplits(e,t){const r=[],a=[];let o=0;for(const c of e){const f=await this.lengthFunction(c);if(o+f+a.length*t.length>this.chunkSize&&(o>this.chunkSize&&console.warn(`Created a chunk of size ${o}, +
which is longer than the specified ${this.chunkSize}`),a.length>0)){const h=this.joinDocs(a,t);for(h!==null&&r.push(h);o>this.chunkOverlap||o+f+a.length*t.length>this.chunkSize&&o>0;)o-=await this.lengthFunction(a[0]),a.shift()}a.push(c),o+=f}const l=this.joinDocs(a,t);return l!==null&&r.push(l),r}}class fo extends CO{static lc_name(){return"RecursiveCharacterTextSplitter"}constructor(e){super(e),Object.defineProperty(this,"separators",{enumerable:!0,configurable:!0,writable:!0,value:[`

`,`
`," ",""]}),this.separators=(e==null?void 0:e.separators)??this.separators,this.keepSeparator=(e==null?void 0:e.keepSeparator)??!0}async _splitText(e,t){const r=[];let a=t[t.length-1],o;for(let h=0;h<t.length;h+=1){const m=t[h];if(m===""){a=m;break}if(e.includes(m)){a=m,o=t.slice(h+1);break}}const l=this.splitOnSeparator(e,a);let c=[];const f=this.keepSeparator?"":a;for(const h of l)if(await this.lengthFunction(h)<this.chunkSize)c.push(h);else{if(c.length){const m=await this.mergeSplits(c,f);r.push(...m),c=[]}if(!o)r.push(h);else{const m=await this._splitText(h,o);r.push(...m)}}if(c.length){const h=await this.mergeSplits(c,f);r.push(...h)}return r}async splitText(e){return this._splitText(e,this.separators)}static fromLanguage(e,t){return new fo({...t,separators:fo.getSeparatorsForLanguage(e)})}static getSeparatorsForLanguage(e){if(e==="cpp")return[`
class `,`
void `,`
int `,`
float `,`
double `,`
if `,`
for `,`
while `,`
switch `,`
case `,`

`,`
`," ",""];if(e==="go")return[`
func `,`
var `,`
const `,`
type `,`
if `,`
for `,`
switch `,`
case `,`

`,`
`," ",""];if(e==="java")return[`
class `,`
public `,`
protected `,`
private `,`
static `,`
if `,`
for `,`
while `,`
switch `,`
case `,`

`,`
`," ",""];if(e==="js")return[`
function `,`
const `,`
let `,`
var `,`
class `,`
if `,`
for `,`
while `,`
switch `,`
case `,`
default `,`

`,`
`," ",""];if(e==="php")return[`
function `,`
class `,`
if `,`
foreach `,`
while `,`
do `,`
switch `,`
case `,`

`,`
`," ",""];if(e==="proto")return[`
message `,`
service `,`
enum `,`
option `,`
import `,`
syntax `,`

`,`
`," ",""];if(e==="python")return[`
class `,`
def `,`
	def `,`

`,`
`," ",""];if(e==="rst")return[`
===
`,`
---
`,`
***
`,`
.. `,`

`,`
`," ",""];if(e==="ruby")return[`
def `,`
class `,`
if `,`
unless `,`
while `,`
for `,`
do `,`
begin `,`
rescue `,`

`,`
`," ",""];if(e==="rust")return[`
fn `,`
const `,`
let `,`
if `,`
while `,`
for `,`
loop `,`
match `,`
const `,`

`,`
`," ",""];if(e==="scala")return[`
class `,`
object `,`
def `,`
val `,`
var `,`
if `,`
for `,`
while `,`
match `,`
case `,`

`,`
`," ",""];if(e==="swift")return[`
func `,`
class `,`
struct `,`
enum `,`
if `,`
for `,`
while `,`
do `,`
switch `,`
case `,`

`,`
`," ",""];if(e==="markdown")return[`
## `,`
### `,`
#### `,`
##### `,`
###### `,"```\n\n",`

***

`,`

---

`,`

___

`,`

`,`
`," ",""];if(e==="latex")return[`
\\chapter{`,`
\\section{`,`
\\subsection{`,`
\\subsubsection{`,`
\\begin{enumerate}`,`
\\begin{itemize}`,`
\\begin{description}`,`
\\begin{list}`,`
\\begin{quote}`,`
\\begin{quotation}`,`
\\begin{verse}`,`
\\begin{verbatim}`,`
\\begin{align}`,"$$","$",`

`,`
`," ",""];if(e==="html")return["<body>","<div>","<p>","<br>","<li>","<h1>","<h2>","<h3>","<h4>","<h5>","<h6>","<span>","<table>","<tr>","<td>","<th>","<ul>","<ol>","<header>","<footer>","<nav>","<head>","<style>","<script>","<meta>","<title>"," ",""];if(e==="sol")return[`
pragma `,`
using `,`
contract `,`
interface `,`
library `,`
constructor `,`
type `,`
function `,`
event `,`
modifier `,`
error `,`
struct `,`
enum `,`
if `,`
for `,`
while `,`
do while `,`
assembly `,`

`,`
`," ",""];throw new Error(`Language ${e} is not supported.`)}}const NO="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js",AO="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js";async function PO(){return window.pdfjsLib?window.pdfjsLib:new Promise((s,e)=>{if(document.getElementById("pdfjs-script"))return;const t=document.createElement("script");t.id="pdfjs-script",t.src=NO,t.onload=()=>{window.pdfjsLib.GlobalWorkerOptions.workerSrc=AO,s(window.pdfjsLib)},t.onerror=r=>e(new Error("PDF.js    .")),document.head.appendChild(t)})}class LO{constructor(e){this.genAI=new Mw(e),this.apiKey=e,this.documents=[],this.embeddings=[],this.model=this.genAI.getGenerativeModel({model:"gemini-2.5-flash",generationConfig:{temperature:.1,topP:.95,topK:40}}),this.embeddingModel=this.genAI.getGenerativeModel({model:"gemini-embedding-001"})}cosineSimilarity(e,t){const r=e.reduce((l,c,f)=>l+c*t[f],0),a=Math.sqrt(e.reduce((l,c)=>l+c*c,0)),o=Math.sqrt(t.reduce((l,c)=>l+c*c,0));return r/(a*o)}async getEmbedding(e){try{return(await this.embeddingModel.embedContent({content:{parts:[{text:e}]},taskType:"RETRIEVAL_QUERY"})).embedding.values}catch(t){throw console.error("Embedding error:",t),t}}async getEmbeddings(e){try{return(await this.embeddingModel.batchEmbedContents({requests:e.map(r=>({content:{parts:[{text:r}]},taskType:"RETRIEVAL_DOCUMENT"}))})).embeddings.map(r=>r.values)}catch(t){throw console.error("Batch embedding error:",t),t}}async processPDF(e){const t=await PO();let r;if(e instanceof File)r=await e.arrayBuffer();else if(typeof e=="string"){const _=await fetch(e);if(!_.ok)throw new Error("   .");r=await _.arrayBuffer()}else r=e;const o=await t.getDocument({data:r}).promise;let l="";for(let _=1;_<=o.numPages;_++){const b=(await(await o.getPage(_)).getTextContent()).items.map(E=>E.str);l+=b.join(" ")+`
`}const h=(await new fo({chunkSize:1e3,chunkOverlap:200}).createDocuments([l])).map(_=>_.pageContent),m=100;for(let _=0;_<h.length;_+=m){const y=h.slice(_,_+m),w=await this.getEmbeddings(y);this.documents.push(...y),this.embeddings.push(...w)}}async chat(e){if(this.documents.length===0)return" PDF   .";try{const t=await this.getEmbedding(e),o=this.embeddings.map((h,m)=>({index:m,similarity:this.cosineSimilarity(t,h)})).sort((h,m)=>m.similarity-h.similarity).slice(0,5).map(h=>this.documents[h.index]).join(`

---

`);if(!o.trim())return"     .";const l=`
  PDF      .
  [Context]    .

[]
1.  .
2.   "     ." .
3.   .

[Context]
${o}

[Question]
${e}

[Answer]
`;return(await(await this.model.generateContent(l)).response).text()}catch(t){throw console.error("RAGEngine Error:",t),new Error(`   : ${t.message}`)}}}const jO="AIzaSyBGPFQqubj5UCF_GBnbqLjObsvrHgyVaaI";function $O(){const[s,e]=at.useState([{role:"ai",content:"  .  ?"}]),[t,r]=at.useState(""),[a,o]=at.useState([]),[l,c]=at.useState(!1),[f,h]=at.useState(!1),[m,_]=at.useState(0),y=at.useRef(null),w=at.useRef(null);at.useEffect(()=>{w.current=new LO(jO),(async()=>{try{const S=await fetch("/files/manifest.json");if(!S.ok)return;const O=await S.json();c(!0);for(const R of O)try{await w.current.processPDF(`/files/${R}`),o(T=>{const $=`${R} ( )`;return T.includes($)?T:[...T,$]})}catch(T){console.error(` : ${R}`,T)}}catch{console.log("   .")}finally{c(!1)}})()},[]),at.useEffect(()=>{var E;(E=y.current)==null||E.scrollIntoView({behavior:"smooth"})},[s]),at.useEffect(()=>{if(m>0){const E=setTimeout(()=>_(m-1),1e3);return()=>clearTimeout(E)}},[m]);const b=async()=>{if(!t.trim()||f||m>0)return;const E=t;r(""),e(S=>[...S,{role:"user",content:E}]),h(!0),_(5);try{const S=await w.current.chat(E);e(O=>[...O,{role:"ai",content:S}])}catch(S){let O=S.message;(O.includes("429")||O.includes("quota"))&&(O="    .  1    .",_(60)),e(R=>[...R,{role:"ai",content:O}])}finally{h(!1)}};return ke.jsxs("div",{className:"app-container",children:[ke.jsxs("aside",{className:"sidebar",children:[ke.jsxs("div",{className:"logo-section",children:[ke.jsx(kp,{size:28,color:"#3b82f6"}),ke.jsx("h2",{className:"logo-text",children:"  "})]}),ke.jsxs("div",{className:"doc-list-section",children:[ke.jsx("h4",{children:" "}),ke.jsxs("div",{className:"doc-list",children:[a.map((E,S)=>ke.jsxs("div",{className:"doc-item",children:[ke.jsx(kp,{size:16,color:"#3b82f6"}),ke.jsx("span",{className:"truncate",title:E,children:E})]},S)),a.length===0&&!l&&ke.jsx("p",{className:"empty-msg",children:"  ."}),l&&ke.jsxs("div",{className:"doc-item processing",children:[ke.jsx(iw,{className:"animate-spin",color:"#3b82f6",size:16}),ke.jsx("span",{children:"  ..."})]})]})]})]}),ke.jsxs("main",{className:"chat-main",children:[ke.jsxs("header",{className:"chat-header",children:[ke.jsxs("div",{className:"header-title",children:[ke.jsx(aw,{size:20,color:"#3b82f6"}),ke.jsx("span",{children:" "})]}),f&&ke.jsx("div",{className:"typing-indicator",children:"   ..."})]}),ke.jsxs("div",{className:"messages-container",children:[s.map((E,S)=>ke.jsx("div",{className:`message-item ${E.role}`,children:ke.jsx("div",{className:"message-bubble",children:E.content})},S)),ke.jsx("div",{ref:y})]}),ke.jsx("div",{className:"input-section",children:ke.jsxs("div",{className:"input-container",children:[ke.jsx("input",{className:"chat-input",type:"text",value:t,onChange:E=>r(E.target.value),onKeyDown:E=>E.key==="Enter"&&b(),placeholder:m>0?`   (${m}s)...`:"  ...",disabled:l||f||m>0}),ke.jsx("button",{className:"send-btn",onClick:b,disabled:!t.trim()||l||f||m>0,children:ke.jsx(uw,{size:20})})]})})]})]})}Yv.createRoot(document.getElementById("root")).render(ke.jsx(qv.StrictMode,{children:ke.jsx($O,{})}));
